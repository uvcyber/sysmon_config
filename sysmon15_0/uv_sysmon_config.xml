<!--                                                                                                                        -->
<!--                      __  ______                   _       __     __     ______      __                                 -->
<!--                     / / / / / /__________ __   __(_)___  / /__  / /_   / ____/_  __/ /_  ___  _____                    -->
<!--                    / / / / / __/ ___/ __ `/ | / / / __ \/ / _ \/ __/  / /   / / / / __ \/ _ \/ ___/                    -->
<!--                   / /_/ / / /_/ /  / /_/ /| |/ / / /_/ / /  __/ /_   / /___/ /_/ / /_/ /  __/ /                        -->
<!--                   \____/_/\__/_/   \__,_/ |___/_/\____/_/\___/\__/   \____/\__, /_.___/\___/_/                         -->
<!--                                                                           /____/                                       -->
<!--                                                                                 _____                                  -->
<!--                      _______  ___________ ___  ____  ____     _________  ____  / __(_)___ _                            -->
<!--                     / ___/ / / / ___/ __ `__ \/ __ \/ __ \   / ___/ __ \/ __ \/ /_/ / __ `/                            -->
<!--                    (__  ) /_/ (__  ) / / / / / /_/ / / / /  / /__/ /_/ / / / / __/ / /_/ /                             -->
<!--                   /____/\__, /____/_/ /_/ /_/\____/_/ /_/   \___/\____/_/ /_/_/ /_/\__, /                              -->
<!--                        /____/                                                     /____/                               -->
<!--                                                                                                                        -->
<!--                                                                                                                        -->
<!--        Author:       Ultraviolet Cyber Detection Engineering                                                           -->
<!--        Contributors: @benmontour                                                                                       -->
<!--        Project:      https://github.com/uvcyber/sysmon_config                                                          -->
<!--        Version:      Sysmon v15.0                                                                                      -->
<!--        License:      Creative Commons Attribution 4.0                                                                  -->
<!--                      You may privatize, fork, edit, teach, publish, or deploy                                          -->
<!--                      for commercial use - with attribution in the text.                                                -->
<!--                                                                                                                        -->
<!--        Attribution:  This is based on the work of others in the community.                                             -->
<!--                      Most of this is credited to the amazingly detailed configuration created by ion-storm.            -->
<!--                      - [ionstorm/sysmon-config](https://github.com/ion-storm/sysmon-config).                           -->
<!--                      These additional configs lent some inspiration and a few rules.                                   -->
<!--                      - [olafhartong/sysmon-modular](https://github.com/olafhartong/sysmon-modular)                     -->
<!--                      - [swiftonsecurity/sysmon-config](https://github.com/SwiftOnSecurity/sysmon-config)               -->
<!--                      - [neo23x0/sysmon-config](https://github.com/Neo23x0/sysmon-config/)                              -->
<!--                                                                                                                        -->
<!--        Methodology:  Detect the most Techniques per data source in MITRE ATT&CK.                                       -->
<!--                      Provide visibility into forensic artifact events for UEBA.                                        -->
<!--                      Detect exploitation events with wide CVE coverage.                                                -->
<!--                      Risk scoring of CVE, UEBA, Forensic, and MITRE ATT&CK events.                                     -->
<!--                                                                                                                        -->
<!--                   Primary Tags:                                                                                        -->
<!--                                 Attack:     Mitre ATT&CK Identifier                                                    -->
<!--                                 Technique:  Mitre ATT&CK Technique                                                     -->
<!--                                 Tactic:     Mitre ATT&CK Tactic                                                        -->
<!--                                 DS:         Mitre ATT&CK Datasource                                                    -->
<!--                                 Alert:      Alert Text for SIEM/XDR                                                    -->
<!--                                 Info:       Informational Alert Text                                                   -->
<!--                                 Level:      The level field contains one of five string values.                        -->
<!--                                             It describes the criticality of a triggered rule.                          -->
<!--                                             While low and medium level events have an informative                      -->
<!--                                             character, events with high and critical level should                      -->
<!--                                             lead to immediate reviews by security analysts.                            -->
<!--                                 Desc:       Description of non-alerting Behavioral Based Rules                         -->
<!--                                 Forensic:   Forensic Artifacts                                                         -->
<!--                                 CVE:        CVE Vulnerability Identification                                           -->
<!--                                 FP:         False Positive Rate                                                        -->
<!--                                 Author:     Author of rule                                                             -->
<!--                                                                                                                        -->
<!--                   Additional Tag Details:                                                                              -->
<!--                                 Rapid Response Tags: (Optional for Response & Automation)                              -->
<!--                                         kp=y     Kill process with child processes                                     -->
<!--                                         kpp=y    Kill Parent Processes & all Child Processes                           -->
<!--                                         kc=y     Kill network connections                                              -->
<!--                                         ki=y     Kill Injected Thread                                                  -->
<!--                                         sd=y     Shutdown System                                                       -->
<!--                                         fw=y     Add Windows Firewall Rule to block inbound and                        -->
<!--                                                  outbound network connectivity from process                            -->
<!--                                         yara=y   Yara Scan file                                                        -->
<!--                                         ydel=y   Delete on Yara Detection                                              -->
<!--                                         rf=y     Restore Deleted File                                                  -->
<!--                                         nr=y     Null route ip                                                         -->
<!--                                         iso=y    Isolate Host                                                          -->
<!--                                         SD=y     Service Desk Ticket                                                   -->
<!--                                         SOC=y    SOC Ticket Creation                                                   -->
<!--                                                                                                                        -->
<!--                                 Risk Score ratings: (Risk=??)                                                          -->
<!--                                         Low Risk:       1-39                                                           -->
<!--                                         Medium Risk:    40-69                                                          -->
<!--                                         High Risk:      70-89                                                          -->
<!--                                         Critical Risk:  90-100                                                         -->
<!--                                                                                                                        -->
<!--                                 Levels: (from Sigma)                                                                   -->
<!--                                         (0) informational:                                                             -->
<!--                                                 Rule is intended for enrichment of events,                             -->
<!--                                                 e.g. by tagging them. No case or alerting                              -->
<!--                                                 should be triggered by such rules because it                           -->
<!--                                                 is expected that a huge amount of events                               -->
<!--                                                 will match these rules.                                                -->
<!--                                         (1) low:                                                                       -->
<!--                                                 Notable event but rarely an incident.                                  -->
<!--                                                 Low rated events can be relevant in high numbers                       -->
<!--                                                 or combination with others.                                            -->
<!--                                                 Immediate reaction shouldn't be necessary,                             -->
<!--                                                but a regular review is recommended.                                    -->
<!--                                         (2) medium:                                                                    -->
<!--                                                 Relevant event that should be reviewed manually                        -->
<!--                                                 on a more frequent basis.                                              -->
<!--                                         (3) high:                                                                      -->
<!--                                                 Relevant event that should trigger an internal                         -->
<!--                                                 alert and requires a prompt review.                                    -->
<!--                                         (4) critical:                                                                  -->
<!--                                                 Highly relevant event that indicates an incident.                      -->
<!--                                                 Critical events should be reviewed immediately.                        -->
<!--                                                                                                                        -->
<!--                                 False Positive Rates: (FP=?)                                                           -->
<!--                                         (0) Zero False Positives rate                                                  -->
<!--                                         (1) Some False Positives rate                                                  -->
<!--                                         (2) Medium False Positive rate                                                 -->
<!--                                         (3) High False Positive rate                                                   -->
<!--                                                                                                                        -->
<!--                                 Other Notes:                                                                           -->
<!--                                         The Rulename field has a hard limit of 255 characters,                         -->
<!--                                         make the best of the size available, shorten tags                              -->
<!--                                         and descriptions as needed.                                                    -->
<!--                                         Add exclusions in line enclosed within a Compound rule                         -->
<!--                                         rather than a global exclusion list.                                           -->
<!--                                                                                                                        -->

<Sysmon schemaversion="4.90">
  <HashAlgorithms>*</HashAlgorithms>
  <CheckRevocation>True</CheckRevocation>
  <DnsLookup>False</DnsLookup>
  <EventFiltering>
  <!--SYSMON EVENT ID 1 : PROCESS CREATION [ProcessCreate]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessID, Image, FileVersion, Description, Product, Company, CommandLine, CurrentDirectory, User, LogonGuid, LogonId, TerminalSessionId, IntegrityLevel, Hashes, ParentProcessGuid, ParentProcessId, ParentImage, ParentCommandLine, RuleName-->
  <RuleGroup name="RG=ProcessCreate Include Group" groupRelation="or">
    <ProcessCreate onmatch="include">
      <!--MITRE ATT&CK TACTIC: Reconnaissance-->
      <!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
      <Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Process: Process Creation,Level=3,Alert=Nessus Scan Detected,Risk=100" groupRelation="or">
        <ParentCommandLine condition="contains any">TEMP\nessus_;nessus_task_list</ParentCommandLine>
        <CommandLine condition="contains any">TEMP\nessus_;nessus_task_list</CommandLine>
      </Rule>
      <Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Process: Process Creation,Level=4,Alert=Port Scan Tool Detected,Risk=100" groupRelation="or">
        <CommandLine condition="contains any">rcpping;tcpping;tcping;routerscan;grabff;Port-Scan;netscan;\nmap;ipscan;nacmdline.exe</CommandLine>
        <OriginalFileName condition="is any">advanced_port_scanner.exe;rcpping.exe;nc.exe;nc64.exe;netcat.exe;ncat.exe;nmap.exe;zenmap.exe;advanced_ip_scanner.exe</OriginalFileName>
        <Product condition="contains any">Network Scanner;Advanced IP Scanner</Product>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=4,Alert=ADFind.exe Discovery,Risk=100" groupRelation="or">
        <OriginalFileName condition="contains">adfind</OriginalFileName>
        <Product condition="contains">adfind</Product>
        <CommandLine condition="contains any">-gcb -sc;/gcb /sc;-f (objectcategory=;/f (objectcategory=;trustdmp</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
      <!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
      <!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

      <!--MITRE ATT&CK TACTIC: Resource Development-->
      <Rule name="Attack=T1587,Technique=Develop Capabilities,Tactic=Resource Development,Level=3,DS=Process: Process Creation,Alert=PurpleSharp Indicator,Risk=40" groupRelation="or">
        <CommandLine condition="contains any">PurpleSharp;xyz123456</CommandLine>
        <OriginalFileName condition="contains any">PurpleSharp</OriginalFileName>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
      <Rule name="Attack=T1584.002,Technique=Compromise Infrastructure: DNS Server,Tactic=Resource Development,DS=Process: Process Creation,Level=4,Alert=DNSCMD DLL exec" groupRelation="and">
        <CommandLine condition="contains">/serverlevelplugindll</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
      <Rule name="Attack=T1587.003,Technique=Develop Capabilities: Digital Certificates,Tactic=Resource Development,Level=3,DS=Process: Process Creation,Alert=netsh adding SSL Certificate,Risk=40" groupRelation="and">
        <CommandLine condition="contains all">add;sslcert;http</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=netsh removing SSL Certificate,Risk=40" groupRelation="and">
        <CommandLine condition="contains">http del sslcert</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

      <!--MITRE ATT&CK TACTIC: Initial Access-->
      <Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Executed files within Outlook Attachments,Risk=30" groupRelation="and">
        <Image condition="contains">C:\Users\</Image>
        <Image condition="contains">Content.Outlook</Image>
      </Rule>
      <Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Arbitrary Shell Command Execution Via Settingcontent-Ms,Risk=30" groupRelation="and">
        <CommandLine condition="contains">.SettingContent-ms</CommandLine>
        <CommandLine condition="excludes">immersivecontrolpanel</CommandLine>
      </Rule>
      <Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Suspicious HWP Sub Processes,Risk=70" groupRelation="and">
        <ParentImage condition="image">Hwp.exe</ParentImage>
        <Image condition="image">gbb.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
      <Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Browser Exploitation Detected,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">iexplore.exe;chrome.exe;firefox.exe;browser_broker.exe;vivaldi.exe;microsoftedge.exe;microsoftedgecp.exe;brave.exe;vivaldi.exe</ParentImage>
        <Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe</Image>
        <ParentCommandLine condition="excludes any">apt-config</ParentCommandLine>
        <CommandLine condition="excludes">SentinelBrowserNativeHost.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=Exploiting SetupComplete.cmd,CVE=CVE-2019-1378,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">cmd.exe /c C:\Windows\Setup\Scripts\SetupComplete.cmd;cmd.exe /c C:\Windows\Setup\Scripts\PartnerSetupComplete.cmd</CommandLine>
        <Image condition="excludes">C:\Windows\Setup</Image>
        <Image condition="excludes">C:\Windows\SysWOW64</Image>
        <Image condition="excludes">C:\Windows\System32</Image>
        <Image condition="excludes">C:\Windows\WinSxS</Image>
      </Rule>
      <Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=IE Exploitation CVE-2019-1388,Risk=70" groupRelation="and">
        <ParentImage condition="image">consent.exe</ParentImage>
        <CommandLine condition="contains">http</CommandLine>
        <Image condition="image">iexplore.exe</Image>
        <User condition="contains">SYSTEM</User>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=IIS Web Server Exploitation Detected,Risk=100" groupRelation="and">
        <ParentImage condition="image">w3wp.exe</ParentImage>
        <Image condition="excludes any">\csc.exe;\TranscodingService.exe;\werfault.exe;\appcmd.exe</Image>
        <!--Add wider coverage than specific lolbins, add exclusions above carefully, could be noisy, if too noisy comment above and uncomment below and add more lolbins-->
        <!--<Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;certutil.exe</Image>-->
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Suspicious IIS Module Registration,Risk=100,Author=Florian Roth/@ionstorm" groupRelation="and">
        <ParentImage condition="image">w3wp.exe</ParentImage>
        <Image condition="image">appcmd.exe</Image>
        <CommandLine condition="contains any">appcmd.exe add module;system.enterpriseservices.internal.publish;\gacutil.exe /I;gacutil.exe -I</CommandLine>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Web Server Exploitation Detected,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">apache;php-cgi.exe;nginx.exe;httpd.exe;tomcat;php.exe</ParentImage>
        <Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;certutil.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Web Server Spawned cmd shell,Risk=100" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <CommandLine condition="excludes any">ping 127.0.0.1</CommandLine>
        <CurrentDirectory condition="is">c:\windows\system32\inetsrv\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,CVE=CVE-2020-1350,DS=Process: Process Creation,Level=4,Alert=DNS Remote Code Execution,Risk=100" groupRelation="and">
        <ParentCommandLine condition="contains all">svchost.exe;termsvcs</ParentCommandLine>
        <Image condition="excludes any">rdpclip.exe;csrss.exe;wininit.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,CVE=CVE-2020-1350,DS=Process: Process Creation,Level=4,Alert=DNS Remote Code Execution,Risk=100" groupRelation="and">
        <ParentImage condition="image">dns.exe</ParentImage>
        <Image condition="excludes any">werfault.exe;conhost.exe;dnscmd.exe;dns.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Tactic=Initial Access,Technique=Exploit Public-Facing Application,CVE=CVE-2019-0708,DS=Process: Process Creation,Level=4,Alert=Terminal Service Process Spawn,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">UMWorkerProcess.exe;UMService.exe</ParentImage>
        <CommandLine condition="excludes any">perfenabled</CommandLine>
      </Rule>
      <Rule name="Attack=T1190,Tactic=Initial Access,Technique=Exploit Public-Facing Application,CVE=CVE-2021-26857,DS=Process: Process Creation,Level=4,Alert=HAFNIUM APT Exchange UMS Process,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">UMWorkerProcess.exe;UMService.exe</ParentImage>
        <CommandLine condition="excludes any">perfenabled</CommandLine>
        <Image condition="excludes any">wemgr.exe;werfault.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=wwwroot Web Server Exploitation Detected,Risk=100" groupRelation="and">
        <Image condition="contains any">\wwwroot\</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Atlassian Confluence Remote Exploit,Risk=100,CVE=CVE-2021-26084" groupRelation="and">
        <ParentImage condition="end with">\Atlassian\Confluence\jre\bin\java.exe</ParentImage>
        <CommandLine condition="contains any">cmd;powershell;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin</CommandLine>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Desktop Central Remote Exploit,Risk=100,CVE=CVE-2020-10189,Author=Florian Roth" groupRelation="and">
        <ParentImage condition="end with">DesktopCentral_Server\jre\bin\java.exe</ParentImage>
        <CommandLine condition="contains any">cmd;powershell;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin</CommandLine>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Generic Java Webapp Remote Exploit,Risk=100" groupRelation="and">
        <ParentImage condition="image">\jre\bin\java.exe</ParentImage>
        <Image condition="contains any">cmd;powershell;pwsh;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin;pwsh.exe;bitsadmin;hh.exe;wmic.exe;rundll32.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;curl.exe</Image>
        <!--Allow Confluence Rule to fire-->
        <ParentImage condition="excludes">\Atlassian\Confluence\jre\bin\java.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=SQL Server Exploitation Detected,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">sqlservr</ParentImage>
        <Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;sh.exe;bash.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Generic Java keytool Exploit,Risk=100" groupRelation="and">
        <ParentImage condition="image">keytool.exe</ParentImage>
        <Image condition="contains any">cmd;powershell;pwsh;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin;pwsh.exe;bitsadmin;hh.exe;wmic.exe;rundll32.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;curl.exe</Image>
      </Rule>
      <Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Apache Spark Exploit,CVE=CVE-2022-33891,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">bash.exe;cmd.exe;powershell.exe;pwsh.exe</ParentImage>
        <CommandLine condition="contains any">id -Gn `;id /Gn `;id -Gn ';id /Gn '</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <Rule name="Attack=T1133,Technique=External Remote Services,Tactic=Initial Access,DS=Process: Process Creation,Level=2,Alert=Screenconnect Remote Access,Risk=50" groupRelation="and">
        <CommandLine condition="contains all">e=Access&amp;;y=Guest&amp;;&amp;p=;&amp;c=;&amp;k=</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->

      <!--MITRE ATT&CK TACTIC: Execution-->
      <Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=WMI Execution Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains all">process;call;create</CommandLine>
      </Rule>
      <Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious WMIC Commands,Risk=30" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains any">call set priority;call terminate;product get name;bios, get serialNumber;BIOS GET SERIALNUMBER;onboarddevice get;useraccount where name;useraccount get;path win32_networkadapter where index=;process list;useraccount get /ALL;useraccount list;qfe get description,installedOn /format:csv;process get caption,executablepath,commandline;service get name,displayname,pathname,startmode;share list;win32_share</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Console Host Execution Locations,Risk=30" groupRelation="and">
        <ParentImage condition="contains any">C:\Users\;$Recycle;\Temp\;\Downloads\</ParentImage>
        <CommandLine condition="is">\??\C:\WINDOWS\system32\conhost.exe 0xffffffff -ForceV1</CommandLine>
        <Image condition="image">conhost.exe</Image>
        <ParentImage condition="excludes any">C:\Program Files (x86)\N-able Technologies\Windows Agent\Temp\Msp.Ecosystem.Discovery.exe;TCIntegratorCommHelper.exe;\NVIDIA\NvBackend\ApplicationOntology\OAWrapper.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Console Host Parents,Risk=30" groupRelation="and">
        <ParentImage condition="contains any">svchost.exe;lsass.exe;services.exe;smss.exe;winlogon.exe;explorer.exe;dllhost.exe;rundll32.exe;regsvr32.exe;userinit.exe;winit.exe;spoolsv.exe;wermgr.exe;csrss.exe;ctfmon.exe;werfault.exe</ParentImage>
        <Image condition="image">conhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,DS=Process: Process Creation,Alert=Suspicious Console Host children,Risk=30" groupRelation="and">
        <ParentImage condition="image">conhost.exe</ParentImage>
        <Image condition="excludes any">:\Windows\splwow64.exe;:\Windows\System32\WerFault.exe;:\Windows\System32\conhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,UEBA=Execution Command Line tools by user,Risk=45" groupRelation="and">
        <Image condition="contains any">\cmd.exe;WindowsTerminal;powershell</Image>
        <ParentImage condition="image">explorer.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,UEBA=Powershell as cmd.exe child process,Risk=39" groupRelation="and">
        <ParentImage condition="image">cmd.exe</ParentImage>
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
        <CommandLine condition="excludes">Get-ItemProperty HKLM:\software\wow6432node\microsoft\windows\currentversion\uninstall\</CommandLine>
        <CommandLine condition="excludes">mysql server</CommandLine>
        <CommandLine condition="excludes">select-object displayversion,displayname</CommandLine>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell ran from Scripting Utilities,Risk=50" groupRelation="and">
        <ParentImage condition="contains any">cscript.exe;wscript.exe</ParentImage>
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell ran from cscript or wscript,Risk=50" groupRelation="and">
        <ParentImage condition="contains any">cscript.exe;wscript.exe</ParentImage>
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Powershell Launched from mshta,Risk=100" groupRelation="and">
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
        <ParentImage condition="image">mshta.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059,Technique=Visual Basic,Tactic=Execution,DS=Process: Process Creation,UEBA=Suspicious WSCRIPT Command Line,Risk=50" groupRelation="and">
        <Image condition="contains any">wscript.exe;cscript.exe</Image>
        <CommandLine condition="excludes any">IEX;Net.WebClient;ospp.vbs;powershell;slmgr.vbs;spiceworks_upload</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Suspicious wscript commands,Risk=60" groupRelation="and">
        <Image condition="image">wscript.exe</Image>
        <CommandLine condition="contains any">.jse;.js;.vba;.vbe</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious scripting to dll commands,Risk=70" groupRelation="and">
        <ParentImage condition="contains any">\wscript.exe;\cscript.exe</ParentImage>
        <Image condition="contains any">\rundll32.exe;regsvr32.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious rundll32 commands,Risk=70" groupRelation="and">
        <Image condition="contains any">\rundll32.exe;regsvr32.exe</Image>
        <CommandLine condition="excludes any">.dll;.cpl;.ocx;localserver;enable-speech-input;auto-scan-plugin;enable-media-stream;CastMediaRouteProvider;-eoim;/eoim</CommandLine><!--Already have localserver com detection-->
        <CommandLine condition="excludes all">setupapi;InstallHinfSection;DefaultInstall;SplunkUniversalForwarder\bin\spl;rundll32.exe "C:\Windows\Installer\MSI</CommandLine>
        <CommandLine condition="excludes all">\MSI;.tmp",zzzInvokeManagerCustomActionOutOfProc</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=cscript execution,Risk=60" groupRelation="and">
        <Image condition="image">cscript.exe</Image>
        <CommandLine condition="contains any">.jse;.js;.vba;.vbe</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Suspicious or Malicious mshta exec,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">mshta vbscript:CreateObject("Wscript.Shell");mshta vbscript:Execute("Execute;mshta vbscript:CreateObject("Wscript.Shell").Run("mshta.exe;javascript:a=</CommandLine>
        <CommandLine condition="contains any">.jpg;.png;.lnk;.xls;.doc;.zip;.sct;.hta</CommandLine>
      </Rule>
      <Rule name="Attack=T1059.003,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Possible WinNTI Malware,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">C:\Windows\Temp\hpqhvind.exe;C:\ProgramData\DRM\;Test.exe</ParentImage>
        <Image condition="contains any">C:\ProgramData\DRM;wmplayer.exe;C:\ProgramData\DRM\CLR\CLR.EXE</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,DS=Process: Process Creation,Tactic=Execution,UEBA=Registry Editor Opened by user,Risk=70" groupRelation="and">
        <Image condition="image">regedit.exe</Image>
        <ParentImage condition="image">explorer.exe</ParentImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,UEBA=Unusual Child Process,Risk=30" groupRelation="and">
        <Image condition="contains any">\svchost.exe;\taskhostw.exe;\userinit.exe;\smss.exe;\csrss.exe;\wininit.exe;\winlogon.exe;\lsass.exe;\logonui.exe;\services.exe</Image>
        <Image condition="contains any">C:\windows\System32\;C:\windows\syswow64\</Image>
        <ParentImage condition="excludes any">\wininit.exe;\winlogon.exe;\services.exe;\dwm.exe;System;\smss.exe;\svchost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,UEBA=Unusual Print Spooler Child Process,Risk=30" groupRelation="and">
        <ParentImage condition="contains any">\spoolsv.exe;\PrintIsolationHost.exe</ParentImage>
        <Image condition="excludes any">C:\Windows\System32\spoolsv.exe;\GPLGS\gswin32c.exe;C:\Windows\System32\spool\drivers\;\bin\gswin64c.exe;C:\PROGRA~2\CUTEPD~1\;C:\Windows\EEFPrinter.exe</Image>
        <CommandLine condition="excludes any">C:\Windows\system32\spool\DRIVERS</CommandLine>
        <Company condition="excludes any">Brother Industries;Thomson Reuters</Company>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Metasploit Detection,Risk=90" groupRelation="and">
        <ParentCommandLine condition="contains">COMSPEC</ParentCommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=ScriptFile execution" groupRelation="and">
        <CommandLine condition="contains">ScriptFile</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from 7z Archive File,Risk=50" groupRelation="and">
        <CommandLine condition="contains">\Temp\7z</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from Explorer Archive File,Risk=50" groupRelation="and">
        <CommandLine condition="contains">\Temp\Temp1_</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from winrar Archive File,Risk=50" groupRelation="and">
        <CommandLine condition="contains">\Temp\Rar$</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Powershell-->
      <Rule name="Attack=T1059.001,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell Launched from users folder,Risk=60" groupRelation="and">
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
        <ParentImage condition="begin with">C:\users\</ParentImage>
        <ParentImage condition="excludes">Microsoft VS Code\Code.exe</ParentImage>
        <ParentImage condition="excludes">\Deployment tool extract\setupodt.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=invoke-shellcode,Risk=100" groupRelation="and">
        <CommandLine condition="contains">Shellcode</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Python-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=4,Alert=IronPython,Tactic=Privilege Escalation" groupRelation="and">
        <Image condition="image">ipy.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Python Execution,Tactic=Privilege Escalation" groupRelation="and">
        <Image condition="image">python.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Javascript-->
      <Rule name="Attack=T1059.007,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=JAVA DLL exec" groupRelation="and">
        <CommandLine condition="contains">-agentpath:</CommandLine>
      </Rule>
      <Rule name="Attack=T1059.007,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=JAVA DLL exec" groupRelation="and">
        <CommandLine condition="contains">-agentlib:</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Office Exploitation Detection,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
        <Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe;msidb.exe</Image>
        <CommandLine condition="excludes all">.cmd;-</CommandLine>
        <CommandLine condition="excludes">C:\Windows\system32\spool\DRIVERS\</CommandLine>
        <CommandLine condition="excludes">PhotoViewer.dll</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
        <CommandLine condition="end with">.html</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment 2,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
        <CommandLine condition="end with">.html"</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment 2,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
        <CommandLine condition="end with">.html"</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed pfd attachment,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="end with">.pdf"</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed pfd attachment 2,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="end with">.pdf</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed iso attachment,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="end with">.iso"</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed iso attachment 2,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="end with">.iso</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Link Clicks,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe;BrowserAssist.exe;\msedgewebview;\msedge.exe</Image>
        <CommandLine condition="contains any">http:;https:;ftp:;mailto:;tel:</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed to Common Download locations,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
        <CommandLine condition="contains any">\Content.Outlook\;\Downloads\;\Documents\;:\Users\Public\;\Desktop\</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Execution to UNC File Path,Risk=50" groupRelation="and">
        <ParentImage condition="image">outlook.exe</ParentImage>
        <CommandLine condition="contains any">\\</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Alert=Office Spawning exe within: User Home Dirs,Risk=80" groupRelation="and">
        <ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
        <Image condition="begin with">C:\Users\</Image>
        <Image condition="end with">.exe</Image>
        <Product condition="excludes">Zoom Video</Product>
        <Product condition="excludes">Firefox</Product>
        <Product condition="excludes">Microsoft Edge</Product>
        <Product condition="excludes">Microsoft Teams</Product>
        <Image condition="excludes">GrammarlyAddInSetupe</Image>
        <Image condition="excludes">Teams.exe</Image>
        <Image condition="excludes">Zoom.exe</Image>
        <Image condition="excludes">browser_broker.exe</Image>
        <Image condition="excludes">chrome.exe</Image>
        <Image condition="excludes">edge.exe</Image>
        <Image condition="excludes">firefox.exe</Image>
        <Image condition="excludes">iexplore.exe</Image>
        <Image condition="excludes">vivaldi.exe</Image>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Desc=Office Spawning exe within: ProgramData,Risk=70" groupRelation="and">
        <ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
        <Image condition="begin with">C:\ProgramData\</Image>
        <Product condition="excludes">Firefox</Product>
        <Product condition="excludes">Microsoft Edge</Product>
        <Product condition="excludes">Microsoft Teams</Product>
        <Product condition="excludes">Zoom Video</Product>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Desc=Execution from within Zip File,Risk=70" groupRelation="and">
        <CommandLine condition="contains">.zip\</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Adobe Exploitation Detection,Risk=80" groupRelation="and">
        <ParentImage condition="contains any">acrobat.exe;acrord32.exe</ParentImage>
        <Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe</Image>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Office MSHTML Exploit,Risk=100,CVE=CVE-2021-40444" groupRelation="and">
        <ParentImage condition="contains any">winword.exe;powerpnt.exe;excel.exe</ParentImage>
        <Image condition="image">control.exe</Image>
        <CommandLine condition="excludes any">input.dll</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Follina msdt Exploit,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <Image condition="image">msdt.exe</Image>
        <OriginalFileName condition="is">msdt.exe</OriginalFileName>
        <CommandLine condition="contains all">BrowseForFile=;PCWDiagnostic</CommandLine>
        <CommandLine condition="contains any">/af;-af</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=msdt via answer file,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <Image condition="image">msdt.exe</Image>
        <ParentImage condition="is not">pcwrun.exe</ParentImage>
        <CommandLine condition="contains">PCWDiagnostic</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=msdt via diagcab file,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <Image condition="image">msdt.exe</Image>
        <CommandLine condition="contains any">/cab;-cab</CommandLine>
        <CommandLine condition="contains">.diagcab</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=MSDT Executed with Suspicious Parent,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <ParentImage condition="contains any">powershell.exe;pwsh.exe;cmd.exe;mshta.exe;cscript.exe;wscript.exe;wsl.exe;rundll32.exe;regsvr32.exe</ParentImage>
        <Image condition="image">msdt.exe</Image>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Exploit - Equation Editor starts application,CVE=CVE-2017-11882" groupRelation="and"> <!-- https://app.any.run/tasks/dfea0112-6fbe-4091-9161-1e8f25f611b0/-->
        <ParentImage condition="image">EQNEDT32.EXE</ParentImage>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=EPS Processing 0day,Risk=100,CVE=CVE-2017-0261" groupRelation="and">
        <ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe</ParentImage>
        <Image condition="image">FLTLDR.EXE</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
      <Rule name="Attack=T1559.002,Technique=Dynamic Data Exchange,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <CommandLine condition="contains any">/dde;-dde</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Native API-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scheduled Task Created,Risk=100" groupRelation="and">
        <Image condition="image">schtasks.exe</Image>
        <CommandLine condition="contains any">/create;-create;/change;-change</CommandLine>
        <CurrentDirectory condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</CurrentDirectory>
        <ParentImage condition="excludes">C:\Program Files\Common Files\microsoft shared\ClickToRun\officesvcmgr.exe</ParentImage>
        <CommandLine condition="excludes">Sentinel\AutoRepair</CommandLine>
        <CommandLine condition="excludes">Update_Sysmon_Rules</CommandLine>
        <ParentImage condition="excludes">C:\Program Files\AMD\CIM\Bin64\InstallManagerApp.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scheduled Task Created,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">taskeng.exe</OriginalFileName>
        <FileVersion condition="excludes">6.3.9600.20773 (winblue_ltsb_escrow.221219-1740)</FileVersion>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Schtasks task Run,Risk=60" groupRelation="and">
        <Image condition="image">schtasks.exe</Image>
        <CommandLine condition="contains any">/Run;-run</CommandLine>
        <CommandLine condition="excludes">Sentinel\AutoRepair</CommandLine>
        <CurrentDirectory condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=Child process from schtasks" groupRelation="and">
        <ParentImage condition="image">schtasks.exe</ParentImage>
        <ParentCommandLine condition="excludes">schtasks /TN RtkAudUService64_BG</ParentCommandLine>
        <ParentCommandLine condition="excludes any">-change;/change;-delete;/delete;-create;/create;Update_Sysmon_Rules;AMDRyzenMasterSDKTask</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1053.002,Technique=Scheduled Task/Job: At,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=at.exe Task scheduler execution" groupRelation="and">
        <Image condition="image">at.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.002,Technique=Scheduled Task/Job: At,Tactic=Execution/Persistence/Privledge Escalation,DS=Process: Process Creation,Level=2,Alert=at.exe Task scheduler execution" groupRelation="and">
        <ParentImage condition="image">at.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Scheduled Task Started,Risk=0" groupRelation="and">
        <ParentImage condition="image">C:\Windows\System32\svchost.exe</ParentImage>
        <ParentCommandLine condition="contains all">netsvcs;-p;-s;Schedule</ParentCommandLine>
        <CommandLine condition="excludes all">netsvcs;-p;-s;Schedule</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: System Services-->
      <Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Service Stop detected,Risk=0" groupRelation="and">
        <OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
        <CommandLine condition="contains">stop</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=NET.EXE Service Start detected,Risk=30" groupRelation="and">
        <OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
        <CommandLine condition="contains">start</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Impacket Detection 1,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">wmiprvse.exe;mmc.exe;explorer.exe;services.exe</ParentImage>
        <CommandLine condition="contains all">&#38;1;cmd.exe;\\127.0.0.1\;/Q /c</CommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Impacket Detection 2,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">wmiprvse.exe;mmc.exe;explorer.exe;services.exe</ParentImage>
        <CommandLine condition="contains all">&#38;1;cmd.exe;\\127.0.0.1\;-Q -c</CommandLine>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PowerSploit/Empire Persistence,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">schtasks;Create;ONLOGON;TN;Updater;TR;powershell</CommandLine>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=2,Alert=Service added via SC,Risk=100" groupRelation="and">
        <Image condition="image">sc.exe</Image>
        <CommandLine condition="contains">create</CommandLine>
        <CurrentDirectory condition="excludes any">\NIC_Emulex_Firmware\;C:\Windows\Temp\ExchangeSetup\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=2,Alert=Service binpath modification,Risk=100" groupRelation="and">
        <Image condition="image">sc.exe</Image>
        <CommandLine condition="contains all">config;binpath</CommandLine>
        <ParentCommandLine condition="excludes">Ecosystem.AgentSetup.tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Shell as System Service,Risk=100" groupRelation="and">
        <Image condition="contains any">cmd.exe;powershell.exe</Image>
        <ParentImage condition="image">services.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=Service added via Powershell,Risk=50" groupRelation="and">
        <CommandLine condition="contains">new-service</CommandLine>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSEXESVC Child Process,Risk=100" groupRelation="and">
        <ParentImage condition="image">psexesvc.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec Execution,Risk=100" groupRelation="or">
        <Description condition="contains">Execute processes remotely</Description>
        <Image condition="contains">psexe</Image>
        <Description condition="contains">PsExec Service</Description>
        <Description condition="contains">PsExec Launched</Description>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals Initial Tool Execution,Risk=100" groupRelation="or">
        <CommandLine condition="contains">accepteula</CommandLine>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec SYSTEM Execution,Risk=100" groupRelation="and">
        <Description condition="contains">Execute processes remotely</Description>
        <CommandLine condition="contains any">-s;/s</CommandLine>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec Child Process,Risk=100" groupRelation="and">
        <ParentImage condition="image">psexec.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=2,Alert=PSKill Execution,Risk=100" groupRelation="and">
        <ParentImage condition="image">pskill.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=PsKill Command" groupRelation="and">
        <Image condition="contains">pskill</Image>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Network Service Child Processes,Risk=75" groupRelation="and">
        <ParentCommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k NetworkService -p</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious LanmanWorkstation Child Processes,Risk=75" groupRelation="and">
        <ParentCommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k NetworkService -p -s LanmanWorkstation</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Network List Service Child Processes,Risk=75" groupRelation="and">
        <ParentCommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k netprofm -p -s netprofm</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Remote Procedure Call Service Anomaly,Risk=75" groupRelation="and">
        <ParentCommandLine condition="contains all">C:\WINDOWS\system32\svchost.exe;RPCSS</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Remote Procedure Call Service Crash detected,Risk=75" groupRelation="and">
        <ParentCommandLine condition="contains all">C:\WINDOWS\system32\svchost.exe;RPCSS</ParentCommandLine>
        <Image condition="image">werfault.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: User Execution-->
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=AstraRoth Command Line detection" groupRelation="and">
        <CommandLine condition="contains">&amp;&amp; type</CommandLine>
        <CommandLine condition="contains">&gt;</CommandLine>
        <CommandLine condition="contains">cmd.exe" /c cd</CommandLine>
      </Rule>
      <Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious or Malicious Command Line events" groupRelation="and">
        <CommandLine condition="contains any">ntdsutil;/set {default} recoveryenabled no;telnet ;-dumpcr;putty;bash.exe;pssh;shareenum;sekurlsa;reg save;reg  save;psscan;shellexec;vbscript:createobject;/output:clipboard;root\\default;root\\subscription;Wmiclass;WmiCl'+'as'+'s;export-mft;ApplicationImpersonation</CommandLine>
        <Image condition="excludes">C:\Program Files (x86)\mRemoteNG\PuTTYNG.exe</Image> <!--Remove this exclusion if mRemoteNG is not allowed in your environment-->
      </Rule>
      <Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Powershell Suspicious or Malicious events" groupRelation="or">
        <CommandLine condition="contains any">ERROR kuhl;windows/meterpreter;InjectDLL;ReflectiveLoader;Koadic.;@subtee;-donate-level=;stratum+tcp;Win32_TaskService;FilterToConsumerBinding;Invoke-Stager;Invoke-FruityC2;smbscanner;Invoke-ReverseDNSLookup;Invoke-ARPScan;Invoke-Paranoia;Find-TrustedDocuments;Find-Fruit;Get-RickAstley;PowerView;Invoke-Tater;Get-System;Get-SiteListPassword;PowerBreach;Invoke-BackdoorLNK;Install-SSP;Get-SecurityPackages;Invoke-SSHCommand;Invoke-PsExec;Invoke-InveighRelay;Set-Wallpaper;Invoke-VoiceTroll;Invoke-ThunderStruck;Exploit-Jboss;Invoke-PowerDump;Invoke-DCSync;Get-VaultCredential;Set-MacAttribute;New-HoneyHash;MailRaider;Invoke-RunAs;Invoke-PSInject;Invoke-EgressCheck;Invoke-NetRipper;Invoke-Inveigh;Get-Screenshot;Get-IndexedItem;Get-FoxDump'Get-Clipboard;Get-ChromeDump;Start-CaptureServer;Add-Persistence;Add-Exfiltration;Invoke-PowerShellWMI;Invoke-PowerShellTCP;Invoke-PoshRatHttp;Show-TargetScreen;Get-PassHashes;Get-LSASecret;Check-VM;Remove-Update;Enabled-DuplicateToken;Invoke-ADSBackdoor;Gupt-Backdoor;Add-ScrnSaveBackdoor;Add-RegBackdoor;Get-Unconstrained;Get-RegAlwaysInstallElevated;Get-ApplicationHost;Get-WebConfig;Get-UnattendedInstallFile;Get-VulnAutoRun;Get-RegAutoLogon;Install-ServiceBinary;Invoke-ServiceAbuse;Get-ServicePermission;Get-ServiceFilePermission;Get-ServiceUnquoted;Invoke-DowngradeAccount;Invoke-ACLScanner;Find-GPOLocation;Invoke-UserHunter;Invoke-ReflectivePEInjectionInvoke-ReflectivePEInjection;Invoke-ReflectivePEInjection;VolumeShadowCopyTools;Out-Minidump;Invoke-TokenManipulation;Invoke-DllInjection;Invoke-SessionGopher;Invoke-Shellcode;Invoke-WmiCommand;Get-GPPPassword;Get-Keystrokes;Get-TimedScreenshot;Get-VaultCredential;Invoke-CredentialInjection;Invoke-NinjaCopy</CommandLine>
        <ParentCommandLine condition="contains any">ERROR kuhl;windows/meterpreter;InjectDLL;ReflectiveLoader;Koadic.;@subtee;-donate-level=;stratum+tcp;Win32_TaskService;FilterToConsumerBinding;Invoke-Stager;Invoke-FruityC2;smbscanner;Invoke-ReverseDNSLookup;Invoke-ARPScan;Invoke-Paranoia;Find-TrustedDocuments;Find-Fruit;Get-RickAstley;PowerView;Invoke-Tater;Get-System;Get-SiteListPassword;PowerBreach;Invoke-BackdoorLNK;Install-SSP;Get-SecurityPackages;Invoke-SSHCommand;Invoke-PsExec;Invoke-InveighRelay;Set-Wallpaper;Invoke-VoiceTroll;Invoke-ThunderStruck;Exploit-Jboss;Invoke-PowerDump;Invoke-DCSync;Get-VaultCredential;Set-MacAttribute;New-HoneyHash;MailRaider;Invoke-RunAs;Invoke-PSInject;Invoke-EgressCheck;Invoke-NetRipper;Invoke-Inveigh;Get-Screenshot;Get-IndexedItem;Get-FoxDump'Get-Clipboard;Get-ChromeDump;Start-CaptureServer;Add-Persistence;Add-Exfiltration;Invoke-PowerShellWMI;Invoke-PowerShellTCP;Invoke-PoshRatHttp;Show-TargetScreen;Get-PassHashes;Get-LSASecret;Check-VM;Remove-Update;Enabled-DuplicateToken;Invoke-ADSBackdoor;Gupt-Backdoor;Add-ScrnSaveBackdoor;Add-RegBackdoor;Get-Unconstrained;Get-RegAlwaysInstallElevated;Get-ApplicationHost;Get-WebConfig;Get-UnattendedInstallFile;Get-VulnAutoRun;Get-RegAutoLogon;Install-ServiceBinary;Invoke-ServiceAbuse;Get-ServicePermission;Get-ServiceFilePermission;Get-ServiceUnquoted;Invoke-DowngradeAccount;Invoke-ACLScanner;Find-GPOLocation;Invoke-UserHunter;Invoke-ReflectivePEInjectionInvoke-ReflectivePEInjection;Invoke-ReflectivePEInjection;VolumeShadowCopyTools;Out-Minidump;Invoke-TokenManipulation;Invoke-DllInjection;Invoke-SessionGopher;Invoke-Shellcode;Invoke-WmiCommand;Get-GPPPassword;Get-Keystrokes;Get-TimedScreenshot;Get-VaultCredential;Invoke-CredentialInjection;Invoke-NinjaCopy</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Ramnit Banker Malware,Risk=100" groupRelation="and">
        <CommandLine condition="contains">--disable-http2 --disable-quic</CommandLine>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=DNSpionage Link click,Risk=100" groupRelation="and">
        <CommandLine condition="contains">/Client/Login?id=</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Emotet Child Process Detected" groupRelation="and">
        <ParentCommandLine condition="contains">JABzA</ParentCommandLine>
      </Rule>
      <Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Malicious Hash Detected" groupRelation="or">
        <Hashes condition="contains any">2f40abbb4f78e77745f0e657a19903fc953cc664;478dc5a5f934c62a9246f7d1fc275868f568bc07;37b4496e650b3994312c838435013560b3ca8571;37b4496e650b3994312c838435013560b3ca8571;e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230;08c34c6ac9186b61d9f29a77ef5e618067e0bc9fe85cab1ad25dc6049c376949;5fc4b0076eac7aa7815302b0c3158076e3569086c4c6aa2f71cd258238440d14;bef59b9a3e00a14956e0cd4a1f3e7524448cbe5d3cc1295d95a15b83a3579c59;2c1d3d0a9c6f76726994b88589219cb8d9c39dd9924bc8d2d02bf41d955fe326;1a2ab4df156ccd685f795baee7df49f8e701f271d3e5676b507112e30ce03c42;758598370c3b84c6fbb452e3d7119f700f970ed566171e879d3cb41102154272;5c776a33568f4c16fee7140c249c0d2b1e0798a96c7a01bfd2d5684e58c9bb32;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;36dd195269979e01a29e37c488928497;7d9d29c1c03461608bcab930fef2f568;807d86da63f0db1fc746d1f0b05bc357;849a2b0dc80aeca3d175c139efe5221c;86A4CAC227078B9C95C560C8F0370BF0;98908ce6f80ecc48628c8d2bf5b2a50c;a4b42c2c95d1f2ff12171a01c86cd64f;4abe604916c04fe3dd8b9cb3d501d3f;eac3e3ece94bc84e922ec077efb15edd;128CECC59C91C0D0574BC1075FE7CB40;88777aacd5f16599547926a4c9202862;0f49621b06f2cdaac8850c6e9581a594;17a36ac3e31f3a18936552aff2c80249;322cb39bc049aa69136925137906d855;2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec;cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5;5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c;b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04;6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11;3d129263f6a48647f103a04446fb0c2f;37cd353621b0f4fc6981b50071c94f01;1b60021baedc3f9201bcdb40e9b87f62;71345b139166482acaa568ac8816c7bc;5E022694C0DBD1FBBC263D608E577949;304772c80b157a916c7041f2f15939fb;291ff87948e45914424cec9510c297da;b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d;965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26;4a069c1abe5aca148d5a8fdabc26751e;dc5733c013378fa418d13773f5bfe6f1;c579341f86f7e962719c7113943bb6e4;d326e629a90e78825645963b35e53a6a;5E022694C0DBD1FBBC263D608E577949;53841a0c6a3ff92976db08bfdf95e083;dc7e564809d6c2a2f3457c3c9b91f22b;5470f0644589685000154cb7d3f60280acb16e39ca961cce2c016078b303bc1b;FE2CA1BE3BDA2A757036A89E54CC02DB;FE2CA1BE3BDA2A757036A89E54CC02DB</Hashes>
      </Rule>
      <Rule name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=4,Alert=TajMahal APT Tool Detection,Risk=100" groupRelation="and">
        <Hashes condition="contains any">22d142f11cf2a30ea4953e1fffb0fa7e;2317d65da4639f4246de200650a70753;27612cb03c89158225ca201721ea1aad;412956675fbc3f8c51f438c1abc100eb;daf2da52475fd8981b19ec3c321a983c;490a140093b5870a47edc29f33542fd2;51a7068640af42c3a7c1b94f1c11ab9d;533340c54bd25256873b3dca34d7f74e;684eca6b62d69ce899a3ec3bb04d0a5b;69a19abf5ba56ee07cdd3425b07cf8bf;6cfd131fef548fcd60fbcdb59317df8e;72dc98449b45a7f1ccdef27d51e31e91;7c733607a0932b1b9a9e27cd6ab55fe0;7d5265e814843b24fcb3787768129040;80c37e062aa4c94697f287352acf2e9d;815f1f8a7bc1e6f94cb5c416e381a110;a43d3b31575846fa4c3992b4143a06da;08e82dc7bae524884b7dc2134942aadb;7bcd736a2394fc49f3e27b3987cce640;57314359df11ffdf476f809671ec0275;b72737b464e50aa3664321e8e001ff32;ce8ce92fb6565181572dce00d69c24f8;5985087678414143d33ffc6e8863b887;84730a6e426fbd3cf6b821c59674c8a0;d5377dc1821c935302c065ad8432c0d2;d8f1356bebda9e77f480a6a60eab36bb;92f8e3f0f1f7cc49fad797a62a169acd;9003cfaac523e94d5479dc6a10575e60;df91b86189adb0a11c47ce2405878fa1;e17bd40f5b5005f4a0c61f9e79a9d8c2;c1e7850da5604e081b9647b58248d7e8;99828721ac1a0e32e4582c3f615d6e57;f559c87b4a14a4be1bd84df6553aaf56;b9c208ea8115232bfd9ec2c62f32d6b8;061089d8cb0ca58e660ce2e433a689b3;0e9afd3a870906ebf34a0b66d8b07435;9c115e9a81d25f9d88e7aaa4313d9a8f;520ee02668a1c7b7c262708e12b1ba6b;7bfba2c69bed6b160261bdbf2b826401;77a745b07d9c453650dd7f683b02b3ed;3a771efb7ba2cd0df247ab570e1408b2;0969b2b399a8d4cd2d751824d0d842b4;fc53f2cd780cd3a01a4299b8445f8511;4e39620afca6f60bb30e031ddc5a4330;bfe3f6a79cad5b9c642bb56f8037c43b;3dfebce4703f30eed713d795b90538b5;9793afcea43110610757bd3b800de517;36db24006e2b492cafb75f2663f241b2;21feb6aa15e02bb0cddbd544605aabad;21feb6aa15e02bb0cddbd544605aabad;649ef1dd4a5411d3afcf108d57ff87af;320b2f1d9551b5d1df4fb19bd9ab253a;3d75c72144d873b3c1c4977fbafe9184;b9cf4301b7b186a75e82a04e87b30fe4;b4e67706103c3b8ee148394ebee3f268;7bfbd72441e1f2ed48fbc0f33be00f24;cdb303f61a47720c7a8c5086e6b2a743;2a6f7ec77ab6bd4297e7b15ae06e2e61;8403a28e0bffa9cc085e7b662d0d5412;3ffd2915d285ad748202469d4a04e1f5;04078ef95a70a04e95bda06cc7bec3fa;235d427f94630575a4ea4bff180ecf5d;8035a8a143765551ca7db4bc5efb5dfd;cacaa3bf3b2801956318251db5e90f3c;1aadf739782afcae6d1c3e4d1f315cbd;c3e255888211d74cc6e3fb66b69bbffb;d9e9f22988d43d73d79db6ee178d70a4;16ab79fb2fd92db0b1f38bedb2f02ed8;8da15a97eaf69ff7ee184fc446f19cf1;ffc7305cb24c1955f9625e525d58aeee;c0e72eb4c9f897410c795c1b360090ef;9ad6fa6fdedb2df8055b3d30bd6f64f1;44619a88a6cff63523163c6a4cf375dd;a571660c9cf1696a2f4689b2007a12c7;81229c1e272218eeda14892fa8425883;0ac48cfa2ff8351365e99c1d26e082ad;afcdf79be1557326c854b6e20cb900a7</Hashes> <!-- https://securelist.com/project-tajmahal/90240/ -->
      </Rule>
      <Rule name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=3,Alert=Windows-Credential Editor Detection,Risk=70" groupRelation="and"> <!-- https://securelist.com/project-tajmahal/90240/ -->
        <Hashes condition="contains">a53a02b997935fd8eedcb5f7abab9b9f</Hashes>
      </Rule>
      <Rule name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=3,Alert=Windows-Credential Editor Detection,Risk=70" groupRelation="and"> <!-- https://securelist.com/project-tajmahal/90240/ -->
        <Hashes condition="contains">e96a73c7bf33a464c510ede582318bf2</Hashes>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Emotet Execution Detected,Risk=100" groupRelation="and">
        <Image condition="contains">serialfunc.exe</Image>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection" groupRelation="and">
        <CommandLine condition="contains any">e PAA;en PAA;enc PAA;enco PAA;encode PAA;encoded PAA;encodedco PAA;encodedcom PAA;encodedcomm PAA;encodedcomma PAA;encodedcomman PAA;encodedcommand PAA;e IAA;en IAA;enc IAA;enco IAA;encode IAA;encoded IAA;encodedco IAA;encodedcom IAA;encodedcomm IAA;encodedcomma IAA;encodedcomman IAA;encodedcommand IAA;e JAB;en JAB;enc JAB;enco JAB;encode JAB;encoded JAB;encodedco JAB;encodedcom JAB;encodedcomm JAB;encodedcomma JAB;encodedcomman JAB;encodedcommand JAB;e cwBFAFQA;en cwBFAFQA;enc cwBFAFQA;enco cwBFAFQA;encode cwBFAFQA;encoded cwBFAFQA;encodedco cwBFAFQA;encodedcom cwBFAFQA;encodedcomm cwBFAFQA;encodedcomma cwBFAFQA;encodedcomman cwBFAFQA;encodedcommand cwBFAFQA;e SQBFAF;en SQBFAF;enc SQBFAF;enco SQBFAF;encode SQBFAF;encoded SQBFAF;encodedco SQBFAF;encodedcom SQBFAF;encodedcomm SQBFAF;encodedcomma SQBFAF;encodedcomman SQBFAF;encodedcommand SQBFAF;e UwBFAFQA;en UwBFAFQA;enc UwBFAFQA;enco UwBFAFQA;encode UwBFAFQA;encoded UwBFAFQA;encodedco UwBFAFQA;encodedcom UwBFAFQA;encodedcomm UwBFAFQA;encodedcomma UwBFAFQA;encodedcomman UwBFAFQA;encodedcommand UwBFAFQA;e IABpAE4AdgBPAEsAZQAt;en IABpAE4AdgBPAEsAZQAt;enc IABpAE4AdgBPAEsAZQAt;enco IABpAE4AdgBPAEsAZQAt;encode IABpAE4AdgBPAEsAZQAt;encoded IABpAE4AdgBPAEsAZQAt;encodedco IABpAE4AdgBPAEsAZQAt;encodedcom IABpAE4AdgBPAEsAZQAt;encodedcomm IABpAE4AdgBPAEsAZQAt;encodedcomma IABpAE4AdgBPAEsAZQAt;encodedcomman IABpAE4AdgBPAEsAZQAt;encodedcommand IABpAE4AdgBPAEsAZQAt;e SQBmACgAJAB;en SQBmACgAJAB;enc SQBmACgAJAB;enco SQBmACgAJAB;encode SQBmACgAJAB;encoded SQBmACgAJAB;encodedco SQBmACgAJAB;encodedcom SQBmACgAJAB;encodedcomm SQBmACgAJAB;encodedcomma SQBmACgAJAB;encodedcomman SQBmACgAJAB;encodedcommand SQBmACgAJAB;e J;en J;enc J;enco J;encode J;encoded J;encodedco J;encodedcom J;encodedcomm J;encodedcomma J;encodedcomman J;encodedcommand J;e SUVY;en SUVY;enc SUVY;enco SUVY;encode SUVY;encoded SUVY;encodedco SUVY;encodedcom SUVY;encodedcomm SUVY;encodedcomma SUVY;encodedcomman SUVY;encodedcommand SUVY;e aWV4;en aWV4;enc aWV4;enco aWV4;encode aWV4;encoded aWV4;encodedco aWV4;encodedcom aWV4;encodedcomm aWV4;encodedcomma aWV4;encodedcomman aWV4;encodedcommand aWV4;e dmFy;en dmFy;enc dmFy;enco dmFy;encode dmFy;encoded dmFy;encodedco dmFy;encodedcom dmFy;encodedcomm dmFy;encodedcomma dmFy;encodedcomman dmFy;encodedcommand dmFy;e dgBhA;en dgBhA;enc dgBhA;enco dgBhA;encode dgBhA;encoded dgBhA;encodedco dgBhA;encodedcom dgBhA;encodedcomm dgBhA;encodedcomma dgBhA;encodedcomman dgBhA;encodedcommand dgBhA;e R2V0;en R2V0;enc R2V0;enco R2V0;encode R2V0;encoded R2V0;encodedco R2V0;encodedcom R2V0;encodedcomm R2V0;encodedcomma R2V0;encodedcomman R2V0;encodedcommand R2V0;e IAAgAH;en IAAgAH;enc IAAgAH;enco IAAgAH;encode IAAgAH;encoded IAAgAH;encodedco IAAgAH;encodedcom IAAgAH;encodedcomm IAAgAH;encodedcomma IAAgAH;encodedcomman IAAgAH;encodedcommand IAAgAH;e TVq;en TVq;enc TVq;enco TVq;encode TVq;encoded TVq;encodedco TVq;encodedcom TVq;encodedcomm TVq;encodedcomma TVq;encodedcomman TVq;encodedcommand TVq;e aQBIA;en aQBIA;enc aQBIA;enco aQBIA;encode aQBIA;encoded aQBIA;encodedco aQBIA;encodedcom aQBIA;encodedcomm aQBIA;encodedcomma aQBIA;encodedcomman aQBIA;encodedcommand aQBIA;e UEs;en UEs;enc UEs;enco UEs;encode UEs;encoded UEs;encodedco UEs;encodedcom UEs;encodedcomm UEs;encodedcomma UEs;encodedcomman UEs;encodedcommand UEs;e H4s;en H4s;enc H4s;enco H4s;encode H4s;encoded H4s;encodedco H4s;encodedcom H4s;encodedcomm H4s;encodedcomma H4s;encodedcomman H4s;encodedcommand H4s;e dXNpbm;en dXNpbm;enc dXNpbm;enco dXNpbm;encode dXNpbm;encoded dXNpbm;encodedco dXNpbm;encodedcom dXNpbm;encodedcomm dXNpbm;encodedcomma dXNpbm;encodedcomman dXNpbm;encodedcommand dXNpbm;e cwBhA;en cwBhA;enc cwBhA;enco cwBhA;encode cwBhA;encoded cwBhA;encodedco cwBhA;encodedcom cwBhA;encodedcomm cwBhA;encodedcomma cwBhA;encodedcomman cwBhA;encodedcommand cwBhA;JABzA</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 2" groupRelation="and">
        <CommandLine condition="contains all">FromBase64String</CommandLine>
        <CommandLine condition="contains any">JAB;SUVY;aWV4;dmFy;dgBhA;R2V0;SQBFAF;TVq;aQBIA;UEs;H4s;dXNpbm;cwBhA</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 3" groupRelation="and">
        <CommandLine condition="contains any">/v Word experienced;/v Excel experienced;-v Word experienced;-v Excel experienced</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 4" groupRelation="and">
        <CommandLine condition="contains any">JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ;QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA;kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA;IgAoACcAKgAnACkAOwAkA;IAKAAnACoAJwApADsAJA;iACgAJwAqACcAKQA7ACQA</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Obfuscated Emotet Command Line detection" groupRelation="and">
        <CommandLine condition="contains any">e^;^en^;^nc</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Obfuscation Character" groupRelation="and">
        <CommandLine condition="contains">^</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Directory Traversal" groupRelation="and">
        <CommandLine condition="contains any">..\;\..</CommandLine>
        <ParentImage condition="excludes all">C:\Program Files;\Razer\Synapse3\Service\Razer Synapse Service.exe</ParentImage>
        <Image condition="excludes all">C:\Program Files;\Razer\;\UserProcess\Razer Synapse Service Process.exe</Image>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Formbook detections" groupRelation="and">
        <CommandLine condition="contains any">\cmd.exe /c del "C:\Users\*\AppData\Local\Temp\*.exe;\cmd.exe /c del "C:\Users\*\Desktop\*.exe;\cmd.exe -c del "C:\Users\*\AppData\Local\Temp\*.exe;\cmd.exe -c del "C:\Users\*\Desktop\*.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=QBot Process Creation,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">ping.exe -n 6 127.0.0.1 &amp;ping.exe /n 6 127.0.0.1 &amp; type</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell RAW ping,Risk=100" groupRelation="and">
        <CommandLine condition="contains">System.Net.Networkinformation.ping</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->
      <Rule name="Attack=T1158,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Mofcomp execution or persistence,Risk=50" groupRelation="and">
        <Image condition="image">mofcomp.exe</Image>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Persistence-->
      <!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
      <Rule name="Attack=T1098,Technique=Account Manipulation,Tactic=Credential Access/Persistence,DS=Process: Process Creation,Level=3,Alert=Account Manipulation,Risk=80" groupRelation="and">
        <Image condition="contains any">net.exe;net1.exe;net2.exe</Image>
        <CommandLine condition="contains any">user;group;localgroup</CommandLine>
        <CommandLine condition="contains any">remove;delete;active;del</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
      <!--MITRE ATT&CK TECHNIQUE: Create Account-->
      <Rule name="Attack=T1098,Technique=Create Account,Tactic=Persistence,DS=Process: Process Creation,Level=3,Alert=Account Created,Risk=80" groupRelation="and">
        <Image condition="contains any">net.exe;net1.exe;net2.exe</Image>
        <CommandLine condition="contains">user</CommandLine>
        <CommandLine condition="contains any">add</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,Alert=Account Creation via command line,Alert=Account creation with dsmod,Risk=100" groupRelation="and">
        <Image condition="image">dsmod.exe</Image>
      </Rule>
      <Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Process: Process Creation,Level=3,Alert=Account Creation via command line,Alert=Account creation with dsadd,Risk=100" groupRelation="and">
        <Image condition="image">dsadd.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion/Execution,DS=Process: Process Creation,Level=0,Alert=SilentProcessExit Execution from werfault S-Flag,Risk=75" groupRelation="and">
        <ParentImage condition="image">WerFault.exe</ParentImage>
        <ParentCommandLine condition="contains any">-s;/s</ParentCommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Privilege Escalation-->
      <Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike GetSystem escalation Detected" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <CommandLine condition="contains all">echo;\pipe\;&gt;</CommandLine>
      </Rule>
      <Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike PSexec dll copy detected" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <CommandLine condition="contains all">/c;copy;dll;\\;admin$</CommandLine>
      </Rule>
      <Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Exec DLL Detected" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">,;StartW</CommandLine>
      </Rule>
      <Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Susp activity 1" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">,;update;appdata;temp;/i:</CommandLine>
      </Rule>
      <Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Susp activity 2" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">,;update;appdata;temp;-i:</CommandLine>
      </Rule>
      <Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Process: Process Creation,Level=3,Alert=CMSTPLUA UAC Bypass Child Processes" groupRelation="and">
        <ParentImage condition="image">dllhost.exe</ParentImage>
        <ParentCommandLine condition="contains any">{3E5FC7F9-9A51-4367-9063-A120244FBEC7};{3E000D72-A845-4CD9-BD83-80C07C3B881F};{D2E7041B-2927-42fb-8E9F-7CE93B6DC937};{02B49784-1CA2-436C-BC08-72FA3956507D};{BEF590BE-11A6-442A-A85B-656C1081E04C}</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Process: Process Creation,Level=3,Alert=CMSTPLUA UAC Bypass" groupRelation="and">
        <Image condition="image">dllhost.exe</Image>
        <CommandLine condition="contains any">{3E5FC7F9-9A51-4367-9063-A120244FBEC7};{3E000D72-A845-4CD9-BD83-80C07C3B881F};{D2E7041B-2927-42fb-8E9F-7CE93B6DC937};{02B49784-1CA2-436C-BC08-72FA3956507D};{BEF590BE-11A6-442A-A85B-656C1081E04C}</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <Rule name="Attack=T1548,Technique=Abuse Elevation Control Mechanism,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Abused Debug priviledge by Arbitrary Parent Process,Risk=100" groupRelation="and">
        <ParentImage condition="contains any">winlogon.exe;services.exe;lsass.exe;csrss.exe;wininit.exe;spoolsv.exe;searchindexer.exe</ParentImage>
        <Image condition="contains any">powershell.exe;pwsh.exe;cmd.exe</Image>
        <User condition="contains any">AUTHORI;AUTORI</User>
        <CommandLine condition="excludes any">route ; ADD </CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism: Bypass User Account Control-->
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Risk=20" groupRelation="and">
        <ParentImage condition="image">eventvwr.exe</ParentImage>
        <Image condition="is not">c:\windows\system32\mmc.exe</Image>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation," groupRelation="and">
        <ParentImage condition="image">fodhelper.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1118,Technique=InstallUtil,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=InstallUtil" groupRelation="and">
        <Image condition="image">InstallUtil.exe</Image>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=UAC Bypass" groupRelation="and">
        <CommandLine condition="contains">Invoke-PsUaCme</CommandLine>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=UAC Bypass" groupRelation="and">
        <CommandLine condition="contains">BypassUAC</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Powerup Command Line events" groupRelation="and">
        <CommandLine condition="contains">PowerUp</CommandLine>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">computerdefaults.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">dism.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">fodhelper.exe</ParentImage>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <Rule name="Attack=T1134.001,Technique=Access Token Manipulation: Token Impersonation/Theft,Tactic=Privilege Escalation,Risk=90,DS=Process: Process Creation,Level=3,Alert=Priv Escalation to System" groupRelation="and">
        <ParentUser condition="contains any">NT AUTHORITY\NETWORK SERVICE;NT AUTHORITY\LOCAL SERVICE;SERVICE LOCAL;ERVICE RÉSEAU;NETZWERKDIENST;LOKALER DIENST;NETZWERKDIENST;SERVICIO DE RED;ERVICIO LOC</ParentUser>
        <User condition="contains any">NT AUTHORITY\SYSTEM;СИСТЕМА;NT-AUTORITÄT\SYSTEM;AUTORITE NT\SYSTEM</User>
      </Rule>
      <Rule name="Attack=T1134.001,Technique=Access Token Manipulation: Token Impersonation/Theft,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=1,Desc=Possible Token manipulation" groupRelation="and">
        <ParentCommandLine condition="begin with">c:\windows\system32\svchost.exe -k netsvcs -s Appinfo</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1134,Technique=Access Token Manipulation,Tactic=NA,DS=Process: Process Creation,Level=2,Alert=Token Manipulation with runas.exe,Risk=70" groupRelation="and">
        <Image condition="image">runas.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Utilman Lock Screen Bypass,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">Cmd.Exe</OriginalFileName>
        <ParentImage condition="image">winlogon.exe</ParentImage>
        <Image condition="image">utilman.exe</Image>
      </Rule>
      <Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=sethc.exe Lock Screen Bypass,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">Cmd.Exe</OriginalFileName>
        <ParentImage condition="image">winlogon.exe</ParentImage>
        <Image condition="image">sethc.exe</Image>
      </Rule>
      <Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=Utilman Priv Escalation" groupRelation="and">
        <ParentImage condition="image">utilman.exe</ParentImage>
        <Image condition="excludes any">C:\Windows\System32\ATBroker.exe;Magnify.exe;C:\Windows\System32\osk.exe</Image>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence Privilege Escalation,DS=Process: Process Creation,Level=0,Desc=SETHC Priv Escalation" groupRelation="and">
        <ParentImage condition="image">sethc.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">osk.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">Magnify.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">DisplaySwitch.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">Narrator.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">AtBroker.exe</ParentImage>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Application Shimming-->
      <Rule name="Attack=T1138,Technique=Application Shimming,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=3,Desc=Application Shimming" groupRelation="and"> <!--To noisy and rule is not specfic enough. Won't alert on this for now-->
        <Image condition="image">sdbinst.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
      <Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=0,Desc=Dwm Exploitation" groupRelation="and">
        <ParentImage condition="image">dwm.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=7zip Priv Escalation Detection,CVE=CVE-2022-29072" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <ParentImage condition="image">7zFM.exe</ParentImage>
        <CommandLine condition="excludes any">;/c;-c</CommandLine>
      </Rule>
      <Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=Possible InstallerFileTakeOver LPE,CVE=CVE-2021-41379" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <ParentImage condition="image">elevation_service.exe</ParentImage>
        <IntegrityLevel condition="contains">System</IntegrityLevel>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Defense Evasion-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Image Condition Contains 'unknown process'" groupRelation="and">
        <Image condition="contains">unknown process</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=WSL Execution" groupRelation="and">
        <Image condition="contains">\LocalState\rootfs\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=WSL Execution" groupRelation="and">
        <ParentImage condition="contains">\LocalState\rootfs\</ParentImage>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <Rule name="Attack=T1484.001,Technique=Group Policy Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Auditpol System Audit Policy Change - Should be set via group policy instead" groupRelation="and">
        <OriginalFileName condition="contains">auditpol</OriginalFileName>
        <CommandLine condition="contains any">/set;-set;/restore;-restore;/clear;-clear;/remove;-remove;/resourceSACL;-resourceSACL</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
      <Rule name="Attack=T1164.001,Technique=Hidden Files and Directories,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Hidden/SuperHidden File or Folder created" groupRelation="and">
        <CommandLine condition="contains any">+s;+h</CommandLine>
        <Image condition="image">attrib.exe</Image>
      </Rule>
      <Rule name="Attack=T1164.001,Technique=Hidden Files and Directories,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Powershell Hidden File or Folder created" groupRelation="and">
        <CommandLine condition="contains all">Hidden;Attributes</CommandLine>
        <Image condition="image">powershell.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
      <Rule name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Desc=Stealth Sysmon Change Detected,Risk=100" groupRelation="and"> <!--Will be nosiy with hourly scheduled task updating the config. Won't alert on this.-->
        <Product condition="is">Sysinternals Sysmon</Product>
        <CommandLine condition="contains any">/u;/c;-u;-c</CommandLine>
        <CurrentDirectory condition="excludes">C:\ProgramdData\sysmon\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Windows Defender tampering,Risk=50" groupRelation="and">
        <Image condition="image">MpCmdRun.exe</Image>
        <CommandLine condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools:  Disable Windows Event Logging-->
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SysmonEnte Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
        <Hashes condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hashes>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SysmonQuiet Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
        <Hashes condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hashes>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SharpEvtMute Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
        <Hashes condition="contains">IMPHASH=330768a4f172e10acb6287b87289d83b</Hashes>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools-->
      <Rule name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=PSTools PSKill,Risk=80" groupRelation="and">
        <Image condition="image">PsKill.exe</Image>
      </Rule>
      <Rule name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Disabling of Windows Defender Features,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">Set-MpPreference;Add-MpPreference;Remove-MpPreference;MpCmdRun.exe</CommandLine>
        <CommandLine condition="contains any">RemoveDefinitions;RemoveDynamicSignature;DisableIOAVProtection;DisableRealTimeMonitoring;DisableBehaviorMonitoring;DisableBlockAtFirstSeen;DisableIOAVProtection;DisablePrivacyMode;DisableScriptScanning;DisableRealtimeMonitoring;DisableScanningNetworkFiles;DisableScanningMappedNetworkDrivesForFullScan;DisableRestorePoint;DisableRemovableDriveScanning;SignatureDisableUpdateOnStartupWithoutEngine;DisableIntrusionPreventionSystem;DisableScanOnRealtimeEnable;DisableArchiveScanning;DisableIntrusionPreventionSystem;DisableScriptScanning;DisableOnAccessProtection;ExclusionExtension;ExclusionPath;ExclusionProcess;ThreatDefaultAction;TamperProtection</CommandLine>
      </Rule>
      <Rule name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh ipv6 modification,Risk=40" groupRelation="and">
        <CommandLine condition="contains">interface ipv6 set</CommandLine>
      </Rule>
      <Rule name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh ipv4 modification,Risk=40" groupRelation="and">
        <CommandLine condition="contains">interface ipv4 set</CommandLine>
      </Rule>
      <Rule name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Command Line task kill 2,Risk=30" groupRelation="and">
        <Image condition="image">taskkill.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify System Firewall-->
      <Rule name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=netsh Firewall Rule Deletion,Risk=40" groupRelation="and">
        <CommandLine condition="contains">firewall delete</CommandLine>
        <ParentCommandLine condition="excludes all">ROGLiveService;C:\Program Files\ASUS\ROG Live Service\ROGLiveService.exe</ParentCommandLine>
        <ParentImage condition="excludes">C:\Program Files\ASUS\ROG Live Service\RLSInstallAction.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh Firewall Rule Creation,Risk=40" groupRelation="and">
        <CommandLine condition="contains">firewall add</CommandLine>
        <ParentCommandLine condition="excludes all">ROGLiveService;C:\Program Files\ASUS\ROG Live Service\ROGLiveService.exe</ParentCommandLine>
        <ParentImage condition="excludes">C:\Program Files\ASUS\ROG Live Service\RLSInstallAction.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=netsh firewall disablement,Risk=40" groupRelation="and">
        <CommandLine condition="contains">firewall set opmode disable</CommandLine>
      </Rule>
      <Rule name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Possible Arp Spoofing attacks" groupRelation="and">
        <CommandLine condition="contains">Core Networking - Router Solicitation</CommandLine>
      </Rule>
      <Rule name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Windows Firewall Modifications,Risk=40" groupRelation="and">
        <CommandLine condition="contains">netsh advfirewall firewall</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
      <Rule name="Attack=T1070.001,Technique=Clear Windows Event Logs,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Eventlog Removal on Host,Risk=100" groupRelation="and">
        <Image condition="image">wevtutil.exe</Image>
        <CommandLine condition="contains"> cl </CommandLine>
        <CommandLine condition="excludes">wevtutil im</CommandLine>
        <CommandLine condition="excludes">wevtutil.exe im</CommandLine>
        <CurrentDirectory condition="excludes">ClickToRun</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1562.006,Technique=Indicator Blocking,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Risk=50" groupRelation="and">
        <OriginalFileName condition="is">fltMC.exe</OriginalFileName>
        <CommandLine condition="contains any">detach;unload</CommandLine>
      </Rule>
      <Rule name="Attack=T1070,Technique=Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=IIS Log disablement,Risk=80" groupRelation="and">
        <OriginalFileName condition="is">appcmd.exe</OriginalFileName>
        <CommandLine condition="contains all">DontLog;True</CommandLine>
        <Image condition="excludes">iisetup.exe</Image>
      </Rule>
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Usagelog Env Tampering,Risk=70" groupRelation="or">
        <CommandLine condition="contains all">set;NGenAssemblyUsageLog</CommandLine>
        <CommandLine condition="contains all">New-ItemProperty;NGenAssemblyUsageLog</CommandLine>
        <CommandLine condition="contains all">reg;add;dword;NGenAssemblyUsageLog</CommandLine>
        <CommandLine condition="contains all">$env;NGenAssemblyUsageLog</CommandLine>
      </Rule>
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=COMPlus_ETWEnabled Env Tampering,Risk=70" groupRelation="or">
        <CommandLine condition="contains all">set;COMPlus_ETWEnabled</CommandLine>
        <CommandLine condition="contains all">New-ItemProperty;COMPlus_ETWEnabled</CommandLine>
        <CommandLine condition="contains all">reg;add;dword;COMPlus_ETWEnabled</CommandLine>
        <CommandLine condition="contains all">$env;COMPlus_ETWEnabled</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Windows Subsystem For Linux exec,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains any">bash.exe;wsl.exe;ubuntu.exe;kali.exe</OriginalFileName>
        <CommandLine condition="contains any">-e;/e;-u root;--exec bash;dev/tcp;~ -d;~ /d</CommandLine>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Windows Subsystem For Linux,Risk=20" groupRelation="or">
        <Image condition="image">wsl.exe</Image>
        <ParentImage condition="image">wsl.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Windows Subsystem For Linux,Risk=20" groupRelation="and">
        <Image condition="image">wslhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Windows Subsystem For Linux,Risk=20" groupRelation="and">
        <ParentImage condition="image">wslhost.exe</ParentImage>
        <ParentUser condition="excludes">ntsirlemes_deadpool</ParentUser>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Ubuntu Windows Subsystem For Linux,Risk=20" groupRelation="or">
        <Image condition="image">ubuntu.exe</Image>
        <ParentImage condition="image">ubuntu.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Kali Windows Subsystem For Linux,Risk=100" groupRelation="or">
        <Image condition="image">kali.exe</Image>
        <ParentImage condition="image">kali.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Windows Subsystem For Linux,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">distro-id;vm-id</CommandLine>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Indirect Command Execution" groupRelation="or">
        <Image condition="image">pcalua.exe</Image>
        <ParentImage condition="image">pcalua.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Bash on Windows Execution,Risk=30" groupRelation="or">
        <Image condition="image">bash.exe</Image>
        <ParentImage condition="image">bash.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Indirect Command Execution with forfiles" groupRelation="or">
        <Image condition="image">forfiles.exe</Image>
        <ParentImage condition="image">forfiles.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command-Line Interface,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <Image condition="end with">.com</Image>
      </Rule>
      <Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scriptrunner exec" groupRelation="and">
        <CommandLine condition="contains">-appvscript</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Masquerading-->
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=suspicious execution path,Risk=30" groupRelation="and">
        <Image condition="contains any">C:\Users\NetworkService\;C:\Users\NetworkService\;HarddiskVolumeShadowCopy;C:\Users\Default\;C:\Users\Public;C:\Users\Guest\;\administrateur\;C:\Windows\Media\;C:\Windows\addins\;tsclient\;\htdocs\;\config\systemprofile\;C:\PerfLogs\;c:\windows\ServiceProfiles\;C:\Intel\Logs\;C:\Windows\repair\;C:\Windows\Help\;$Recycle;C:\Windows\Debug\;C:\Windows\Security\;C:\Windows\Fonts\;\wwwroot\;\Contacts;C:\Windows\vss\</Image>
        <ParentImage condition="excludes all">C:\Windows\SysWOW64\config\systemprofile\Citrix\UpdaterBinaries\;\CitrixReceiverUpdater.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Alert=Double File Extension,Risk=100" groupRelation="or">
        <Image condition="end with">      .exe</Image>
        <Image condition="end with">.7z.exe</Image>
        <Image condition="end with">.doc.exe</Image>
        <Image condition="end with">.doc.exe</Image>
        <Image condition="end with">.docx.exe</Image>
        <Image condition="end with">.ico.exe</Image>
        <Image condition="end with">.iso.exe</Image>
        <Image condition="end with">.lnk.exe</Image>
        <Image condition="end with">.pdf.exe</Image>
        <Image condition="end with">.ppt.exe</Image>
        <Image condition="end with">.pptx.exe</Image>
        <Image condition="end with">.rar.exe</Image>
        <Image condition="end with">.rtf.exe</Image>
        <Image condition="end with">.txt.exe</Image>
        <Image condition="end with">.xls.exe</Image>
        <Image condition="end with">.xlsx.exe</Image>
        <Image condition="end with">.zip.exe</Image>
        <Image condition="end with">______.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Registry Class changes with reg.exe,Risk=40" groupRelation="and">
        <CommandLine condition="contains">reg add hkcu\software\classes\</CommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Registry Class changes with reg.exe,Risk=40" groupRelation="and">
        <CommandLine condition="contains">reg.exe add hkcu\software\classes\</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Registry Activity,Risk=39" groupRelation="and">
        <ParentCommandLine condition="begin with">C:\WINDOWS\system32\svchost.exe -k localService -s RemoteRegistry</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Alternate Data Streams with Regedit" groupRelation="and">
        <OriginalFileName condition="is">regedit.exe</OriginalFileName>
        <CommandLine condition="contains">:</CommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=REG Registry Deletions" groupRelation="and">
        <Image condition="image">reg.exe</Image>
        <CommandLine condition="contains">delete </CommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Regedit Registry Deletions" groupRelation="and">
        <Image condition="image">regedit.exe</Image>
        <CommandLine condition="contains any">/d;-d</CommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Powershell Registry Deletions" groupRelation="and">
        <CommandLine condition="contains any">HKCU:;HKLM</CommandLine>
        <CommandLine condition="contains">remove-item</CommandLine>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Powershell Registry Modifications" groupRelation="and">
        <CommandLine condition="contains any">HKCU:;HKLM</CommandLine>
        <CommandLine condition="contains">set-item;new-item</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
      <!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
      <!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Code Page Switch,Risk=50" groupRelation="and">
        <Image condition="image">chcp.exe</Image>
        <CommandLine condition="contains">936</CommandLine>
        <CommandLine condition="contains">1256</CommandLine>
        <CommandLine condition="contains">864</CommandLine>
        <CommandLine condition="contains">1258</CommandLine>
        <CommandLine condition="contains">855</CommandLine>
        <CommandLine condition="contains">866</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Encoded Command Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">-e ;-en;-enc;-enco;-encod;-encode;-encoded;-encodedc;-encodedco;-encodedcom;-encodedcomm;-encodedcomma;-encodedcomman;-encodedcommand;/e ;/en;/enc;/enco;/encod;/encode;/encoded;/encodedc;/encodedco;/encodedcom;/encodedcomm;/encodedcomma;/encodedcomman;/encodedcommand</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Hidden Command,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">-w h;-wi h;-win h;-wind h;-windo h;-window h;-windows h;-windowst h;-windowsty h;-windowstyl h;-windowstyle h;/w h;/wi h;/win h;/wind h;/windo h;/window h;/windows h;/windowst h;/windowsty h;/windowstyl h;/windowstyle h</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Execution Policy Bypass,Risk=75" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">-ex;/ex</CommandLine>
        <CommandLine condition="contains">bypass</CommandLine>
        <CommandLine condition="excludes">C:\Programdata\Sysmon\SysmonUpdateConfig.ps1</CommandLine>
        <ParentImage condition="excludes">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Powershell non-interactive Command" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">-noni;/noni</CommandLine>
        <CommandLine condition="excludes">Import-Module FileServerResourceManager</CommandLine>
        <CurrentDirectory condition="excludes">C:\Program Files\LogicMonitor</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1027,Tactic=Defense Evasion,Technique=Obfuscated Files or Information,DS=Process: Process Creation,Level=4,Alert=Powershell Obfuscation Command,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">hextobin;iex;io.filestream;system.text;base64;system.io;io.file;IMAGE_SUBSYSTEM_WINDOWS_GUI;IMAGE_NT_OPTIONAL_HDR32;IMAGE_NT_OPTIONAL_HDR64;DllCharacteristicsType;GetDelegateForFunctionPointer;WriteProcessMemory;ReadProcessMemory;ImpersonateSelf;AdjustTokenPrivileges;NtCreateThreadEx;CreateRemoteThread;io.seek;iwr;-bxor;invoke-expression;remove.to.string;shellcode;System.Net.WebClient;System.Net.WebRequest;System.Net.SecurityProtocolType;unicode;-useb;msxml2.serverxmlhttp;wscript.shell;-comobject;frombase64;io.compression;system.convert;io.streamreader;io.memorystream;compression.gzipstream;text.encoding;executioncontext;text.enc;convertto-securestring;runtime.interop;verbosepreference;[[string]]::join</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Encoded Offsets,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <CommandLine condition="contains any">SUVYI;aWV4I;SQBFAFgA;aQBlA;TW96aWxsYS;1vemlsbGEv;Nb3ppbGxhL;TQBvAHoAaQBsAGwAYQAv;0AbwB6AGkAbABsAGEAL;BNAG8AegBpAGwAbABhAC;UwB0AGE</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Obfuscated Suspicious or Malicious Commands,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">C^om^S^pEc;^c^o^m^S^p^E^c^;Wscript.Shell;-ComObject;MsXml2.ServerXmlHttp;Remove.ToString;System.Convert;-UseB;[Byte[];^h^t^t^p;h"t"t"p</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information with IwAjACMAd,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Common Base 64 encoded cmds" groupRelation="and">
        <CommandLine condition="contains any">IwAjACMAd;IyM=;SUVYI;aWV4I;SQBFAFgA;aQBlAHgA;TW96aWxsYS;1vemlsbGEv;Nb3ppbGxhL;TQBvAHoAaQBsAGwAYQAv;0AbwB6AGkAbABsAGEAL;BNAG8AegBpAGwAbABhAC</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Alert=Obfuscated Hidden Powershell,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">WindowStyle Hidden function;WindowStyle Hidden;windowstyle h;windowstyl h;windowsty h;windowst h;windows h;window h;windo h;wind h;win h;wi h;-w h;/w h;win hi;win hid;win hidd;win hidde;win hidden</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Command Line Obfuscation,Risk=75" groupRelation="and">
        <CommandLine condition="contains">^</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Type CON Command Line Redirection" groupRelation="and">
        <CommandLine condition="contains">TYPE CON &gt;</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Copy CON Command Line Redirection" groupRelation="and">
        <CommandLine condition="contains">copy CON &gt;</CommandLine>
      </Rule>
      <Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Common Obfuscated Commands,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">FromBase64String;action=create keyvalue=;VerbosePreference.ToString;SecureString;CSharpCodeProvider;runtime.interopservices.marshal;system.globalization.numberstyles;system.reflection.assembly;hextobin;VerbosePreference.ToString;system.text.encoding;io.filestream;io.filestream;io.seekorigin;text.encoding;unicode.getstring;FromBase64;[Convert]::;System.IO.File]::ReadAllText;|iex</CommandLine>
        <CommandLine condition="excludes all">ngen.exe;install</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=CertUtil Decode,Risk=80" groupRelation="and">
        <OriginalFileName condition="contains">certutil</OriginalFileName>
        <CommandLine condition="contains any">decode;encode</CommandLine>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Ping in Hexadecimal,Risk=60" groupRelation="and">
        <Image name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Ping in Hexadecimal" condition="image">ping.exe</Image>
        <CommandLine condition="contains">0x</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information: Compile After Delivery-->
      <Rule name="Attack= T1127.001,Technique=Trusted Developer Utilities Proxy Execution ,Tactic=Defnse Evasion,DS=Process: Process Creation,Level=4,Alert=CSC Suspicious Location,Risk=60" groupRelation="and">
        <Image condition="image">csc.exe</Image>
        <CommandLine condition="contains any">\AppData\;\Windows\Temp\</CommandLine>
      </Rule>
      <Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent of Csc.exe,Risk=80" groupRelation="and">
        <Image condition="image">csc.exe</Image>
        <ParentImage condition="image">wscript.exe</ParentImage>
        <ParentImage condition="image">cscript.exe</ParentImage>
        <ParentImage condition="image">mshta.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=MOFComp compilation of .Mof File,Risk=80" groupRelation="and">
        <Image condition="image">mofcomp.exe</Image>
        <CommandLine condition="contains">.mof</CommandLine>
        <CurrentDirectory condition="excludes">C:\WINDOWS\Installer\MSI</CurrentDirectory>
        <ParentImage condition="excludes">MsMpEng.exe</ParentImage>
        <ParentImage condition="excludes">aspnet_regiis.exe</ParentImage>
        <ParentImage condition="excludes">msiexec.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=CSC Compilation,Risk=80" groupRelation="and">
        <ParentImage condition="image">csc.exe</ParentImage>
        <CommandLine condition="contains any">out:;target:library</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Workflow Compiler" groupRelation="and"> <!--https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb-->
        <Image condition="contains">Microsoft.Workflow.Compiler.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of Autochk,Risk=30" groupRelation="and">
        <Image condition="image">autochk.exe</Image>
        <ParentImage condition="excludes any">\smss.exe;\fontdrvhost.exe;\dwm.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of SMSS,Risk=30" groupRelation="and">
        <Image condition="contains any">\consent.exe;\Runtimebroker.exe;\TiWorker.exe</Image>
        <ParentImage condition="excludes">\svchost.exe</ParentImage>
        <ParentImage condition="is not">-</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of consent/runtimebroke/tiworker,Risk=30" groupRelation="and">
        <Image condition="contains any">\consent.exe;\Runtimebroker.exe;\TiWorker.exe</Image>
        <ParentImage condition="excludes any">svchost.exe</ParentImage>
        <ParentImage condition="is not">-</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of searchindexer,Risk=30" groupRelation="and">
        <Image condition="image">SearchProtocolHost.exe</Image>
        <ParentImage condition="excludes any">\SearchIndexer.exe;\dllhost.exe</ParentImage>
        <ParentImage condition="is not">-</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of dllhost,Risk=30" groupRelation="and">
        <Image condition="image">dllhost.exe</Image>
        <ParentImage condition="excludes any">\services.exe;\svchost.exe</ParentImage>
        <ParentImage condition="is not">-</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of smss,Risk=30" groupRelation="and">
        <Image condition="image">smss.exe</Image>
        <ParentImage condition="excludes">\smss.exe</ParentImage>
        <ParentImage condition="is not">System</ParentImage>
        <ParentImage condition="is not">-</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of csrss,Risk=30" groupRelation="and">
        <Image condition="image">csrss.exe</Image>
        <ParentImage condition="is not">-</ParentImage>
        <ParentImage condition="excludes any">\smss.exe;svchost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of wininit,Risk=30" groupRelation="and">
        <Image condition="image">wininit.exe</Image>
        <ParentImage condition="is not">-</ParentImage>
        <ParentImage condition="excludes">\smss.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of winlogon,Risk=30" groupRelation="and">
        <Image condition="image">winlogon.exe</Image>
        <ParentImage condition="excludes">\smss.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of lsass/LsaIso,Risk=30" groupRelation="and">
        <Image condition="contains any">\lsass.exe;LsaIso.exe</Image>
        <ParentImage condition="excludes">\wininit.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of LogonUI,Risk=30" groupRelation="and">
        <Image condition="image">LogonUI.exe</Image>
        <ParentImage condition="excludes any">\wininit.exe;\winlogon.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of services,Risk=30" groupRelation="and">
        <Image condition="image">services.exe</Image>
        <ParentImage condition="excludes">\wininit.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of svchost,Risk=30" groupRelation="and">
        <Image condition="image">svchost.exe</Image>
        <ParentImage condition="is not">-</ParentImage>
        <ParentImage condition="excludes any">\MsMpEng.exe;\services.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of spoolsv,Risk=30" groupRelation="and">
        <Image condition="image">spoolsv.exe</Image>
        <ParentImage condition="excludes">\services.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of taskhost,Risk=30" groupRelation="and">
        <Image condition="image">taskhost.exe</Image>
        <ParentImage condition="excludes any">\services.exe;\svchost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of userinit,Risk=30" groupRelation="and">
        <Image condition="image">userinit.exe</Image>
        <ParentImage condition="excludes any">\dwm.exe;\winlogon.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of wmiprvse/wsmprovhost/winrshost,Risk=30" groupRelation="and">
        <Image condition="contains any">\wmiprvse.exe;\wsmprovhost.exe;\winrshost.exe</Image>
        <ParentImage condition="is not">-</ParentImage>
        <ParentImage condition="excludes any">\svchost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of SearchProtocolHost/taskhost/csrss,Risk=30" groupRelation="and">
        <ParentImage condition="contains any">\SearchProtocolHost.exe;\taskhost.exe;\csrss.exe</ParentImage>
        <Image condition="excludes any">\werfault.exe;\wermgr.exe;\WerFaultSecure.exe;\NGenTask.exe</Image>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of SearchProtocolHost/taskhost/csrss,Risk=30" groupRelation="and">
        <ParentImage condition="image">autochk.exe</ParentImage>
        <Image condition="excludes any">\chkdsk.exe;\doskey.exe;\WerFault.exe</Image>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of smss,Risk=30" groupRelation="and">
        <ParentImage condition="image">smss.exe</ParentImage>
        <Image condition="excludes any">\autochk.exe;\smss.exe;\csrss.exe;\wininit.exe;\winlogon.exe;\setupcl.exe;\WerFault.exe</Image>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of wermgr,Risk=30" groupRelation="and">
        <ParentImage condition="image">wermgr.exe</ParentImage>
        <Image condition="excludes any">\WerFaultSecure.exe;\wermgr.exe;\WerFault.exe</Image>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Possible wermgr injection,Risk=30" groupRelation="and">
        <Image condition="image">wermgr.exe</Image>
        <CommandLine condition="end with">wermgr.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Possible qbot injection,Risk=30" groupRelation="and">
        <ParentImage condition="contains any">\rundll32.exe;\regsvr32.exe</ParentImage>
        <Image condition="contains any">\explorer.exe;\wermgr.exe;\msra.exe;\OneDriveSetup.exe;\mobsync.exe;\xwizard.exe</Image>
        <CommandLine condition="end with">.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of conhost,Risk=30" groupRelation="and">
        <ParentImage condition="image">conhost.exe</ParentImage>
        <Image condition="excludes any">\mscorsvw.exe;\wermgr.exe;\WerFault.exe;\WerFaultSecure.exe</Image>
      </Rule>
      <Rule name="Attack=T1055,Technique=Powershell Injection Persistence Bypass - Execution - Lateral Movement - Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Injection persistence bypass,Risk=50" groupRelation="and">
        <CommandLine condition="contains">System.Management.Automation</CommandLine>
        <CommandLine condition="excludes all">"C:\Windows\Microsoft.NET\Framework\;\ngen.exe;install</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
      <!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
      <!--MITRE ATT&CK TECHNIQUE: Rootkit-->
      <!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=InstallUtil 1" groupRelation="and">
        <OriginalFileName name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Risk=50" condition="is">InstallUtil.exe</OriginalFileName>
        <CommandLine condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=InstallUtil 2" groupRelation="and">
        <OriginalFileName name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Risk=50" condition="is">InstallUtil.exe</OriginalFileName>
        <CommandLine condition="contains all">-logfile=;-LogToConsole=false;-U</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.013,Technique=Mavinject,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Mavinject Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
        <CommandLine condition="contains">INJECTRUNNING</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 1,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
        <CommandLine condition="contains all">/ni;/s</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 2,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
        <CommandLine condition="contains all">/ns;/s</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 3,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
        <CommandLine condition="contains all">-ni;-s</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 4,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
        <CommandLine condition="contains all">-ns;-s</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.002,Technique=Control Panel,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control_Rundll Detected,Risk=50" groupRelation="and">
        <CommandLine condition="contains all">rundll32.exe;shell32.dll;_RunDLL</CommandLine>
        <Image condition="is not">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
        <ParentCommandLine condition="excludes">C:\Windows\System32\appwiz.cpl</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1218.008,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Odbcconf Signed Binary Proxy Execution,Risk=50" groupRelation="and">
        <Image condition="image">odbcconf.exe</Image>
        <CommandLine condition="contains any">/S /A {REGSVR;-S -A {REGSVR</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Script Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Script:http Detected,Risk=75" groupRelation="and">
        <CommandLine condition="contains">script:http</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Script Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Register-cimprovider exec,Risk=100" groupRelation="and">
        <CommandLine condition="contains">Register-cimprovider</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <CommandLine condition="contains">Scriptrunner.exe -appvscript</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <CommandLine condition="contains">bginfo</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <CommandLine condition="contains">cbd</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=runscripthelper LOLBAS,Risk=40" groupRelation="and">
        <CommandLine condition="contains">runscripthelper.exe surfacecheck</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=xwizard LOLBAS,Risk=40" groupRelation="and">
        <CommandLine condition="contains">xwizard RunWizard</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=PresentationHost exec,Risk=100" groupRelation="and">
        <CommandLine condition="contains">PresentationHost</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=VBoxDrvInst.exe exec,Risk=100" groupRelation="and">
        <CommandLine condition="contains">driver executeinf</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.002,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control Panel Execution,Risk=75" groupRelation="and">
        <CommandLine condition="contains any">control.exe /name;control.exe -name</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.002,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control Panel Execution,Risk=75" groupRelation="and">
        <CommandLine condition="contains">Control_RunDLL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <Image condition="is">SyncAppvPublishingServer.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="contains">Scriptrunner.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">Appvlp.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">InfDefaultInstall.EXE</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">PresentationHost.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">RegisterCimProvider2.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">RegisterCimProvider.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">ScriptRunner.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">csi.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">extexport.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">msconfig.EXE</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">rasdlui.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">tttracer.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">verclsid.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <OriginalFileName condition="is">wab.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Register-cimprovider.exe,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">Register-cimprovider.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentCommandLine condition="contains">csi.exe</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentCommandLine condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentCommandLine condition="is">bginfo</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">devtoolslauncher.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">wab.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <ParentImage condition="image">wsreset.exe</ParentImage>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: CMSTP-->
      <Rule name="Attack=T1218.003,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation" groupRelation="and">
        <CommandLine condition="contains any">cmstp.exe /ni /s;cmstp.exe -ni -s</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=cmstp" groupRelation="and">
        <CommandLine condition="contains any">cmstp /ni /s;cmstp -ni -s</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Mavinject-->
      <Rule name="Attack=T1218,Technique=Mavinject,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Mavinject Process Injection" groupRelation="and">
        <Image condition="image">Mavinject.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=Mavinject,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Mavinject Process Injection" groupRelation="and">
        <CommandLine condition="contains">INJECTRUNNING</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
      <Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Potential rundll32.exe DllRegisterServer execution,Risk=70" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains">DllRegisterServer</CommandLine>
        <CommandLine condition="excludes any">xapauthenticodesip.dll</CommandLine>
      </Rule>
      <Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Regsvr32 loading in Appdata temp" groupRelation="and">
        <Image condition="image">regsvr32.exe</Image>
        <CommandLine condition="contains all">C:\Users;Appdata;Temp</CommandLine>
      </Rule>
      <Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Defense Evasion/Execution,DS=Process: Process Creation,Level=4,Alert=Suspicious Regsvr32 loading in Public User folder" groupRelation="and">
        <Image condition="image">regsvr32.exe</Image>
        <CommandLine condition="contains all">C:\Users;Public</CommandLine>
      </Rule>
      <Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation" groupRelation="and">
        <Description condition="contains">Microsoft(C) Register Server</Description>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=SyncAppvPublishingServer Applocker Bypass" groupRelation="and">
        <Image condition="image">SyncAppvPublishingServer.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=control panel execution" groupRelation="and">
        <Image condition="image">control.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=rasautou execution" groupRelation="and">
        <Image condition="image">rasautou.exe</Image>
      </Rule>
      <Rule name="Attack=T1196,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Control Panel Execution" groupRelation="and">
        <CommandLine condition="contains any">control.exe /name;control.exe -name</CommandLine>
      </Rule>
      <Rule name="Attack=T1196,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Control Panel Execution" groupRelation="and">
        <CommandLine condition="contains">Control_RunDLL</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Msiexec.exe DllRegisterServer execution,Risk=70" groupRelation="and">
        <Image condition="image">msiexec.exe</Image>
        <CommandLine condition="contains any">/y;-y</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\DartSock.dll</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\ImageViewer2.OCX</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\SysTray.ocx</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg6.ocx</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg7.ocx</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg7.ocx</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\todg7.ocx</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\todgub7.dll</CommandLine>
        <CommandLine condition="excludes">C:\Windows\SysWOW64\xarraydb.ocx</CommandLine>
      </Rule>
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSIExec Signed Binary Proxy Execution,Risk=70" groupRelation="and">
        <Image condition="image">msiexec.exe</Image>
        <CommandLine condition="contains any">/i;-i</CommandLine>
        <CommandLine condition="contains any">http</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Rundll32-->
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Rundll32 Suspicious call by Ordinal,Risk=80" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">,;#</CommandLine>
        <CommandLine condition="excludes">C:\Windows\resources\themes\Aero\AeroLite.msstyles</CommandLine>
        <CommandLine condition="excludes">uxtheme.dll</CommandLine>
        <CommandLine condition="excludes">ImageView_Fullscreen</CommandLine>
        <CommandLine condition="excludes">EDGEHTML.dll</CommandLine>
        <CommandLine condition="excludes">PhotoViewer.dll</CommandLine>
        <CurrentDirectory condition="excludes">\AppData\Local\WebEx\WebEx\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Rundll32 Single Threaded Apartment Switch - check for com hijacks,Risk=75" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains any">-sta;/sta</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Rundll32 localserver Switch - check for com hijacks,Risk=75" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains any">-localserver;/localserver</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious OpenAs_RunDLL,Risk=30" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">shell32.dll;OpenAs_RunDLL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Executing Powershell,Risk=70" groupRelation="and">
        <ParentImage condition="image">RUNDLL32.EXE</ParentImage>
        <OriginalFileName condition="contains">powershell</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious OpenURL Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">url.dll;OpenURL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious FileProtocolHandler Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">url.dll;FileProtocolHandler</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious RouteTheCall Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">zipfldr.dll;RouteTheCall</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious Control_RunDLL Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains all">Shell32.dll;Control_RunDLL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious javascript Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains">javascript:</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious RegisterXLL Commands" groupRelation="and">
        <OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
        <CommandLine condition="contains">RegisterXLL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious Rundll32 loading in Public User folder" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">C:\Users;Public</CommandLine>
        <ParentCommandLine condition="excludes any">rdpinit.exe</ParentCommandLine>
        <ParentImage condition="excludes any">rdpinit.exe;G2MInstaller;GoToMeeting;LogMeIn;firefox.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious Rundll32 loading in Appdata Temp" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">C:\Users;Appdata;Temp</CommandLine>
        <CommandLine condition="excludes any">ImageView_</CommandLine>
        <ParentCommandLine condition="excludes any">rdpinit.exe</ParentCommandLine>
        <ParentImage condition="excludes any">rdpinit.exe;G2MInstaller;GoToMeeting;LogMeIn;firefox.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <CommandLine condition="contains all">advpack.dll;LaunchINFSection</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <CommandLine condition="contains all">ieadvpack.dll;LaunchINFSection</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <CommandLine condition="contains all">syssetup.dll;SetupInfObjectInstallAction</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <CommandLine condition="contains all">setupapi.dll;InstallHinfSection</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <CommandLine condition="contains">InstallHinfSection</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=infDefaultInstall" groupRelation="and">
        <Image condition="image">infDefaultInstall.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=APT28 CHOPSTICK Detection,Risk=70" groupRelation="and">
        <CommandLine condition="contains">rundll32.exe "C:\Windows\twain_64.dll"</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Shdocvw exec via rundll32,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">shdocvw.dll;OpenURL</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Testing advpack exec,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">advpack.dll;RegisterOCX</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">Zipfldr.dll;RouteTheCall</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">url.dll;FileProtocolHandler</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass technique FileProtocolHandler,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">url.dll;FileProtocolHandler</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass OpenURLA,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">OpenURLA;file:</CommandLine>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass OpenURLA,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">OpenURL;file:</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MSHTA-->
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious child processes of mshta,Risk=100" groupRelation="and">
        <ParentImage condition="image">mshta.exe</ParentImage>
        <Image condition="contains any">cmd.exe;powershell.exe;wscript.exe;cscript.exe;sh.exe;bash.exe;reg.exe;regsvr32.exe;bitsadmin</Image>
      </Rule>
      <Rule name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution,Risk=100" groupRelation="and">
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <Rule name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" groupRelation="and">
        <CommandLine condition="contains">RunHTMLApplication</CommandLine>
      </Rule>
      <Rule name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" groupRelation="and">
        <CommandLine condition="contains">mshtml</CommandLine>
      </Rule>
      <Rule name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" groupRelation="and">
        <CommandLine condition="contains">vbscript:CreateObject</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Odbcconf-->
      <Rule name="Attack=T1218.008,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Possible driver load with odbcconf,Risk=40" groupRelation="and">
        <Image condition="image">odbcconf.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
      <Rule name="Attack=T1216,Technique=System Script Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=manage-bde.wsf exec,Risk=100" groupRelation="and">
        <CommandLine condition="contains">manage-bde.wsf</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Template Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Calling MSBuild" groupRelation="and">
        <ParentImage condition="contains any">powershell.exe;powershell_ise.exe</ParentImage>
        <Image condition="image">msbuild.exe</Image>
      </Rule>
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Calling RegAsm" groupRelation="and">
        <ParentImage condition="image">msbuild.exe</ParentImage>
        <Image condition="image">regasm.exe</Image>
      </Rule>
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Calling useinit" groupRelation="and">
        <ParentImage condition="image">msbuild.exe</ParentImage>
        <Image condition="image">userinit.exe</Image>
      </Rule>
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Building from xml - Silent Trinity" groupRelation="and">
        <ParentImage condition="image">msbuild.exe</ParentImage>
        <ParentCommandLine condition="contains">.xml</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=RegAsm Parent process" groupRelation="and">
        <ParentImage condition="image">regasm.exe</ParentImage>
        <Image condition="excludes">\conhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild building from lnk file" groupRelation="and">
        <Image condition="image">msbuild.exe</Image>
        <CommandLine condition="contains">.lnk</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.csproj execution" groupRelation="and">
        <CommandLine condition="contains">.csproj</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
      <!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->
      <Rule name="Attack=T1220,Technique=XSL Script Processing,Tactic=Defense Evasion Execution,DS=Process: Process Creation,Level=4,Alert=XSL Script Processing" groupRelation="and">
        <Image condition="image">msxsl.exe</Image>
      </Rule>
      <Rule name="Attack=T1220,Technique=XSL Script Processing,Tactic=Defense Evasion Execution,DS=Process: Process Creation,Level=4,Alert=XSL Script Processing" groupRelation="and">
        <ParentImage condition="image">msxsl.exe</ParentImage>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Brute Force-->
      <!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
      <!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <Rule name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Hawkeye Keylogger Detected" groupRelation="and">
        <CommandLine condition="contains">/stext</CommandLine>
      </Rule>
      <Rule name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" groupRelation="and">
        <CommandLine condition="contains">keylog</CommandLine>
      </Rule>
      <Rule name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" groupRelation="and">
        <CommandLine condition="contains">keyscan_</CommandLine>
      </Rule>
      <Rule name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" groupRelation="and">
        <CommandLine condition="contains">Get-Keystrokes</CommandLine>
      </Rule>
      <Rule name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" groupRelation="and">
        <CommandLine condition="contains">/scomma</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <Rule name="Attack=T1040,Technique=Network Sniffing,Tactic=Credential Access/Discovery,DS=Process: Process Creation,Level=4,Alert=Network Sniffing tool Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">sniff</CommandLine>
        <CommandLine condition="excludes">C:\Program Files\Adobe\</CommandLine>
      </Rule>
      <Rule name="Attack=T1040,Technique=Network Sniffing,Tactic=Credential Access/Discovery,DS=Process: Process Creation,Level=4,Alert=PCAP Sniffing tool Detected,Risk=100" groupRelation="or">
        <OriginalFileName condition="is any">tcpdump.exe;tcpdump.c;tshark.exe;tshark.c;windump.exe;windump.c;wireshark.c;wireshark.exe</OriginalFileName>
        <CommandLine condition="contains any">windump;tshark;tcpdump;windump;wireshark</CommandLine>
        <CommandLine condition="contains all">netsh;trace;start;capture=yes</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Access with vss shadow copy,Risk=100" groupRelation="and">
        <Image condition="image">vssadmin.exe</Image>
        <CommandLine condition="contains any">create;shadow</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential access with wmic shadow copy creation,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains all">shadowcopy;call;create</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential access with wmic esentutl,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains all">call;create;esentutl;vss</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Powershell shadow copy creation,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">win32_shadowcopy;create;clientaccessible</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Symlink to Shadowcopy,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">mklink;GLOBALROOT;Shadow</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Copy of NTDS.dit from vss shadow copy,Risk=100" groupRelation="or">
        <CommandLine condition="contains all">copy;NTDS\ntds.dit</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=ntdsutil credential dumping,Risk=100" groupRelation="or">
        <Image condition="image">ntdsutil.exe</Image>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Copy of SYSTEM Registry from vss shadow copy,Risk=100" groupRelation="or">
        <CommandLine condition="contains all">copy;System32\config\SYSTEM</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Malicious Reg Save Credential Dumping,Risk=100" groupRelation="or">
        <CommandLine condition="contains all">reg;save;HKLM</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command Mimikatz,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">mimikatz;mimidrv;mimilove;mimilib;sekurlsa;lsadump;dumpcreds;privilege::;token::;logonpasswords;mimikittenz;mimiauth;::;kerberos::;misc::skeleton;privilege::debug;dpapi::cred;vault::cred;lsadump;misc::;Krbtgt;TOKEN::;invoke-mimi</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Possible credential modification or disclosure with cmdkey,Risk=30" groupRelation="and">
        <OriginalFileName condition="contains">cmdkey</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Credential Dumping Command rpcping,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">rpcping.exe</OriginalFileName>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command nltest,Risk=100" groupRelation="and">
        <CommandLine condition="contains">nltest.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Suspicious Cred Dumping Commands,Risk=60" groupRelation="and">
        <CommandLine condition="contains any">-ma lsass.exe;Do-Exfiltration;Powersploit;GPPPassword;gpprefdecrypt;gsecdump;hashdump;laZagne;ntds.dit;ppldump;pwdump;pwdumpx;secretsdump;/listcreds:;-listcreds:</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">VaultCloseVault</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">VaultEnumerateItem</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">VaultFree</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">VaultGetItem</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">VaultOpenVault</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">Vaultcmd</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" groupRelation="and">
        <CommandLine condition="contains">vaultcli.dll</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping from firefox" groupRelation="and">
        <CommandLine condition="contains">select * from moz_login</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping" groupRelation="and">
        <CommandLine condition="contains">Invoke-WinEnum</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Dumping Cached Credentials,Risk=100" groupRelation="and">
        <CommandLine condition="contains">System.Net.CredentialCache</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=0,Desc=VSS Shadow file Created" groupRelation="and">
        <CommandLine condition="contains">create shadow</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Dumping,DS=Process: Process Creation,Level=4,Alert=Credential Theft: netsh wlan password export in cleartext,Risk=100" groupRelation="and">
        <CommandLine condition="contains all">wlan;export;profile;key=clear</CommandLine>
      </Rule>
      <Rule name="Attack=T1003.006,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command DCsync,Risk=100" groupRelation="and">
        <CommandLine condition="contains">dcsync</CommandLine>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credentials in Registry" groupRelation="and">
        <CommandLine condition="contains any">HKCU /f password;HKCU -f password</CommandLine>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credentials in Registry" groupRelation="and">
        <CommandLine condition="contains any">HKLM /f password;HKLM -f password</CommandLine>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command nltest,Risk=60" groupRelation="and">
        <Image condition="image">nltest.exe</Image>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command" groupRelation="and">
        <Image condition="image">ProcDump.exe</Image>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command" groupRelation="and">
        <OriginalFileName condition="contains">ProcDump</OriginalFileName>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
      <!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">asktgt;asktgs</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">createnetonly /program:;createnetonly -program:</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">dump /service:krbtgt;dump -service:krbtgt</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">harvest /interval:;harvest -interval:</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">renew /ticket:;renew -ticket:</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains">asreproast</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains">impersonateuser:</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains">kerberoast</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" groupRelation="and">
        <CommandLine condition="contains">ptt /ticket:</CommandLine>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Kerberos Ticket Disclosure with klist,Risk=70" groupRelation="and">
        <Image condition="image">klist.exe</Image>
      </Rule>
      <Rule name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=0,Desc=Kerberos Ticket Disclosure,Risk=30" groupRelation="and">
        <Image condition="image">hh.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
      <!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->
      <Rule name="Attack=T1552,Technique=Unsecured Credentials,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Possible disclosure with IIS appcmd,Risk=100" groupRelation="and">
        <OriginalFileName condition="is">appcmd.exe</OriginalFileName>
        <CommandLine condition="contains all">list;text;password</CommandLine>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User enumeration/Discovery,Risk=30" groupRelation="and">
        <Image condition="image">quser.exe</Image>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User or Group Discovery,Risk=50" groupRelation="and">
        <OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
        <CommandLine condition="contains any">group;localgroup; user</CommandLine>
        <CommandLine condition="excludes">/domain</CommandLine>
        <CommandLine condition="excludes">SUService</CommandLine>
        <CommandLine condition="excludes">\users</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Domain User or Group Discovery,Risk=50" groupRelation="and">
        <OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
        <CommandLine condition="contains any">group;localgroup; user</CommandLine>
        <CommandLine condition="contains any">/domain</CommandLine>
        <CommandLine condition="excludes">SUService</CommandLine>
        <CommandLine condition="excludes">\users</CommandLine>
        <ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=4,Alert=Sharphound Discovery,Risk=100" groupRelation="or">
        <CommandLine condition="contains any">sharphound;bloodhound;azurehound;CollectionMethod;encryptzip;randomizefilenames;dumpcomputerstatus</CommandLine>
        <Company condition="contains any">sharphound;bloodhound</Company>
        <Description condition="contains any">sharphound;bloodhound</Description>
        <Image condition="contains any">sharphound;bloodhound</Image>
        <OriginalFileName condition="contains any">sharphound;bloodhound</OriginalFileName>
        <ParentImage condition="contains any">sharphound;bloodhound</ParentImage>
        <Product condition="contains any">sharphound;bloodhound</Product>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSclient Discovery,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">dscl . list /Groups;dscl . list -Groups</CommandLine>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSclient Discovery,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">dscl . list /Users;dscl . list -Users</CommandLine>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSQuery.EXE Discovery,Risk=70" groupRelation="and">
        <Image condition="image">dsquery.exe</Image>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Query.EXE Discovery,Risk=30" groupRelation="and">
        <Image condition="image">query.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
      <Rule name="Attack=T1083,Technique=File and Directory Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=directory structure disclosure,Risk=30" groupRelation="and">
        <Image condition="end with">tree.com</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
      <Rule name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Auditpol System/GP Audit Policy Discovery" groupRelation="and">
        <OriginalFileName condition="contains">auditpol</OriginalFileName>
        <CommandLine condition="contains any">/get;-get;/list;-list;/backup;-backup</CommandLine>
      </Rule>
      <Rule name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Group Policy Discovery with GPResult" groupRelation="and">
        <Image condition="contains any">gpresult.exe</Image>
      </Rule>
      <Rule name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Group Policy Discovery with Powershell" groupRelation="and">
        <CommandLine condition="contains any">get-gpo;get-gpresult;get-gpreg</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
      <Rule name="Attack=T1057,Technique=Process Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Process Discovery,Risk=0" groupRelation="and">
        <Image condition="image">tasklist.exe</Image>
      </Rule>
      <Rule name="Attack=T1057,Technique=Process Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Process Discovery,Risk=0" groupRelation="and">
        <Image condition="image">qprocess.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Query Registry-->
      <Rule name="Attack=T1012,Technique=Query Registry,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System information discovery with reg.exe,Risk=20" groupRelation="and">
        <CommandLine condition="contains">reg query</CommandLine>
      </Rule>
      <Rule name="Attack=T1012,Technique=Query Registry,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System information discovery with reg.exe,Risk=20" groupRelation="and">
        <CommandLine condition="contains">reg.exe query</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Driver Querying" groupRelation="and">
        <Image condition="image">driverquery.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
      <Rule name="Attack=T1018,Technique=Remote System Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Traceroute Remote System Discovery,Risk=30" groupRelation="and">
        <Image condition="image">tracert.exe</Image>
      </Rule>
      <Rule name="Attack=T1018,Technique=Remote System Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Pathping Remote System Discovery,Risk=30" groupRelation="and">
        <Image condition="image">pathping.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Software Discovery: Security Software Discovery-->
      <Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Alert=Sysmon Detection with driver altitude" groupRelation="or">
        <CommandLine condition="contains all">find;385201</CommandLine>
        <CommandLine condition="contains all">select-string;385201</CommandLine>
      </Rule>
      <Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Alert=Antivirus/edr/siem Discovery" groupRelation="or">
        <CommandLine condition="contains all">find;virus</CommandLine>
        <CommandLine condition="contains all">select-string;virus</CommandLine>
        <CommandLine condition="contains all">process;Description;virus</CommandLine>
        <CommandLine condition="contains all">find;cb</CommandLine>
        <CommandLine condition="contains all">select-string;cb</CommandLine>
        <CommandLine condition="contains all">process;Description;cb</CommandLine>
        <CommandLine condition="contains all">find;defender</CommandLine>
        <CommandLine condition="contains all">select-string;defender</CommandLine>
        <CommandLine condition="contains all">process;Description;defender</CommandLine>
        <CommandLine condition="contains all">find;crowdstrike</CommandLine>
        <CommandLine condition="contains all">select-string;crowdstrike</CommandLine>
        <CommandLine condition="contains all">process;Description;crowdstrike</CommandLine>
        <CommandLine condition="contains all">find;sentinel</CommandLine>
        <CommandLine condition="contains all">select-string;sentinel</CommandLine>
        <CommandLine condition="contains all">process;Description;sentinel</CommandLine>
        <CommandLine condition="contains all">find;nessusd</CommandLine>
        <CommandLine condition="contains all">select-string;nessusd</CommandLine>
        <CommandLine condition="contains all">process;Description;nessusd</CommandLine>
        <CommandLine condition="contains all">find;td-agent</CommandLine>
        <CommandLine condition="contains all">select-string;td-agent</CommandLine>
        <CommandLine condition="contains all">process;Description;td-agent</CommandLine>
        <CommandLine condition="contains all">find;cbagentd</CommandLine>
        <CommandLine condition="contains all">select-string;cbagentd</CommandLine>
        <CommandLine condition="contains all">process;Description;cbagentd</CommandLine>
        <CommandLine condition="contains all">find;sysmon</CommandLine>
        <CommandLine condition="contains all">select-string;sysmon</CommandLine>
        <CommandLine condition="contains all">process;Description;sysmon</CommandLine>
        <CommandLine condition="contains all">find;winlogbeat</CommandLine>
        <CommandLine condition="contains all">select-string;winlogbeat</CommandLine>
        <CommandLine condition="contains all">process;Description;winlogbeat</CommandLine>
        <CommandLine condition="contains all">find;winlogbeat</CommandLine>
        <CommandLine condition="contains all">select-string;winlogbeat</CommandLine>
        <CommandLine condition="contains all">process;Description;winlogbeat</CommandLine>
        <CommandLine condition="contains all">find;csfalcon</CommandLine>
        <CommandLine condition="contains all">select-string;csfalcon</CommandLine>
        <CommandLine condition="contains all">process;Description;csfalcon</CommandLine>
        <CommandLine condition="contains all">find;splunk</CommandLine>
        <CommandLine condition="contains all">select-string;splunk</CommandLine>
        <CommandLine condition="contains all">process;Description;splunk</CommandLine>
        <CommandLine condition="contains all">find;sidecar</CommandLine>
        <CommandLine condition="contains all">select-string;sidecar</CommandLine>
        <CommandLine condition="contains all">process;Description;sidecar</CommandLine>
        <CommandLine condition="contains all">find;nxlog</CommandLine>
        <CommandLine condition="contains all">select-string;nxlog</CommandLine>
        <CommandLine condition="contains all">process;Description;nxlog</CommandLine>
        <CommandLine condition="contains all">find;lpagent</CommandLine>
        <CommandLine condition="contains all">select-string;lpagent</CommandLine>
        <CommandLine condition="contains all">process;Description;lpagent</CommandLine>
      </Rule>
      <Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation" groupRelation="or">
        <OriginalFileName name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discover,DS=Process: Process Creationy" condition="is">fltMC.exe</OriginalFileName>
        <CommandLine name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation" condition="contains">misc::mflt</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=AV Product detection via WMI,Risk=30" groupRelation="and">
        <CommandLine condition="contains">AntiVirusProduct</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Security Settings via WMI,Risk=30" groupRelation="and">
        <CommandLine condition="contains">root\SecurityCenter2</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
      <Rule name="Attack=T1016,Technique=System Information Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=System Information Discovery,Risk=30" groupRelation="and">
        <Image condition="image">sysinfo.exe</Image>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Information Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=System Information Discovery,Risk=30" groupRelation="and">
        <CommandLine condition="image">systeminfo</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection Discovery with netsh,Risk=60" groupRelation="and">
        <Image condition="image">netsh.exe</Image>
        <CommandLine condition="contains any">get;list;show</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection Changes with netsh,Risk=60" groupRelation="and">
        <Image condition="image">netsh.exe</Image>
        <CommandLine condition="excludes any">get;list;show</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=ipconfig discovery,Risk=20" groupRelation="and">
        <Image condition="image">ipconfig.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
      <Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System Network Connections Discovery,Risk=0" groupRelation="and">
        <Image condition="image">netstat.exe</Image>
      </Rule>
      <Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" groupRelation="and">
        <CommandLine condition="contains">arp -a</CommandLine>
      </Rule>
      <Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" groupRelation="and">
        <CommandLine condition="contains">arp.exe -a</CommandLine>
      </Rule>
      <Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" groupRelation="and">
        <CommandLine condition="contains">arp  -a</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Account Discovery,Risk=50" groupRelation="and">
        <Image condition="contains any">whoami.exe;whoami1.exe</Image>
      </Rule>
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=WMIC Account Discovery,Risk=30" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains all">get;useraccount</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=DNS encryption enabled with netsh,Risk=40" groupRelation="and">
        <Image condition="image">netsh.exe</Image>
        <CommandLine condition="contains any">add;set</CommandLine>
        <CommandLine condition="contains any">encryption;dohtemplate</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection modifications with netsh,Risk=40" groupRelation="and">
        <Image condition="image">netsh.exe</Image>
        <CommandLine condition="contains any">add;del;set</CommandLine>
      </Rule>
      <Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=NBTStat DNS Lookup,Risk=30" groupRelation="and">
        <CommandLine condition="contains">nbtstat</CommandLine>
        <CommandLine condition="excludes">nessus</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=route.exe discovery,Risk=60" groupRelation="and">
        <Image condition="image">route.exe</Image>
        <CommandLine condition="contains">print</CommandLine>
      </Rule>
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Route Modification,Risk=40" groupRelation="and">
        <Image condition="image">route.exe</Image>
        <CommandLine condition="contains any">ADD;DEL;CHANGE;-f</CommandLine>
      </Rule>
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User enumeration with qwinsta" groupRelation="and">
        <Image condition="image">qwinsta.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=rwinsta" groupRelation="and">
        <Image condition="image">rwinsta.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

      <!--MITRE ATT&CK TACTIC: Lateral Movement-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Possible Lateral Movmt via Office Application,Risk=80" groupRelation="and">
        <ParentImage condition="contains">Microsoft Office\root\Office</ParentImage>
        <Image condition="excludes">Microsoft Office\root\Office</Image>
        <ParentCommandLine condition="contains all">automation;Embedding</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1021.002,Tactic=Lateral Movement,Technique=SMB/Windows Admin Shares,DS=Process: Process Creation,Level=3,Alert=Command Ran over Admin Share" groupRelation="and">
        <CommandLine condition="contains">admin$</CommandLine>
        <CommandLine condition="excludes any">davclnt.dll</CommandLine>
        <ParentCommandLine condition="excludes any">WebClientGroup</ParentCommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
      <!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking: RDP Hijacking-->
      <Rule name="Attack=T1563.002,Technique=RDP Hijacking,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Desktop Shadow Alert,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">/shadow;-shadow</CommandLine>
      </Rule>
      <Rule name="Attack=T1563.002,Technique=RDP Hijacking,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Desktop Shadow with no Consent alert" groupRelation="and">
        <CommandLine condition="contains">noConsentPrompt</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote Services-->
      <Rule name="Attack=T1076,Technique=Remote Desktop Protocol,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=RDP Hijack Detected" groupRelation="and">
        <ParentImage name="Attack=T1076,Technique=Remote Desktop Protocol,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=RDP Hijack Detected,Risk=100" condition="image">tscon.exe</ParentImage>
        <CommandLine condition="contains">dest:rdp-tcp:</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Powershell Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Emotet Executed via WMI,Risk=100" groupRelation="and">
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
        <Image condition="contains">\Users\</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Network Detective System Scan Detected,Risk=100" groupRelation="and">
        <Image condition="contains">NetworkDetective</Image>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Remote Tenable Malware Scan Detected,Risk=100" groupRelation="and">
        <Image condition="image">sc.exe</Image>
        <CommandLine condition="contains">tenable</CommandLine>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=CMD.exe Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
        <CommandLine condition="excludes any">do_vbsUpload;Spiceworks</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=regsvr32.exe Executed via WMI,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">regsvr32.exe</OriginalFileName>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=CMD Executed via WMI,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">cmd.exe</OriginalFileName>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Powershell Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">powershell.exe</OriginalFileName>
        <ParentImage condition="image">WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=RSAT Tool Launch,Risk=100" groupRelation="and">
        <CommandLine condition="contains">dsa.msc</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=HyperV Remote Management Tool Launch,Risk=100" groupRelation="and">
        <CommandLine condition="contains">virtmgmt.msc</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Potential Malicious Remote WMI Execution Detected,Risk=100" groupRelation="and">
        <ParentImage condition="image">wmiprvse.exe</ParentImage>
        <Image condition="excludes">CompMgmtLauncher.exe</Image>
        <Image condition="excludes">DismHost.exe</Image>
        <Image condition="excludes">Microsoft.NET\Framework</Image>
        <Image condition="excludes">NetEvtFwdr.exe</Image>
        <Image condition="excludes">ServerManager.exe</Image>
        <Image condition="excludes">WerFault.exe</Image>
        <Image condition="excludes">chcp.com</Image>
        <Image condition="excludes">g2mupdate.exe</Image>
        <Image condition="excludes">slack.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Suspicious Processes Spawned by WinRM,Risk=100" groupRelation="and">
        <ParentImage condition="image">wsmprovhost.exe</ParentImage>
        <Image condition="image">cmd.exe</Image>
        <Image condition="image">sh.exe</Image>
        <Image condition="image">bash.exe</Image>
        <Image condition="image">wsl.exe</Image>
        <Image condition="image">powershell.exe</Image>
        <Image condition="image">powershell_ise.exe</Image>
        <Image condition="image">schtasks.exe</Image>
        <Image condition="image">at.exe</Image>
        <Image condition="image">certutil.exe</Image>
        <Image condition="image">mshta.exe</Image>
        <Image condition="image">whoami.exe</Image>
        <Image condition="image">ping.exe</Image>
        <Image condition="image">ping.exe</Image>
        <Image condition="image">bitsadmin.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Windows Remote Management Execution" groupRelation="and">
        <Image condition="end with">winrm.cmd</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" groupRelation="and">
        <Image condition="image">winrs.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" groupRelation="and">
        <Image condition="image">winrshost.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=2,Alert=Waitfor.exe Execution bypass" groupRelation="and">
        <Image condition="image">waitfor.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Windows Remote Management execution" groupRelation="and">
        <Image condition="image">wsmprovhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" groupRelation="and">
        <ParentImage condition="image">winrshost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Windows Remote Management execution" groupRelation="and">
        <ParentImage condition="image">wsmprovhost.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.006,Technique=Remote WMIC/Execution,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Potential Malicious Document Execution,Risk=90" groupRelation="and">
        <ParentImage condition="image">wmiprvse.exe</ParentImage>
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Secure Shell Execution,Risk=80" groupRelation="and">
        <Image condition="contains any">ssh.exe;putty.exe;kitty.exe;kitty_portable.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Putty utility detected,Risk=60" groupRelation="and">
        <Product condition="is">PuTTY suite</Product>
      </Rule>
      <Rule name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Secure Shell FTP Execution,Risk=80" groupRelation="and">
        <Image condition="contains any">sftp;psftp</Image>
      </Rule>
      <Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Possible SMBExec via Metasploit,Risk=100" groupRelation="and">
        <CommandLine condition="is">rundll32.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Trickbot,Risk=100" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">..\;,</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Trickbot 2,Risk=100" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">,StartW</CommandLine>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Shutdown with Psexec" groupRelation="and">
        <Image condition="contains">psshutdown</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals PSService" groupRelation="and">
        <Image condition="contains">psservice</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals PsPasswd" groupRelation="and">
        <Image condition="contains">PsPasswd</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Desktop" groupRelation="and">
        <Image condition="image">mstsc.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Telnet Terminal Emulator" groupRelation="and">
        <Image condition="image">telnet.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=TFTP Execution" groupRelation="and">
        <Image condition="image">tftp.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=IIS powershellcustomhost exec" groupRelation="and">
        <CommandLine condition="contains">powershellcustomhost</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote Services: Distributed Component Object Model-->
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation" groupRelation="and">
        <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>
        <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=CrackmapExec - Malicious Command Line events,Tactic=Privilege Escalation" groupRelation="and">
        <CommandLine condition="contains all">--execm;atexec</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Background Intelligent Transfer Control Class 1.0" groupRelation="and">
        <CommandLine condition="contains">{4991d34b-80a1-4291-83b6-3328366b9097}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Excel.Application" groupRelation="and">
        <CommandLine condition="contains">{00020812-0000-0000-C000-000000000046}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: HTML Application" groupRelation="and">
        <CommandLine condition="contains">{40AEEAB6-8FDA-41e3-9A5F-8350D4CFCA91}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: MMC20.APPLICATION" groupRelation="and">
        <CommandLine condition="contains">{7e0423cd-1119-0928-900c-e6d4a52a0715}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Outlook.Application" groupRelation="and">
        <CommandLine condition="contains">{0006F04A-0000-0000-C000-000000000046}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Powerpoint.Application" groupRelation="and">
        <CommandLine condition="contains">{048EB43E-2059-422F-95E0-557DA96038AF}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Shell.Application" groupRelation="and">
        <CommandLine condition="contains">{13709620-C279-11CE-A49E-444553540000}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: ShellBrowserWindow" groupRelation="and">
        <CommandLine condition="contains">{c08afd90-f2a1-11d1-8455-00a0c91f3880}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: ShellWindows" groupRelation="and">
        <CommandLine condition="contains">9BA05972-F6A8-11CF-A442-00A0C90A8F39</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Visio.Application" groupRelation="and">
        <CommandLine condition="contains">{00021A20-0000-0000-C000-000000000046}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: WScript.Shell" groupRelation="and">
        <CommandLine condition="contains">{72C24DD5-D70A-438B-8A42-98424B88AFB8}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Word.Application" groupRelation="and">
        <CommandLine condition="contains">{00020906-0000-0000-C000-000000000046}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Suspicious Cmdline - JScript Engine CLSID" groupRelation="and">
        <CommandLine condition="contains">{cc5bbec3-db4a-4bed-828d-08d78ee3e1ed}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Unusual Scripting Engine in use - chakra.dll" groupRelation="and">
        <CommandLine condition="contains">{1b7cd997-e5ff-4932-a7a6-2a9e636da385}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Unusual Scripting Engine in use - jscript9.dll" groupRelation="and">
        <CommandLine condition="contains">{16d51579-a30b-4c8b-a276-0ff4dc41e755}</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Rundll32 DCOM: CommandLine Execution" groupRelation="and">
        <CommandLine condition="contains any">rundll32.exe -sta;rundll32.exe /sta;rundll32 -sta;rundll32 /sta</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Rundll32 DCOM: CommandLine Execution" groupRelation="and">
        <CommandLine condition="contains all">shell32.dll;SHCreateLocalServerRunDll</CommandLine>
      </Rule>
      <Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM Launch" groupRelation="and">
        <ParentCommandLine condition="contains any">-k DcomLaunch;/k DcomLaunch</ParentCommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

      <!--MITRE ATT&CK TACTIC: Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Dark Halo Protected zip file creation,Risk=100" groupRelation="and">
        <Image condition="image">7z.exe</Image>
        <CommandLine condition="contains any">a -mx9 -r0 -p;a -v500m -mx9 -r0 -p</CommandLine>
      </Rule>
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=7z Renamed,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">7z</OriginalFileName>
        <Image condition="excludes">7z</Image>
      </Rule>
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winrar Renamed,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">winrar</OriginalFileName>
        <Image condition="excludes">winrar</Image>
      </Rule>
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winrar Renamed,Risk=100" groupRelation="and">
        <Product condition="contains">winrar</Product>
        <Image condition="excludes">winrar</Image>
      </Rule>
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winzip Renamed,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">winzip</OriginalFileName>
        <Image condition="excludes">winzip</Image>
      </Rule>
      <Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Powershell Compress-Archive,Risk=100" groupRelation="and">
        <CommandLine condition="contains">Compress-Archive</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
      <Rule name="Attack=T1123,Technique=Audio Capture,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Audio Capture Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">WindowsAudioDevice-Powershell-Cmdlet</CommandLine>
      </Rule>
      <Rule name="Attack=T1123,Technique=Audio Capture,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Audio Capture Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">SoundRecorder.exe</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
      <Rule name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Creation,Level=3,Alert=Data injected into clipboard,Risk=30" groupRelation="and">
        <Image condition="image">clip.exe</Image>
      </Rule>
      <Rule name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Creation,Level=3,Alert=Data pulled from clipboard,Risk=40" groupRelation="and">
        <CommandLine condition="contains">get-clipboard</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Staged-->
      <!--MITRE ATT&CK TECHNIQUE: Email Collection-->
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Possible Email Collection/Exfiltration,Risk=70" groupRelation="and">
        <CommandLine condition="contains">New-MailboxExportRequest</CommandLine>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=New Exchange Management Role could be used for email exfiltration,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">add-pssnapin;exchange;new-managementroleassignment;applicationimpersonation</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
      <Rule name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" groupRelation="and">
        <CommandLine condition="contains">screencapture</CommandLine>
      </Rule>
      <Rule name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" groupRelation="and">
        <CommandLine condition="contains">system.drawing.Imaging</CommandLine>
      </Rule>
      <Rule name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" groupRelation="and">
        <CommandLine condition="contains">system.drawing.bitmap</CommandLine>
      </Rule>
      <Rule name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" groupRelation="and">
        <CommandLine condition="contains">system.windows.forms.screen</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Video Capture-->

      <!--MITRE ATT&CK TACTIC: Command and Control-->
      <!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
      <Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=base64 encoded URL https or http offset,Risk=80" groupRelation="and">
        <CommandLine condition="contains any">odHRwczovL;aHR0cDovL;h0dHA6Ly;odHRwOi8v;aHR0cHM6Ly;h0dHBzOi8v</CommandLine>
        <Image condition="excludes any">ie_to_edge_stub.exe;chrome.exe;firefox.exe;iexplore.exe;brave.exe;vivaldi.exe;msedge.exe;webex;teams.exe;goto opener.exe;lynx.exe;\Webex\webexAppLauncherLatest.exe;\WebEx\webexAppLauncher.exe;\WebEx\Applications\webexAppLauncher.exe;WebEx\webex.exe;C:\PROGRA~2\BEANYW~1\GETSUP~1\TCIntegratorCommHelper.exe</Image>
        <CommandLine condition="excludes any">wbx:;/SITE_TOKEN=;msteams:;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48cmVxdWVzdCBwcm90b2NvbD0iMy4wIiB1cGRhdGVyPSJPbWFoYSI;NCentralRDLdr.exe</CommandLine>
        <OriginalFileName condition="excludes any">msedgeupdate.dll</OriginalFileName>
        <ParentCommandLine condition="excludes any">C:\Program Files (x86)\BeAnywhere Support Express\GetSupportService_N-Central\BASupSrvc.exe;NCentralRDLdr.exe</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Double Base64 encoded executable,Risk=90" groupRelation="and">
        <CommandLine condition="contains any">VFZvQUFBQ;RWb0FBQU;UVm9BQUFB;VFZxQUFBR;RWcUFBQU;UVnFBQUFF;VFZwUUFBS;RWcFFBQU;UVnBRQUFJ;VFZxUUFBT;RWcVFBQU;UVnFRQUFN;VFZwVEFRR;RWcFRBUU;UVnBUQVFF</CommandLine>
      </Rule>
      <Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=base64 encoded powershell" groupRelation="and">
        <Image condition="image">powershell.exe</Image>
        <CommandLine condition="contains any">AAAAYInlM;OiCAAAAYInlM;OiJAAAAYInlM;RwBlAHQAL;WwBOAGUAdAAuAFM;W05ldC5TZXJ2aWNl</CommandLine>
      </Rule>
      <Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Cyrillic Letter obfuscation,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">Г;И;К;П;д;и;к;л;л;н;н;о;ф;ե;թ;յ;ն;ն;ն;ն;տ;ւ;ք</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
      <!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
      <!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Certutil file transfer,Risk=100" groupRelation="and">
        <Image condition="image">certutil.exe</Image>
        <CommandLine condition="contains all">urlcache;split;f</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Command Line file transfer,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">DownloadFile;DownloadString;Net.WebClient;System.Net.WebRequest;System.Net.SecurityProtocolType;Invoke-Expression;Invoke-WebRequest</CommandLine>
        <Image condition="contains any">powershell.exe;cmd.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers,Risk=70" groupRelation="and">
        <OriginalFileName condition="is">bitsadmin.exe</OriginalFileName>
        <CommandLine condition="contains any">CREATE;TRANSFER;DOWNLOAD;UPLOAD;ADDFILE;SetNotifyFlags;SetNotifyCmdLine;SetMinRetryDelay;SetCustomHeaders;RESUME</CommandLine>
        <CommandLine condition="excludes all">util;setieproxy;localsystem;AUTODETECT</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers 2,Risk=70" groupRelation="and">
        <Description condition="contains">BITS administration utility</Description>
        <CommandLine condition="contains any">CREATE;TRANSFER;DOWNLOAD;UPLOAD;ADDFILE;SetNotifyFlags;SetNotifyCmdLine;SetMinRetryDelay;SetCustomHeaders;RESUME</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Tactic=Command And Control,Technique=Ingress Tool Transfer,DS=Process: Process Creation,Level=4,Alert=Linux Ingress transfer tools on Windows,Risk=30" groupRelation="and">
        <Image condition="contains any">\curl.exe;\wget.exe;\www.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Tactic=Command And Control,Technique=Ingress Tool Transfer,DS=Process: Process Creation,Level=4,Alert=Linux Ingress transfer tools on Windows,Risk=30" groupRelation="and">
        <Image condition="contains any">\curl.exe;\wget.exe;\www.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Certutil file download 1,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">certutil</OriginalFileName>
        <CommandLine condition="contains all">split;f</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Certutil file download 2,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">certutil</OriginalFileName>
        <CommandLine condition="contains any">verifyctl;URL</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Potential Ingress Tool Transfer and tool usage within suspicious folders,Risk=100" groupRelation="and">
        <CurrentDirectory condition="contains any">C:\Perflogs\;C:\Users\Public\;C:\root\</CurrentDirectory>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Potential Ingress Tool Transfer and tool usage within suspicious folders,Risk=100" groupRelation="and">
        <Image condition="contains any">C:\Perflogs\;C:\Users\Public\;C:\root\</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers,Risk=70" groupRelation="and">
        <CommandLine condition="image">start-bitstransfer</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Expand File copy,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">expand;\\</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Expand File copy,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">expand.exe;\\</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with ieexec,Risk=70" groupRelation="and">
        <CommandLine condition="contains">ieexec http</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with ieexec,Risk=70" groupRelation="and">
        <CommandLine condition="contains">ieexec.exe http</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with Powercat,Risk=100" groupRelation="and">
        <CommandLine condition="contains">powercat</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=esentutl Ingress Tool Transfer,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">esentutl /y \\;esentutl -y \\</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=esentutl Ingress Tool Transfer,Risk=70" groupRelation="and">
        <CommandLine condition="contains any">esentutl.exe /y \\;esentutl.exe -y \\</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=extrac32 Ingress Tool Transfer,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">extrac32;\\</CommandLine>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=extrac32 Ingress Tool Transfer,Risk=70" groupRelation="and">
        <CommandLine condition="contains all">extrac32.exe;\\</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
      <!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy-->
      <Rule name="Attack=T1090,Technique=Connection Proxy,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=NetSH PortProxy,Risk=70" groupRelation="and">
        <CommandLine condition="contains">portproxy</CommandLine>
      </Rule>
      <Rule name="Attack=T1090.003,Technique=Proxy: Multi-hop Proxy,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Tor Detected,Risk=100" groupRelation="and">
        <Image condition="image">tor.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Process: Process Creation,Level=0,Desc=Teamviewer Unattended Session" groupRelation="and">
        <Image condition="image">TeamViewer_Desktop.exe</Image>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=PSExec Command,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains any">psexec</OriginalFileName>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Web Service-->

      <!--MITRE ATT&CK TACTIC: Exfiltration-->
      <Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Exfiltration,DS=Process: Process Creation,Level=0,Desc=SCP Data exfiltration detected,Risk=100" groupRelation="and">
        <Image condition="contains any">winscp.exe;winscp.com;scp.exe;pscp</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
      <Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Data exfiltration Tool detected 3,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">bitch.exe;bitch.bat;bitch_lasagna.exe;Admin Cracker.exe;BulletsPassView.exe;ChromePass.exe;Dialupass.exe;LSASecretsView.exe;OpenedFilesView.exe;OperaPassView.exe;PasswordFox.exe;ProduKey.exe;RouterPassView.exe;USBDeview.exe;USBStealer.exe;VNCPassView.exe;WebBrowserPassView.exe;WirelessKeyView.exe;WirelessKeyView.exe;empv.exe;netpass.exe;pspv.exe;usbdll.exe;rdpv.exe;WirelessKeyView.exe;lasagna.exe;all -vvv &gt;&gt;;rsync -r</CommandLine>
      </Rule>
      <Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=CredsLeaker exfiltration tool detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">CredsLeaker;Windows.Security.Credentials.UI.CredentialPicker;function Leaker;function Await</CommandLine>
      </Rule>
      <Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=merlin CnC exfiltration detected 4,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">.exe -url https://;dll,Run https://;Invoke-Merlin;-m SimpleHTTPServer;/m SimpleHTTPServer</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=DNS Exfil detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains any">-q=txt;/q=txt</CommandLine>
        <Image condition="image">nslookup.exe</Image>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=Rclone detected,Risk=100" groupRelation="or">
        <OriginalFileName condition="contains any">rclone</OriginalFileName>
        <Description condition="contains any">Rsync for cloud storage</Description>
        <Product condition="contains any">rclone</Product>
        <Company condition="contains any">rclone</Company>
        <Image condition="contains any">\rclone</Image>
      </Rule>
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=S3browser detected,Risk=100" groupRelation="or">
        <OriginalFileName condition="contains any">s3browser</OriginalFileName>
        <Description condition="contains any">s3browser</Description>
        <Product condition="contains any">s3browser</Product>
        <Image condition="contains any">s3browser</Image>
      </Rule>
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=FTP exfiltration detected,Risk=100" groupRelation="or">
        <CommandLine condition="contains any">add-ftp;.UploadFile(</CommandLine>
        <Image condition="contains any">ftp.exe</Image>
      </Rule>
      <Rule name="Attack=T1048,Tactic=Exfiltration,Technique=Exfiltration to Cloud Storage,DS=Process: Process Creation,Level=0,Desc=Webdav Share Mounted" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <CommandLine condition="contains all">davclnt.dll;DavSetCookie</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->

      <!--MITRE ATT&CK TACTIC: Impact-->
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Command Detected,Risk=100" groupRelation="and">
        <Image condition="image">bcdedit.exe</Image>
        <CommandLine condition="contains">safeboot</CommandLine>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Command Detected,Risk=100" groupRelation="and">
        <Image condition="image">bootcfg.exe</Image>
        <CommandLine condition="contains">safeboot</CommandLine>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Virtual Machine,Risk=60" groupRelation="and">
        <CommandLine condition="contains any">-startvm;vrun.exe -vm</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
      <!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with vssadmin Detected,Risk=100" groupRelation="and">
        <Image condition="image">vssadmin.exe</Image>
        <CommandLine condition="contains any">delete;resize</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wmic shadowcopy delete Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains all">shadowcopy;delete</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wbadmin.exe</OriginalFileName>
        <CommandLine condition="contains all">SYSTEMSTATEBACKUP;delete</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wmic shadowstorage Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains">wmic shadowstorage SET MaxSpace=</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Destructive WMIC Commands Detected,Risk=100" groupRelation="and">
        <OriginalFileName condition="contains">wmic.exe</OriginalFileName>
        <CommandLine condition="contains any">cleareventlog;call disable;nteventlog where filename</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with diskpart" groupRelation="and">
        <OriginalFileName condition="contains">diskpart.exe</OriginalFileName>
        <CommandLine condition="contains any">format;clean;delete;remove</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with manage-bde.exe" groupRelation="and">
        <OriginalFileName condition="contains">manage-bde.exe</OriginalFileName>
        <CommandLine condition="contains any">changepin;changepassword;changekey;wipefreespace;lock;/on;-on;/off;-off;-add;/add;-pw;/pw</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with manage-bde.wsf" groupRelation="and">
        <CommandLine condition="contains">manage-bde.wsf</CommandLine>
        <CommandLine condition="contains any">changepin;changepassword;changekey;wipefreespace;lock;/on;-on;/off;-off;-add;/add;-pw;/pw</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Data Destruction with format" groupRelation="and">
        <CommandLine condition="begin with">format </CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with bcdedit Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">bootstatuspolicy ignoreallfailures</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with bcdedit Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">recoveryenabled No</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with get-wmiobject Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">Win32_Shadowcopy</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with sdelete Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">sdelete</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">delete catalog</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">wbadmin delete catalog</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Data Destruction with erase Detected,Risk=100" groupRelation="and">
        <CommandLine condition="contains">erase</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=2,Alert=vShadow Commands" groupRelation="and">
        <CommandLine condition="contains all">-nw;-exec=</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=2,Alert=vShadow Commands" groupRelation="and">
        <CommandLine condition="contains all">/nw;/exec=</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=vShadow Commands" groupRelation="and">
        <CommandLine condition="contains all">-p;-nw</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=vShadow Commands" groupRelation="and">
        <CommandLine condition="contains all">/p;/nw</CommandLine>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with shred Detected,Risk=100" groupRelation="and">
        <Image condition="contains">shred</Image>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Diskshadow Execution,Risk=70" groupRelation="and">
        <ParentImage condition="contains">diskshadow</ParentImage>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Command Line File Deletion,Risk=100" groupRelation="or">
        <CommandLine condition="contains all"> del ; /f </CommandLine>
        <CommandLine condition="contains all"> del ; -f </CommandLine>
        <CommandLine condition="contains all"> rmdir ; /s ; /q </CommandLine>
        <CommandLine condition="contains all"> rmdir ; -s ; -q </CommandLine>
        <CommandLine condition="contains all"> rd ; /s ; /q </CommandLine>
        <CommandLine condition="contains all"> rd ; -s ; -q </CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Potential Ransomware indicator" groupRelation="and">
        <CommandLine condition="contains">usn deletejournal</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Defacement-->
      <!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
      <Rule name="Attack=T1107,Technique=File Deletion,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=FSUtil USN Journal Deletion,Risk=60" groupRelation="and">
        <Image condition="image">fsutil.exe</Image>
        <CommandLine condition="contains all">usn;deletejournal</CommandLine>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
      <!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Service Stop-->
      <!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
      <Rule name="Attack=T1059,Technique=Command-Line Interface,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Malicious Keywords from Exploitation Frameworks,Author=Florian Roth" groupRelation="and">
        <CommandLine condition="contains any">AdjustTokenPrivileges;IMAGE_NT_OPTIONAL_HDR64_MAGIC;LSA_UNICODE_STRING;Management.Automation.RuntimeException;Metasploit;Microsoft.Win32.UnsafeNativeMethods;Mimikatz;MiniDumpWriteDump;Net.Sockets.SocketFlags;PAGE_EXECUTE_READ;ReadProcessMemory.Invoke;Reflection.Assembly;Runtime.InteropServices;SECURITY_DELEGATION;SE_PRIVILEGE_ENABLED;System.Runtime.InteropServices;System.Security.Cryptography;TOKEN_ADJUST_PRIVILEGES;TOKEN_ALL_ACCESS;TOKEN_ASSIGN_PRIMARY;TOKEN_DUPLICATE;TOKEN_ELEVATION;TOKEN_IMPERSONATE;TOKEN_INFORMATION_CLASS;TOKEN_PRIVILEGES;TOKEN_QUERY;powerkatz</CommandLine>
        <Image condition="excludes all">C:\Program Files;\LightingService\AsusInstallVerifier.exe</Image>
      </Rule>
      <!--Crypto Currency Miner Detections-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=4,Alert=Crypto Currency Miner Detected,Attack=T1496,Technique=Resource Hijacking,Tactic=Impact" groupRelation="or">
        <CommandLine condition="contains any">ahashpool;blazepool;blockmasters;blockmasterscoins;ccminer;cgminer;coinhive;hashrefinery;minergate;miningpoolhubcoins;nicehash;poolname;poolpassword;poolurl;rainbowminer;sgminer;stratum+tcp;xmrMiner;xmrig;yiimp;zergpool;zergpoolcoins;zpool</CommandLine>
        <Description condition="contains any">CPU miner;GPU miner;Lime Miner;XMRig CPU miner; miner</Description>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Solarwinds/FireEye sunburst hashes,Risk=100" groupRelation="and">
        <Hashes condition="contains any">b91ce2fa41029f6955bff20079468448;02af7cec58b9a5da1c542b5a32151ba1;2c4a910a1299cdae2a4e55988a2f102e;846e27a652a5e1bfbd0ddd38a16dc865;4f2eb62fa529c0283b28d05ddd311fae;56ceb6d0011d87b6e4d7023d7ef85676</Hashes>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=plink.exe 64bit imphash matched,Risk=40" groupRelation="and">
        <Hashes condition="end with">87AECF008D87EC86EC8B00A2394B3E6C</Hashes>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=plunk.exe 32bit imphash matched,Risk=40" groupRelation="and">
        <Hashes condition="end with">FB3F0D0DE8B80EA8CFAB2A025EC6B833</Hashes>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=putty.exe 64bit imphash matched,Risk=40" groupRelation="and">
        <Hashes condition="end with">F4067FBF7FFF6945D0BB485B727B39AA</Hashes>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Generic APT Hash Detection,Risk=100" groupRelation="and">
        <Hashes condition="contains any">4a069c1abe5aca148d5a8fdabc26751e;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;304772c80b157a916c7041f2f15939fb;291ff87948e45914424cec9510c297da;a4b42c2c95d1f2ff12171a01c86cd64f;98908ce6f80ecc48628c8d2bf5b2a50c;849a2b0dc80aeca3d175c139efe5221c;807d86da63f0db1fc746d1f0b05bc357;322cb39bc049aa69136925137906d855;86A4CAC227078B9C95C560C8F0370BF0;36dd195269979e01a29e37c488928497;7d9d29c1c03461608bcab930fef2f568;eac3e3ece94bc84e922ec077efb15edd;b4abe604916c04fe3dd8b9cb3d501d3f;88777aacd5f16599547926a4c9202862;128CECC59C91C0D0574BC1075FE7CB40;17a36ac3e31f3a18936552aff2c80249;0f49621b06f2cdaac8850c6e9581a594;3d129263f6a48647f103a04446fb0c2f;71345b139166482acaa568ac8816c7bc;1b60021baedc3f9201bcdb40e9b87f62;5E022694C0DBD1FBBC263D608E577949;cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5;b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04;2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec;6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11;5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c;37cd353621b0f4fc6981b50071c94f01;daf2da52475fd8981b19ec3c321a983c;afcdf79be1557326c854b6e20cb900a7;2f40abbb4f78e77745f0e657a19903fc953cc664;37b4496e650b3994312c838435013560b3ca8571;478dc5a5f934c62a9246f7d1fc275868f568bc07;1a2ab4df156ccd685f795baee7df49f8e701f271d3e5676b507112e30ce03c42;2c1d3d0a9c6f76726994b88589219cb8d9c39dd9924bc8d2d02bf41d955fe326;5c776a33568f4c16fee7140c249c0d2b1e0798a96c7a01bfd2d5684e58c9bb32;5fc4b0076eac7aa7815302b0c3158076e3569086c4c6aa2f71cd258238440d14;08c34c6ac9186b61d9f29a77ef5e618067e0bc9fe85cab1ad25dc6049c376949;758598370c3b84c6fbb452e3d7119f700f970ed566171e879d3cb41102154272;bef59b9a3e00a14956e0cd4a1f3e7524448cbe5d3cc1295d95a15b83a3579c59;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230;0ac48cfa2ff8351365e99c1d26e082ad;0e9afd3a870906ebf34a0b66d8b07435;1aadf739782afcae6d1c3e4d1f315cbd;2a6f7ec77ab6bd4297e7b15ae06e2e61;3a771efb7ba2cd0df247ab570e1408b2;3d75c72144d873b3c1c4977fbafe9184;3dfebce4703f30eed713d795b90538b5;3ffd2915d285ad748202469d4a04e1f5;4e39620afca6f60bb30e031ddc5a4330;6cfd131fef548fcd60fbcdb59317df8e;7bcd736a2394fc49f3e27b3987cce640;7bfba2c69bed6b160261bdbf2b826401;7bfbd72441e1f2ed48fbc0f33be00f24;7c733607a0932b1b9a9e27cd6ab55fe0;7d5265e814843b24fcb3787768129040;08e82dc7bae524884b7dc2134942aadb;8da15a97eaf69ff7ee184fc446f19cf1;9ad6fa6fdedb2df8055b3d30bd6f64f1;9c115e9a81d25f9d88e7aaa4313d9a8f;16ab79fb2fd92db0b1f38bedb2f02ed8;21feb6aa15e02bb0cddbd544605aabad;21feb6aa15e02bb0cddbd544605aabad;22d142f11cf2a30ea4953e1fffb0fa7e;36db24006e2b492cafb75f2663f241b2;51a7068640af42c3a7c1b94f1c11ab9d;69a19abf5ba56ee07cdd3425b07cf8bf;72dc98449b45a7f1ccdef27d51e31e91;77a745b07d9c453650dd7f683b02b3ed;80c37e062aa4c94697f287352acf2e9d;92f8e3f0f1f7cc49fad797a62a169acd;235d427f94630575a4ea4bff180ecf5d;320b2f1d9551b5d1df4fb19bd9ab253a;490a140093b5870a47edc29f33542fd2;520ee02668a1c7b7c262708e12b1ba6b;649ef1dd4a5411d3afcf108d57ff87af;684eca6b62d69ce899a3ec3bb04d0a5b;815f1f8a7bc1e6f94cb5c416e381a110;0969b2b399a8d4cd2d751824d0d842b4;2317d65da4639f4246de200650a70753;04078ef95a70a04e95bda06cc7bec3fa;8035a8a143765551ca7db4bc5efb5dfd;8403a28e0bffa9cc085e7b662d0d5412;9003cfaac523e94d5479dc6a10575e60;9793afcea43110610757bd3b800de517;27612cb03c89158225ca201721ea1aad;44619a88a6cff63523163c6a4cf375dd;061089d8cb0ca58e660ce2e433a689b3;81229c1e272218eeda14892fa8425883;84730a6e426fbd3cf6b821c59674c8a0;533340c54bd25256873b3dca34d7f74e;57314359df11ffdf476f809671ec0275;99828721ac1a0e32e4582c3f615d6e57;412956675fbc3f8c51f438c1abc100eb;5985087678414143d33ffc6e8863b887;a43d3b31575846fa4c3992b4143a06da;a571660c9cf1696a2f4689b2007a12c7;b4e67706103c3b8ee148394ebee3f268;b9c208ea8115232bfd9ec2c62f32d6b8;b9cf4301b7b186a75e82a04e87b30fe4;b72737b464e50aa3664321e8e001ff32;bfe3f6a79cad5b9c642bb56f8037c43b;c0e72eb4c9f897410c795c1b360090ef;c1e7850da5604e081b9647b58248d7e8;c3e255888211d74cc6e3fb66b69bbffb;cacaa3bf3b2801956318251db5e90f3c;cdb303f61a47720c7a8c5086e6b2a743;ce8ce92fb6565181572dce00d69c24f8;d8f1356bebda9e77f480a6a60eab36bb;d9e9f22988d43d73d79db6ee178d70a4;d5377dc1821c935302c065ad8432c0d2;df91b86189adb0a11c47ce2405878fa1;e17bd40f5b5005f4a0c61f9e79a9d8c2;f559c87b4a14a4be1bd84df6553aaf56;fc53f2cd780cd3a01a4299b8445f8511;ffc7305cb24c1955f9625e525d58aeee</Hashes>
      </Rule>
      <Rule name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=4,Alert=Windows Credential Editor Detection,Risk=70" groupRelation="and">
        <Hashes condition="contains any">e96a73c7bf33a464c510ede582318bf2;a53a02b997935fd8eedcb5f7abab9b9f</Hashes>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Ransomware Hash Detection,Risk=100" groupRelation="and">
        <Hashes condition="contains any">d326e629a90e78825645963b35e53a6a;c579341f86f7e962719c7113943bb6e4;dc5733c013378fa418d13773f5bfe6f1;b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d;965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26;4a069c1abe5aca148d5a8fdabc26751e;dc7e564809d6c2a2f3457c3c9b91f22b;FE2CA1BE3BDA2A757036A89E54CC02DB;5470f0644589685000154cb7d3f60280acb16e39ca961cce2c016078b303bc1b</Hashes>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Ursniff Bank Malware,Risk=100" groupRelation="and">
        <Hashes condition="contains">53841a0c6a3ff92976db08bfdf95e083</Hashes>
      </Rule>
      <!--UEBA Activities-->
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: passwordless meeting Start,Risk=30" groupRelation="and">
        <CommandLine condition="contains">zoommtg</CommandLine>
        <CommandLine condition="excludes">pwd=</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: Video and Audio Session Start" groupRelation="and">
        <CommandLine condition="contains">zoommtg</CommandLine>
        <CommandLine condition="contains">zc=0</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: Screen Share,Risk=70" groupRelation="and">
        <CommandLine condition="contains">zoommtg</CommandLine>
        <CommandLine condition="contains">zc=1</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Microsoft Teams URL clicked" groupRelation="and">
        <CommandLine condition="contains">msteams:</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Webex URL clicked" groupRelation="and">
        <CommandLine condition="contains">wbx:</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Executed files within Downloads,Risk=30" groupRelation="and">
        <Image condition="contains">C:\Users\</Image>
        <Image condition="contains">\Downloads\</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Executed files on Desktop,Risk=10" groupRelation="and">
        <Image condition="contains">C:\Users\</Image>
        <Image condition="contains">\Desktop\</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Linux tools installed on windows,Risk=30" groupRelation="and">
        <Image condition="contains any">\awk.exe;\sed.exe</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Execution Locations,Risk=30" groupRelation="and">
        <Image condition="contains any">C:\Users\Public\;$Recyclebin;\Desktop\;\Content.Outlook\</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Desc=Suspicious Execution extensions,Risk=30" groupRelation="and">
        <Image condition="contains any">C:\Users\Public\;$Recyclebin;\Desktop\;\Content.Outlook\;\Downloads\</Image>
        <CommandLine condition="contains any">.html;.hta;.iso;.js;.bat;.cmd;.cmdline;.vbs;.vb;.vbe;.reg;.com</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=LOLBins" groupRelation="and">
        <CommandLine condition="contains any">-s -n -u -i:http:</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=LOLBins" groupRelation="and">
        <CommandLine condition="contains any">/s /n /u /i:http:</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="contains">listena</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">assoc </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">del </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">expand </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">md </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">move </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">rd </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">ren </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">set </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="begin with">setx </CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="contains any">bginfo.bgi /popup /nolicprompt;bginfo.bgi -popup -nolicprompt</CommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" groupRelation="and">
        <CommandLine condition="image">find.exe</CommandLine>
      </Rule>
      <Rule name="Attack=T1595,Technique=Hacking,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=FireEye/Fin6 Hacking tools" groupRelation="and">
        <CommandLine condition="contains">grabff</CommandLine>
      </Rule>
      <Rule name="Attack=T1595,Technique=Hacking,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=FireEye/Fin6 Hacking tools" groupRelation="and">
        <CommandLine condition="contains">routerscan</CommandLine>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Hacking with python,Risk=70" groupRelation="and">
        <CommandLine condition="contains">pythonEngine.Execute</CommandLine>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Hacking with session hijacking,Risk=100" groupRelation="and">
        <CommandLine condition="contains">sesshijack</CommandLine>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=File Protocol Handler Execution" groupRelation="and">
        <CommandLine condition="contains">file://</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=HTML APP Host" groupRelation="and">
        <Description condition="end with">HTML Application host</Description>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Manager Profile Installer" groupRelation="and">
        <Description condition="end with">Manager Profile Installer</Description>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Microsoft Application Virtualization Injector" groupRelation="and">
        <Description condition="contains">Microsoft Application Virtualization Injector</Description>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=App Compat Database installer" groupRelation="and">
        <Description condition="contains">Application Compatibility Database Installer</Description>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <Image condition="image">popd.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <Image condition="image">pushd.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" groupRelation="and">
        <Image condition="image">subst.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=detect aliases" groupRelation="and">
        <Image condition="image">doskey.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=detect cls in batch scripts" groupRelation="and">
        <Image condition="image">cls.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=UNC\Device Launches - Image begins with \,Risk=10" groupRelation="and">
        <Image condition="begin with">\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=IIS Child Processes" groupRelation="and">
        <ParentCommandLine condition="begin with">C:\Windows\system32\svchost.exe -k iissvcs</ParentCommandLine>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=UNC\Device Launches - Parent Image begins with \,Risk=10" groupRelation="and">
        <ParentImage condition="begin with">\</ParentImage>
      </Rule>
      <Rule name="Attack=T1059,DS=Process: Process Creation,Level=0,Desc=Process Spawned from Acrobat" groupRelation="and">
        <ParentImage condition="image">acrobat.exe</ParentImage>
      </Rule>
      <Rule name="Attack=T1059,DS=Process: Process Creation,Level=0,Desc=Process Spawned from Adobe Reader" groupRelation="and">
        <ParentImage condition="image">acrord32.exe</ParentImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Process Spawned from JAVA" groupRelation="and">
        <ParentImage condition="image">java.exe</ParentImage>
        <ParentImage condition="excludes">C:\ProgramData\Cavelo\jre\bin\java.exe</ParentImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Process Spawned from JAVA" groupRelation="and">
        <ParentImage condition="image">javaw.exe</ParentImage>
      </Rule>
      <!--Detection of Output Redirection-->
      <!-- Disabled for now: Reason: Overrides other detections, waiting on Sysmon multiple rule firing
      <CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">2></CommandLine>
      <CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">&gt;</CommandLine>
      <CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">&lt;</CommandLine>
      -->
      <!--Detect Multiple Commands-->
      <Rule  name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=SVCHost Processes" groupRelation="and">
        <Image condition="image">C:\Windows\system32\svchost.exe</Image>
      </Rule>
      <Rule name="Attack=T1222,Technique=File Permissions Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Permission Modifications with icacls or cacls" groupRelation="and">
        <Image condition="image">cacls.exe</Image>
      </Rule>
      <Rule name="Attack=T1222,Technique=File Permissions Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Ownership Permission Modifications with takeown" groupRelation="and">
        <Image condition="image">takeown.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: MsAccess MACRO Exec" groupRelation="and">
        <CommandLine condition="contains">/x Macro</CommandLine>
      </Rule>
      <Rule  name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Desc=Suspicious pipe via commandline" groupRelation="and">
        <CommandLine condition="contains">\pipe\</CommandLine>
        <CommandLine condition="excludes">&gt;</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: RDP Port" groupRelation="and">
        <CommandLine condition="contains">/noprofile</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: Schtasks" groupRelation="and">
        <CommandLine condition="contains">/sc ONEVENT</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=Execution run from \\VBOXSVR share" groupRelation="and">
        <CommandLine condition="contains">\\VBOXSVR</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" groupRelation="and">
        <CommandLine condition="contains">| more</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" groupRelation="and">
        <CommandLine condition="contains">|more</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Execution from \\tsclient share" groupRelation="and">
        <CommandLine condition="contains">\\tsclient</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Processor ARCH command Line" groupRelation="and">
        <CommandLine condition="contains">%PROCESSOR_ARCHITECTURE%</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=SysNative detected" groupRelation="and">
        <CommandLine condition="contains">sysnative</CommandLine>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=AutoIT Application Detected" groupRelation="and">
        <Description condition="contains">AutoIt</Description>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Windows Filter loader" groupRelation="and">
        <Description condition="contains">Microsoft Filter Loader</Description>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" groupRelation="and">
        <Image condition="is">more.com</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.Net Framework executables" groupRelation="and">
        <Image condition="contains">:\Windows\Microsoft.NET\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Acrobat Reader Launches" groupRelation="and">
        <Image condition="image">acrord32.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Gpupdate Launched" groupRelation="and">
        <Image condition="image">gpupdate.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.Net Framework executables" groupRelation="and">
        <ParentImage condition="contains">:\Windows\Microsoft.NET\</ParentImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=System Child Processes" groupRelation="and">
        <ParentImage condition="is">System</ParentImage>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Generic User Execution,Risk=0" groupRelation="and">
        <ParentImage condition="image">explorer.exe</ParentImage>
        <Image condition="excludes any">\regedit.exe;\cmd.exe;terminal;\powershell</Image>
      </Rule>
      <!-- Log other command line events, this sometimes conflicts with rules, add to exclusions as necessary-->
      <!-- <ParentCommandLine name="Information=Uncategorized Events,DS=Process: Process Creation" condition="contains any">/;\;-;unknown;</ParentCommandLine>-->
    </ProcessCreate>
  </RuleGroup>
  <RuleGroup name="RG=Process Create Exclude Group" groupRelation="or">
    <ProcessCreate onmatch="exclude">
      <Rule name="exclude werfault from wmi" groupRelation="and">
        <Image condition="image">C:\Windows\System32\WerFault.exe</Image>
        <ParentImage condition="image">C:\Windows\System32\wbem\WmiPrvSE.exe</ParentImage>
      </Rule>
      <Rule name="exclude armoury crate from cmdline file deletion rule" groupRelation="and">
        <ParentImage condition="image">C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.Service.exe</ParentImage>
      </Rule>
    </ProcessCreate>
  </RuleGroup>
  <!--SYSMON EVENT ID 2 : FILE CREATION TIME RETROACTIVELY CHANGED IN THE FILESYSTEM [FileCreateTime]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime, PreviousCreationUtcTime-->
  <RuleGroup name="RG=FileCreateTime Include Group" groupRelation="or">
    <FileCreateTime onmatch="include">
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="begin with">C:\Users</Image>
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="begin with">C:\ProgramData</Image>
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\Temp\</Image>
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\tmp\</Image>
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\drivers\</Image>
      <Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\Download</Image>
    </FileCreateTime>
  </RuleGroup>
  <RuleGroup name="RG=FileCreateTime Exclude Group" groupRelation="or">
    <FileCreateTime onmatch="exclude">
      <Image condition="image">C:\Windows\system32\backgroundTaskHost.exe</Image>
      <Image condition="image">TrustedInstaller.exe</Image>
      <Image condition="image">OneDrive.exe</Image>
      <Image condition="image">vivaldi.exe</Image>
      <Image condition="image">chrome.exe</Image>
      <Image condition="image">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
      <Image condition="contains">setup</Image>
      <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
      <Image condition="end with">\AppData\Local\Microsoft\Edge SxS\Application\msedge.exe</Image>
    </FileCreateTime>
  </RuleGroup>
  <!--SYSMON EVENT ID 3 : NETWORK CONNECTION INITIATED [NetworkConnect]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, User, Protocol, Initiated, SourceIsIpv6, SourceIp, SourceHostname, SourcePort, SourcePortName, DestinationIsIpV6, DestinationIp, DestinationHostname, DestinationPort, DestinationPortName-->
  <RuleGroup name="RG=NetworkConnect Include Group" groupRelation="or">
    <NetworkConnect onmatch="include">
      <!--MITRE ATT&CK TACTIC: Reconnaissance-->
      <!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Census Network Connection,Risk=40" groupRelation="and">
        <DestinationHostname condition="contains">census</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=ResearchScan Network Connection,Risk=70" groupRelation="and">
        <DestinationHostname condition="contains">researchscan</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Scanhub Network Connection,Risk=70" groupRelation="and">
        <DestinationHostname condition="contains">scanhub</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Shadow Network Connection,Risk=50" groupRelation="and">
        <DestinationHostname condition="contains">shadow</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Shodan Network Connection,Risk=50" groupRelation="and">
        <DestinationHostname condition="contains">shodan</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Exchange 0day Attackers from September 2022,Risk=100" groupRelation="or">
        <DestinationIp condition="is any">137.184.67.33;206.188.196.77;125.212.220.48;5.180.61.17;47.242.39.92;61.244.94.85;86.48.6.69;86.48.12.64;94.140.8.48;94.140.8.113;103.9.76.208;103.9.76.211;104.244.79.6;112.118.48.186;122.155.174.188;125.212.241.134;185.220.101.182;194.150.167.88;212.119.34.11</DestinationIp>
        <DestinationIp condition="begin with">137.184.67.</DestinationIp>
        <DestinationHostname condition="is any">httpbin.org</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Advanced IP scanner Detected,Risk=90"  groupRelation="or">
        <DestinationHostname condition="contains any">advanced-ip-scanner.com</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Kali Linux Distribution Download/Apt URL,Risk=90"  groupRelation="or">
        <DestinationHostname condition="contains any">kali.download</DestinationHostname>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
      <!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
      <!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

      <!--MITRE ATT&CK TACTIC: Resource Development-->
      <!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

      <!--MITRE ATT&CK TACTIC: Initial Access-->
      <!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->

      <!--MITRE ATT&CK TACTIC: Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
      <Rule name="Attack=T1059,Technique=Visual Basic,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=WSCRIPT Network connection,Risk=80" groupRelation="and">
        <Image condition="image">wscript.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
      <!--MITRE ATT&CK TECHNIQUE: Native API-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <Rule name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution/Persistence/Privilege Escalation,DS=Network Traffic: Network Connection Creation,Level=4,Alert=AT.EXE Task Scheduler Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">at.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution/Persistence/Privilege Escalation,DS=Network Traffic: Network Connection Creation,Level=4,Alert=SCHTasks.exe Task Scheduler Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">schtasks.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: System Services-->
      <!--MITRE ATT&CK TECHNIQUE: User Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->

      <!--MITRE ATT&CK TACTIC: Persistence-->
      <!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
      <!--MITRE ATT&CK TECHNIQUE: Create Account-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Privilege Escalation-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->

      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
      <!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Masquerading-->
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Temp file location network connection,Risk=30" groupRelation="and">
        <Image condition="contains">\temp\</Image>
        <DestinationIp condition="excludes any">127.0.0.1</DestinationIp>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from wwwroot folder: Possible webshell,Risk=100" groupRelation="and">
        <Image condition="contains">\wwwroot\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in addins" groupRelation="and">
        <Image condition="contains">\Windows\addins\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from Windows\repair Folder,Risk=70" groupRelation="and">
        <Image condition="begin with">C:\Windows\repair\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from htdocs folder,Risk=70" groupRelation="and">
        <Image condition="contains">\htdocs\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from systemprofile Folder,Risk=30" groupRelation="and">
        <Image condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Intel logs,Risk=100" groupRelation="and">
        <Image condition="begin with">C:\Intel\Logs\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Windows\Addins Folder,Risk=70" groupRelation="and">
        <Image condition="begin with">C:\Windows\addins\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Windows\security Folder,Risk=100" groupRelation="and">
        <Image condition="begin with">C:\Windows\security\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from windows help folder,Risk=70" groupRelation="and">
        <Image condition="begin with">C:\Windows\Help\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Suspicious network connection from Recycle bin,Risk=100" groupRelation="and">
        <Image condition="contains">$RECYCLE.BIN</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in Windows Debug folder,Risk=100" groupRelation="and">
        <Image condition="begin with">C:\Windows\Debug\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in Windows Font folder,Risk=100" groupRelation="and">
        <Image condition="begin with">C:\Windows\Fonts\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Perflogs unusual network connection,Risk=70" groupRelation="and">
        <Image condition="begin with">C:\PerfLogs\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Unusual network connection from Recycle bin,Risk=100" groupRelation="and">
        <Image condition="contains">:\$Recycle.bin\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network Connection from Default User folder,Risk=30" groupRelation="and">
        <Image condition="contains">:\Users\Default\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network Connection from NetworkService User folder,Risk=30" groupRelation="and">
        <Image condition="begin with">C:\Users\NetworkService\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network connection from Public User folder,Risk=30" groupRelation="and">
        <Image condition="begin with">C:\Users\Public\</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network connection within Media Folder,Risk=30" groupRelation="and">
        <Image condition="begin with">C:\Windows\Media\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Input Method Network Connection" groupRelation="and">
        <Image condition="contains">\Windows\IME\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Programdata Network Connection" groupRelation="and">
        <Image condition="begin with">C:\ProgramData</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
      <!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
      <!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
      <!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
      <Rule name="Attack=T1027.004,Tactic=Defense Evasion,Technique=Compile After Delivery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=CSC Network Conections" groupRelation="and">
        <Image condition="image">CSC.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
      <!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
      <!--MITRE ATT&CK TECHNIQUE: Rootkit-->
      <!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=infDefaultInstall Network Connection" groupRelation="and">
        <Image condition="image">infDefaultInstall.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=Control Panel,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Control Panel network connection" groupRelation="and">
        <Image condition="image">SyncAppvPublishingServer.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Installutil-->
      <Rule name="Attack=T1218.004,Technique=InstallUtil,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=InstallUtil network connection" groupRelation="and">
        <Image condition="image">InstallUtil.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Msiexec-->
      <Rule name="Attack=T1218.007,Technique=MSIExec,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=MSIExec Network connection,Risk=70" groupRelation="and">
        <Image condition="image">msiexec.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvcs/regasm-->
      <Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=RegAsm shellcode C2 connection" groupRelation="and">
        <Image condition="contains any">regasm.exe;regsvcs.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Mavinject-->
      <Rule name="Attack=T1218.013,Technique=Signed Binary Proxy Execution: Mavinject,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Mavinject detected,Risk=80" groupRelation="and">
        <Image condition="image">Mavinject.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Template Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
      <Rule name="Attack=T1127,Tactic=Defense Evasion,Technique=Signed Binary Proxy Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=MSBuild Network Conections" groupRelation="and">
        <Image condition="image">msbuild.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
      <!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

      <!--MITRE ATT&CK TACTIC: Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Brute Force-->
      <!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
      <!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
      <!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
      <!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->

      <!--MITRE ATT&CK TACTIC: Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
      <!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
      <Rule name="Attack=T1482,Technique=Domain Trust Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DSQuery network connection" groupRelation="and">
        <Image condition="image">dsquery.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Query Registry-->
      <!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
      <Rule name="Attack=T1518,Technique=Software Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DriverQuery Network Connection" groupRelation="and">
        <Image condition="image">driverquery.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
      <Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=NBTSTAT Query,Risk=30" groupRelation="and">
        <Image condition="image">nbtstat.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
      <Rule name="Attack=T1021,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=net.exe nework connection,Risk=30" groupRelation="and">
        <Image condition="image">net.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=net.exe nework connection,Risk=30" groupRelation="and">
        <Image condition="image">net1.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=2,Alert=QWinsta User enumeration,Risk=30" groupRelation="and">
        <Image condition="image">qwinsta.exe</Image>
      </Rule>
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=3,Alert=RWinsta Forced User Logoff,Risk=30" groupRelation="and">
        <Image condition="image">rwinsta.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

      <!--MITRE ATT&CK TACTIC: Lateral Movement-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
      <!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Services-->
      <Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Suspicious RDP Connection 3389,Risk=70" groupRelation="and">
        <Initiated>true</Initiated>
        <DestinationPort condition="is">3389</DestinationPort>
        <Image condition="excludes">AutomationManager.ScriptRunner64.exe</Image>
        <Image condition="excludes">C:\Program Files (x86)\VMware\VMware Remote Console\vmrc.exe</Image>
        <Image condition="excludes">C:\Program Files\VMware\VMware Remote Console\vmrc.exe</Image>
        <Image condition="excludes">C:\Program Files\WindowsApps\Microsoft.RemoteDesktop_</Image>
        <Image condition="excludes">CtxLicUsageRecorder.exe</Image>
        <Image condition="excludes">FSAssessment.exe</Image>
        <Image condition="excludes">FSDiscovery.exe</Image>
        <Image condition="excludes">MobaRTE.exe</Image>
        <Image condition="excludes">RDCMan.exe</Image>
        <Image condition="excludes">RSSensor.exe</Image>
        <Image condition="excludes">RTS2App.exe</Image>
        <Image condition="excludes">RTSApp.exe</Image>
        <Image condition="excludes">RemoteDesktopManager64.exe</Image>
        <Image condition="excludes">RemoteDesktopManager.exe</Image>
        <Image condition="excludes">RemoteDesktopManagerFree.exe</Image>
        <Image condition="excludes">Terminals.exe</Image>
        <Image condition="excludes">chrome.exe</Image>
        <Image condition="excludes">mRemote.exe</Image>
        <Image condition="excludes">mRemoteNG.exe</Image>
        <Image condition="excludes">mstsc.exe</Image>
        <Image condition="excludes">spiceworks-finder.exe</Image>
        <Image condition="excludes">svchost.exe</Image>
        <Image condition="excludes">thor64.exe</Image>
        <Image condition="excludes">thor.exe</Image>
        <Image condition="excludes">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe</Image>
        <Image condition="excludes">C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe</Image>
        <Image condition="excludes">SentinelRanger.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Suspicious RDP Connection 3391,Risk=70" groupRelation="and">
        <Initiated>true</Initiated>
        <DestinationPort condition="is">3391</DestinationPort>
        <Image condition="excludes">AutomationManager.ScriptRunner64.exe</Image>
        <Image condition="excludes">C:\Program Files (x86)\VMware\VMware Remote Console\vmrc.exe</Image>
        <Image condition="excludes">C:\Program Files\VMware\VMware Remote Console\vmrc.exe</Image>
        <Image condition="excludes">C:\Program Files\WindowsApps\Microsoft.RemoteDesktop_</Image>
        <Image condition="excludes">CtxLicUsageRecorder.exe</Image>
        <Image condition="excludes">FSAssessment.exe</Image>
        <Image condition="excludes">FSDiscovery.exe</Image>
        <Image condition="excludes">MobaRTE.exe</Image>
        <Image condition="excludes">RDCMan.exe</Image>
        <Image condition="excludes">RSSensor.exe</Image>
        <Image condition="excludes">RTS2App.exe</Image>
        <Image condition="excludes">RTSApp.exe</Image>
        <Image condition="excludes">RemoteDesktopManager64.exe</Image>
        <Image condition="excludes">RemoteDesktopManager.exe</Image>
        <Image condition="excludes">RemoteDesktopManagerFree.exe</Image>
        <Image condition="excludes">Terminals.exe</Image>
        <Image condition="excludes">chrome.exe</Image>
        <Image condition="excludes">mRemote.exe</Image>
        <Image condition="excludes">mRemoteNG.exe</Image>
        <Image condition="excludes">mstsc.exe</Image>
        <Image condition="excludes">spiceworks-finder.exe</Image>
        <Image condition="excludes">svchost.exe</Image>
        <Image condition="excludes">thor64.exe</Image>
        <Image condition="excludes">thor.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Localhost RDP Tunneling Detection,Risk=70" groupRelation="and">
        <Initiated>true</Initiated>
        <DestinationPort condition="is">3389</DestinationPort>
        <DestinationIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</DestinationIp>
        <Image condition="excludes">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe</Image>
      </Rule>
      <Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Link-Local RDP Tunnel Detection,Risk=70" groupRelation="and">
        <Initiated>true</Initiated>
        <DestinationPort condition="is">3389</DestinationPort>
        <DestinationIp condition="begin with">fe80:0</DestinationIp>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=SSH Connection with Putty,Risk=80" groupRelation="and">
        <Image condition="contains any">putty.exe;kitty.exe;kitty_portable.exe</Image>
      </Rule>
      <Rule name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows Remote Management connection,Risk=0" groupRelation="and">
        <Image condition="image">wsmprovhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=PSFTP Connection,Risk=70" groupRelation="and">
        <Image condition="image">psftp.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote Registry via command line,Risk=30" groupRelation="and">
        <Image condition="image">reg.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote Registry via command line,Risk=80" groupRelation="and">
        <Image condition="contains">psshutdown</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote password change with PSPasswd,Risk=80" groupRelation="and">
        <Image condition="contains">PsPasswd</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote querying of services,Risk=80" groupRelation="and">
        <Image condition="contains">psservice</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=SSH Connection with ssh.exe,Risk=30" groupRelation="and">
        <Image condition="image">ssh.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Sysinternals PSEXE Tools,Risk=100" groupRelation="and">
        <Image condition="contains">psexe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=TSFTP Connection,Risk=70" groupRelation="and">
        <Image condition="image">tftp.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Telnet Connection,Risk=30" groupRelation="and">
        <Image condition="image">telnet.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=MSTSC Remote Desktop Connection" groupRelation="and">
        <Image condition="image">mstsc.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote WMIC commands,Risk=30" groupRelation="and">
        <Image condition="image">wmic.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=SC.exe Network Connection" groupRelation="and">
        <Image condition="image">sc.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Sysinternals PSKILL Tools,Risk=80" groupRelation="and">
        <Image condition="contains">pskill</Image>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DSQuery network connection" groupRelation="and">
        <Image condition="image">dsquery.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Automated SSH Connection with Putty PLink,Risk=30" groupRelation="and">
        <Image condition="image">plink.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC" groupRelation="and">
        <Image condition="image">vnc.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC Viewer" groupRelation="and">
        <Image condition="image">vncviewer.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC Service" groupRelation="and">
        <Image condition="image">vncservice.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation" groupRelation="and">
        <Image condition="image">omniinet.exe</Image>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation" groupRelation="and">
        <Image condition="image">hpsmhd.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

      <!--MITRE ATT&CK TACTIC: Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
      <!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Staged-->
      <!--MITRE ATT&CK TECHNIQUE: Email Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Video Capture-->

      <!--MITRE ATT&CK TACTIC: Command and Control-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Cobalt Strike Team Server port,Risk=70" groupRelation="and">
        <DestinationPort condition="is">50050</DestinationPort>
        <Initiated>true</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound SMTP Email Sending,Risk=10" groupRelation="and">
        <DestinationPort condition="is">25</DestinationPort>
        <Image condition="excludes any">\Bin\EdgeTransport.exe;Bin\MSExchangeFrontendTransport.exe</Image>
        <Initiated>true</Initiated>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
      <!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
      <!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
      <!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">powershell.exe</Image>
        <DestinationIp condition="excludes any">0:0:0:0:0:0:0:;127.0.0.1</DestinationIp>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=MSHTA Network Connection,Risk=100" groupRelation="and">
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=CMD Prompt network Connection,Risk=20" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Certutil Connecting to network,Risk=20" groupRelation="and">
        <Image condition="image">certutil.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Bitsadmin Connecting to network,Risk=20" groupRelation="and">
        <Image condition="image">bitsadmin.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Notepad Network Connection" groupRelation="and">
        <Image condition="image">notepad.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RegSVCS Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">regsvcs.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RegSVR32 Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">regsvr32.exe</Image>
      </Rule>
      <Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RunDLL32 Network Connection,Risk=30" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
      <!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy: Multi-hop Proxy-->
      <Rule name="Attack=T1090.003,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Tor Connection" groupRelation="and">
        <Image condition="image">tor.exe</Image>
      </Rule>
      <Rule name="Attack=T1090.003,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Tor2Web,Risk=100" groupRelation="and">
        <DestinationHostname condition="contains any">hiddenservice.net;onion.city;onion.direct;onion.direct;onion.link;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org;onion.to</DestinationHostname>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Web Service-->

      <!--MITRE ATT&CK TACTIC: Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DNS Over HTTPS" groupRelation="and">
        <DestinationHostname condition="contains any">dns.google;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;doh.opendns.com;.quad9.net;dns.cleanbrowsing.org;dns-family.adguard.com;dns.adguard.com;.233py.com;dnscrypt;dnscrypt-cert.oszx.co;dns.oszx.co;doh.dns.sb;doh.defaultroutes.de;doh.tiarap.org;doh.tiar.app;doh.captnemo.in;.aaflalo.me;doh.appliedprivacy.net;doh.dnswarden.com;commons.host;dns.twnic.tw;ibuki.cgnat.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;.seby.io;rdns.faelix.net;doh.li;.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk;adblock.mydns.network;ibksturm.synology.me;jcdns.fun</DestinationHostname>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Desc=privatlab.com Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains all">privatlab.com</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Mega.co.nz Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains any">mega.nz;mega.co.nz</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=3,Alert=PCloud Cloud storage Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains any">.pcloud.com</DestinationHostname>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Impact-->
      <!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
      <!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
      <!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Defacement-->
      <!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
      <!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
      <!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Crypto Currency Miner Detected,Attack=T1496,Technique=Resource Hijacking,Tactic=Impact,Risk=100" groupRelation="and">
        <DestinationHostname condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;analytics.blue;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;estream.to;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;nimpool.io;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;supportxmr;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool</DestinationHostname>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Service Stop-->
      <!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->

      <!--UEBA Rules-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Inbound Windows SVCHost Network Connection" groupRelation="and">
        <Image condition="image">C:\Windows\system32\svchost.exe</Image>
        <DestinationPort condition="is not">3389</DestinationPort>
        <DestinationPort condition="is not">22</DestinationPort>
        <DestinationPort condition="is not">21</DestinationPort>
        <DestinationPort condition="is not">5985</DestinationPort>
        <Initiated>false</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Windows SVCHost Network Connection" groupRelation="and">
        <Image condition="image">C:\Windows\system32\svchost.exe</Image>
        <Initiated>true</Initiated>
        <SourcePort condition="is not">135</SourcePort>
        <SourcePort condition="is not">445</SourcePort>
        <DestinationPort condition="is not">5985</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Non-System port 445 SMB connections" groupRelation="and">
        <Image condition="is not">System</Image>
        <Image condition="excludes">svchost.exe</Image>
        <DestinationPort condition="is">445</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Non-System port 389 LDAP connections" groupRelation="and">
        <Image condition="is not">System</Image>
        <Image condition="excludes any">svchost.exe;lsass.exe</Image>
        <DestinationPort condition="is">389</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Inbound LDAP Connections" groupRelation="and">
        <Image condition="image">C:\Windows\System32\lsass.exe</Image>
        <DestinationPort condition="is">389</DestinationPort>
        <DestinationIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</DestinationIp>
        <SourceHostname condition="excludes any">EXCH</SourceHostname>
        <SourceIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</SourceIp>
        <Initiated>false</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Notepad connecting to the internet" groupRelation="and">
        <Image condition="image">notepad.exe</Image>
        <DestinationIp condition="excludes">127.0.0.1</DestinationIp>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Browsers accessing non-standard ports" groupRelation="and">
        <Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
        <DestinationPort condition="is not">80</DestinationPort>
        <DestinationPort condition="is not">443</DestinationPort>
        <Initiated>true</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Connection to Github,Risk=30" groupRelation="and">
        <DestinationHostname condition="contains">github</DestinationHostname>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Connection to Github,Risk=30" groupRelation="and">
        <DestinationHostname condition="contains">githubusercontent.com</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=Dropbox Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="end with">dropboxapi.com</DestinationHostname>
        <Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=OneDrive Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains">1drv</DestinationHostname>
        <!--We're looking for alternative Programs accessing Onedrive, If Onedrive is not allowed, uncomment onedrive exe exclusions-->
        <Image condition="excludes any">C:\Program Files\Microsoft OneDrive\OneDrive.exe;\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=Box.com Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains all">.box.com;upload</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Mega.co.nz Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains any">mega.nz;mega.co.nz</DestinationHostname>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Privatlab Cloud Exfiltration" groupRelation="and">
        <DestinationHostname condition="contains any">privatlab.com</DestinationHostname>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Social Networking" groupRelation="and">
        <DestinationHostname condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</DestinationHostname>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Internet Relay Chat,Risk=70" groupRelation="and">
        <DestinationHostname condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</DestinationHostname>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Internet Chat,Risk=20" groupRelation="and">
        <DestinationHostname condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</DestinationHostname>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Apache Webserver" groupRelation="and">
        <Image condition="image">apache.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=JAVA Network Connections" groupRelation="and">
        <Image condition="image">java.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Microsoft IIS Webserver" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=PHP Webserver" groupRelation="and">
        <Image condition="contains any">\php-cgi.exe;\php.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Setup Network connectivity" groupRelation="and">
        <Image condition="contains">setup</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tomcat Webserver connectivity" groupRelation="and">
        <Image condition="contains">tomcat</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Uninstaller Network connectivity" groupRelation="and">
        <Image condition="contains">unins</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Unknown Process Connecting to network" groupRelation="and">
        <Image condition="contains">unknown process</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows Explorer Network Connection" groupRelation="and">
        <Image condition="image">explorer.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows SMTP Server" groupRelation="and">
        <Image condition="image">inetinfo.exe</Image>
      </Rule>
      <!--3rd Party tools-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Netcat network connection Detected" groupRelation="and">
        <Image condition="contains any">netcat.exe;nc.exe;nc64.exe;ncat.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Procdump Detected" groupRelation="and">
        <Image condition="contains any">procdump</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=PSExec Network Connection" groupRelation="and">
        <Image condition="contains any">psexe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC Network Connection" groupRelation="and">
        <Image condition="contains any">vnc;vncs;vncv</Image>
      </Rule>
      <Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Port Scan Tool Detected,Risk=100" groupRelation="or">
        <Image condition="contains any">rcpping;tcpping;tcping;routerscan;grabff;Port-Scan;netscan;\nmap;ipscan;nacmdline.exe;advanced_port_scanner.exe;rcpping.exe;nmap.exe;zenmap.exe;advanced_ip_scanner.exe</Image>
      </Rule>
      <!--Destination Ports to Monitor-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Port: 0" groupRelation="and">
        <DestinationPort condition="is">0</DestinationPort>
      </Rule>
      <Rule name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Remoting,Risk=0" groupRelation="and">
        <DestinationPort condition="is">5985</DestinationPort>
      </Rule>
      <Rule name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Remoting,Risk=0" groupRelation="and">
        <DestinationPort condition="is">5986</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=IPSec" groupRelation="and">
        <DestinationPort condition="is">1293</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=L2TP" groupRelation="and">
        <DestinationPort condition="is">1701</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=OpenVPN,Risk=39" groupRelation="and">
        <DestinationPort condition="is">1194</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote Assistance Connection,Risk=20" groupRelation="and">
        <DestinationPort condition="is">3540</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote Desktop Connection,Risk=20" groupRelation="and">
        <DestinationPort condition="is">3389</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=SSH Port,Risk=30" groupRelation="and">
        <DestinationPort condition="is">22</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 1080" groupRelation="and">
        <DestinationPort condition="is">1080</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 3128" groupRelation="and">
        <DestinationPort condition="is">3128</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 8080" groupRelation="and">
        <DestinationPort condition="is">8080</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=TOR Port" groupRelation="and">
        <DestinationPort condition="is">1723</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Telnet Port,Risk=30" groupRelation="and">
        <DestinationPort condition="is">23</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port" groupRelation="and">
        <DestinationPort condition="is">4500</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port,Risk=50" groupRelation="and">
        <DestinationPort condition="is">9001</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port,Risk=50" groupRelation="and">
        <DestinationPort condition="is">9030</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC Port" groupRelation="and">
        <DestinationPort condition="is">5900</DestinationPort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC,Risk=50" groupRelation="and">
        <DestinationPort condition="is">5800</DestinationPort>
      </Rule>
      <!--Source Ports to Monitor-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Port: 0" groupRelation="and">
        <SourcePort condition="is">0</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTP" groupRelation="and">
        <SourcePort condition="is">80</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTPS" groupRelation="and">
        <SourcePort condition="is">443</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=LDAPS" groupRelation="and">
        <SourcePort condition="is">636</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC" groupRelation="and">
        <SourcePort condition="is">5900</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTPS" groupRelation="and">
        <SourcePort condition="is">443</SourcePort>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Web Browser HTTP Connections" groupRelation="and">
        <Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
        <DestinationPort condition="is">80</DestinationPort>
        <Initiated>true</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Non-Browsers Accessing HTTPS" groupRelation="and">
        <Image condition="excludes any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;C:\Program Files\Cavelo\Cavelo Agent\cavelo_windows_amd64.exe;C:\PROGRA~2\BEANYW~1\GETSUP~1\TCIntegratorCommHelper.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe;C:\Program Files (x86)\BeAnywhere Support Express\GetSupportService_N-Central\BASupSrvc.exe</Image>
        <DestinationPortName condition="is">https</DestinationPortName>
        <Initiated>true</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Non-Browsers Accessing HTTP" groupRelation="and">
        <Image condition="excludes any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe</Image>
        <DestinationPortName condition="is">http</DestinationPortName>
        <Initiated>true</Initiated>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Web Browser HTTPS Connections" groupRelation="and">
        <Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
        <DestinationPort condition="is">443</DestinationPort>
        <Initiated>true</Initiated>
      </Rule>
      <!--Suspicious network connections-->
      <Rule name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Dynamic DNS Connection" groupRelation="and">
        <DestinationHostname condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</DestinationHostname>
      </Rule>
    </NetworkConnect>
  </RuleGroup>
  <RuleGroup name="RG=NetworkConnect Exclude Group" groupRelation="or">
    <NetworkConnect onmatch="exclude">
      <Protocol condition="contains">udp</Protocol>
      <Rule name="exclude interprocess communications with localhost" groupRelation="and">
        <Image condition="contains any">System;svchost.exe;oracle.exe;apache.exe;java.exe;php-cgi.exe;w3wp.exe;httpd;ServerManager.exe;unknown process;sql;wscript;cscript;schtasks;at.exe;reg.exe;C:\Windows\System32\find.exe</Image>
        <SourceIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</SourceIp>
        <DestinationIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</DestinationIp>
      </Rule>
      <!--SECTION: Custom -->
      <Rule name="exclude dest ldap port 88" groupRelation="and">
        <Image condition="image">C:\Windows\System32\lsass.exe</Image>
        <DestinationPort condition="is">88</DestinationPort>
      </Rule>
      <!--Disable Monitoring of Protocols-->
      <DestinationPortName condition="is">epmap</DestinationPortName>
      <DestinationPortName condition="is">llmnr</DestinationPortName>
      <DestinationPortName condition="is">microsoft-ds</DestinationPortName>
      <DestinationPortName condition="is">netbios-dgm</DestinationPortName>
      <DestinationPortName condition="is">ntp</DestinationPortName>
      <DestinationPortName condition="is">ssdp</DestinationPortName>
      <SourcePortName condition="is">epmap</SourcePortName>
      <SourcePortName condition="is">llmnr</SourcePortName>
      <SourcePortName condition="is">microsoft-ds</SourcePortName>
      <SourcePortName condition="is">netbios-dgm</SourcePortName>
      <SourcePortName condition="is">ntp</SourcePortName>
      <SourcePortName condition="is">ssdp</SourcePortName>
      <!--Disable Monitoring on Ports-->
      <DestinationPort name="Service=DNS" condition="is">53</DestinationPort>
      <DestinationPort name="Service=DNS" condition="is">67</DestinationPort>
      <DestinationPort name="Service=Bootp" condition="is">68</DestinationPort>
      <DestinationPort name="Service=SQL Noise" condition="is">1434</DestinationPort>
      <DestinationPort name="Service=Radius" condition="is">1812</DestinationPort>
      <DestinationPort name="Service=Teredo" condition="is">3544</DestinationPort>
      <DestinationPort name="Service=WS-Discovery" condition="is">3702</DestinationPort>
      <DestinationPort name="Service=Google Chrome Safe Search" condition="is">5228</DestinationPort>
      <DestinationPort name="Service=Bonjour/Avahi" condition="is">5353</DestinationPort>
      <DestinationPort name="Service=WSD API" condition="is">5357</DestinationPort>
      <DestinationPort name="Service=Vcenter Secure server for CIM" condition="is">5989</DestinationPort>
      <DestinationPort name="Service=Exchange WMI" condition="is">6007</DestinationPort>
      <DestinationPort name="Service=DFRS/ADFS Replication 1" condition="is">49154</DestinationPort>
      <DestinationPort name="Service=DFRS/ADFS Replication 2" condition="is">49209</DestinationPort>
      <DestinationPort name="Service=DFRS/ADFS Replication 3" condition="is">52176</DestinationPort>
      <DestinationPort name="Service=DFRS/ADFS Replication 4" condition="is">59241</DestinationPort>
      <SourcePort name="Service=DNS" condition="is">53</SourcePort>
      <SourcePort name="Service=Bootp" condition="is">67</SourcePort>
      <SourcePort name="Service=Bootp" condition="is">68</SourcePort>
      <SourcePort name="Service=Radius" condition="is">1812</SourcePort>
      <SourcePort name="Service=WS-Discovery" condition="is">3702</SourcePort>
      <SourcePort name="Service=Exchange WMI" condition="is">6007</SourcePort>
      <SourcePort name="Service=DFRS/ADFS Replication" condition="is">49154</SourcePort>
      <SourcePort name="Service=DFRS/ADFS Replication" condition="is">49209</SourcePort>
      <SourcePort name="Service=DFRS/ADFS Replication" condition="is">50646</SourcePort>
      <SourcePort name="Service=DFRS/ADFS Replication" condition="is">52176</SourcePort>
      <SourcePort name="Service=DFRS/ADFS Replication" condition="is">59241</SourcePort>
      <!--SECTION: Microsoft -->
      <DestinationHostname condition="end with">.bing.com</DestinationHostname>
      <DestinationHostname condition="end with">.cloudapp.net</DestinationHostname>
      <DestinationHostname condition="end with">.lync.com</DestinationHostname>
      <DestinationHostname condition="end with">.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">.outlook.com</DestinationHostname>
      <DestinationHostname condition="end with">.search.msn.com</DestinationHostname>
      <DestinationHostname condition="end with">.wns.windows.com</DestinationHostname>
      <DestinationHostname condition="end with">aps.windows.com</DestinationHostname>
      <DestinationHostname condition="end with">arc.msn.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">arc.msn.com</DestinationHostname>
      <DestinationHostname condition="end with">atson.telemetry.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">au.download.windowsupdate.com</DestinationHostname>
      <DestinationHostname condition="end with">b.akamaiedge.net</DestinationHostname>
      <DestinationHostname condition="end with">bingforbusiness.com</DestinationHostname>
      <DestinationHostname condition="end with">client-office365-tas.msedge.net</DestinationHostname>
      <DestinationHostname condition="end with">config.edge.skype.com</DestinationHostname>
      <DestinationHostname condition="end with">csp.digicert.com</DestinationHostname>
      <DestinationHostname condition="end with">ctldl.windowsupdate.com</DestinationHostname>
      <DestinationHostname condition="end with">cy2.licensing.md.mp.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">cy2.settings.data.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">displaycatalog.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">download.windowsupdate.com</DestinationHostname>
      <DestinationHostname condition="end with">e-msedge.net</DestinationHostname>
      <DestinationHostname condition="end with">e3.delivery.dsp.mp.microsoft.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">emdl.ws.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">ettings-win.data.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">fe2.update.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">fe3.delivery.dsp.mp.microsoft.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">fe3.delivery.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">g.akamaiedge.net</DestinationHostname>
      <DestinationHostname condition="end with">g.live.com</DestinationHostname>
      <DestinationHostname condition="end with">g.msn.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">geo-prod.do.dsp.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">geo-prod.dodsp.mp.microsoft.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">ile-service.weather.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">ip5.afdorigin-prod-am02.afdogw.com</DestinationHostname>
      <DestinationHostname condition="end with">ipv4.login.msa.akadns6.net</DestinationHostname>
      <DestinationHostname condition="end with">licensing.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">m3p.wns.notify.windows.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">modern.watson.data.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">msedge.net</DestinationHostname>
      <DestinationHostname condition="end with">msn.com.nsatc.net</DestinationHostname>
      <DestinationHostname condition="end with">msn.com</DestinationHostname>
      <DestinationHostname condition="end with">ocation-inference-westus.cloudapp.net</DestinationHostname>
      <DestinationHostname condition="end with">ocos-office365-s2s.msedge.net</DestinationHostname>
      <DestinationHostname condition="end with">ocsp.digicert.com</DestinationHostname>
      <DestinationHostname condition="end with">odern.watson.data.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">oneclient.sfx.ms</DestinationHostname>
      <DestinationHostname condition="end with">pv4.login.msa.akadns6.net</DestinationHostname>
      <DestinationHostname condition="end with">query.prod.cms.rt.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">ris.api.iris.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">ris.api.iris.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">s-msedge.net</DestinationHostname>
      <DestinationHostname condition="end with">settings.data.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">sfe.trafficshaping.dsp.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">sls.update.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">storecatalogrevocation.storequality.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">storeedgefd.dsx.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">telecommand.telemetry.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">tile-service.weather.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">tlu.dl.delivery.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">tsfe.trafficshaping.dsp.mp.microsoft.com</DestinationHostname>
      <DestinationHostname condition="end with">vip5.afdorigin-prod-am02.afdogw.com</DestinationHostname>
      <DestinationHostname condition="end with">vip5.afdorigin-prod-ch02.afdogw.com</DestinationHostname>
      <DestinationHostname condition="end with">virtualearth.net</DestinationHostname>
      <DestinationHostname condition="end with">windows.net</DestinationHostname>
      <DestinationHostname condition="end with">windowsupdate.com</DestinationHostname>
      <DestinationHostname condition="end with">y2.displaycatalog.md.mp.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">y2.licensing.md.mp.microsoft.com.akadns.net</DestinationHostname>
      <DestinationHostname condition="end with">y2.settings.data.microsoft.com.akadns.net</DestinationHostname>
      <Image condition="image">EdgeTransport.exe</Image>
      <Image condition="image">MSExchangeDelivery.exe</Image>
      <Image condition="image">MSExchangeFrontendTransport.exe</Image>
      <Image condition="image">MSExchangeHMWorker.exe</Image>
      <Image condition="image">MSExchangeSubmission.exe</Image>
      <Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=UNC Path Network Connections" condition="begin with">\</Image>
      <!--SECTION: Antivirus Exclusions -->
      <Rule name="Antivirus Exclusions" groupRelation="or">
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files (x86)\ESET</Image>
        <Image condition="begin with">C:\Program Files\ESET</Image>
        <Image condition="begin with">C:\Program Files\SentinelOne</Image>
      </Rule>
    </NetworkConnect>
  </RuleGroup>
  <!--SYSMON EVENT ID 4 : RESERVED FOR SYSMON STATUS MESSAGES-->
    <!--DATA: UtcTime, State, Version, SchemaVersion-->
    <!--TECHNICAL: Cannot be filtered.-->

  <!--SYSMON EVENT ID 5 : PROCESS ENDED [ProcessTerminate]-->
    <!--DATA: UtcTime, ProcessGuid, ProcessId, Image-->
    <!--COMMENT: Useful data in building infection timelines.-->
  <RuleGroup name="RG=ProcessTerminate Include Group" groupRelation="or">
    <ProcessTerminate onmatch="include">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Windows Directory" groupRelation="and">
        <Image condition="begin with">C:\Windows\</Image>
        <Image condition="excludes">\System32\;Syswow64;sysmon.exe;sysmon64.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in System32" groupRelation="and">
        <Image condition="begin with">C:\Windows\system32\</Image>
        <Image condition="excludes">config\systemprofile\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination of Sysmon" groupRelation="and">
        <Image condition="contains any">C:\Windows\sysmon.exe;C:\Windows\sysmon64.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Root folders" groupRelation="and">
        <Image condition="contains any">A:\;B:\;C:\;D:\;E:\;F:\;G:\;H:\;I:\;J:\;K:\;L:\;M:\;N:\;O:\;P:\;Q:\;R:\;S:\;T:\;U:\;V:\;W:\;X:\;Y:\;Z:\;AA:\;BB:\;CC:\;DD:\;EE:\;FF:\;GG:\;HH:\;II:\;JJ:\;KK:\;LL:\;MM:\;NN:\;OO:\;PP:\;QQ:\;RR:\;SS:\;TT:\;UU:\;VV:\;WW:\;XX:\;YY;ZZ:\</Image>
        <Image condition="excludes">:\PROGRA~</Image>
        <Image condition="excludes">:\Program Files</Image>
        <Image condition="excludes">:\Program Files</Image>
        <Image condition="excludes">:\Program Files</Image>
        <Image condition="excludes">:\ProgramData\</Image>
        <Image condition="excludes">:\Users\</Image>
        <Image condition="excludes">:\Windows\</Image>
        <Image condition="excludes">:\inetpub\</Image>
        <Image condition="excludes">:\$SysReset</Image>
        <Image condition="excludes">:\$WinREAgent</Image>
        <Image condition="excludes">:\inetpub\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events of UNC File Paths" groupRelation="and">
        <Image condition="begin with">\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Users Directory" groupRelation="and">
        <Image condition="begin with">C:\Users\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in ProgramData Directory" groupRelation="and">
        <Image condition="begin with">C:\ProgramData\</Image>
        <Image condition="excludes any">C:\ProgramData\sysmon\sysmon64.exe;C:\ProgramData\sysmon\sysmon.exe;C:\ProgramData\Cavelo\jre\bin\java.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Program Files Directories" groupRelation="and">
        <Image condition="contains any">C:\Program Files;C:\PROGRA~</Image>
        <Image condition="not begin with">C:\Program Files\SentinelOne\</Image>
        <Image condition="excludes any">C:\Program Files (x86)\N-Able Technologies\AutomationManagerEngine\2.70.0.4\AutomationManager.ScriptRunner64.exe;C:\PROGRA~2\BEANYW~1\GETSUP~1\TCIntegratorCommHelper.exe;C:\Program Files\Cavelo\Cavelo Agent\osqueryi.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\NASafeExec.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in inetpub Directories" groupRelation="and">
        <Image condition="begin with">C:\inetpub\</Image>
      </Rule>
      <Rule name="Attack=T1036,Tactic=Masquerading,Technique=Defense Evasion,DS=Process: Process Termination,Level=4,Alert=Process Termination in Recyclebin,Risk=100" groupRelation="and">
        <Image condition="contains">$RECYCLE.BIN</Image>
      </Rule>
      <Rule name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Process: Process Termination,Level=0,Desc=Process Terminate: Killing of Log Shippers" groupRelation="and">
        <Image condition="contains any">packetbeat.exe;metricbeat.exe;filebeat.exe;winlogbeat.exe;o365beat.exe;graylog-sidecar.exe;graylog-collector-sidecar.exe;splunkd.exe;splunk.exe;syslogng.exe;syslog-ng.exe;nxlog-processor.exe;snarecore.exe;fluentd;td-agent;lpagent.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination in System Profile" groupRelation="and">
        <Image condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination in System Profile" groupRelation="and">
        <Image condition="begin with">C:\Windows\sysWOW64\config\systemprofile\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination in Temp Folder" groupRelation="and">
        <Image condition="contains">\Temp\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=User Process Terminations" groupRelation="and">
        <Image condition="contains">C:\Users\</Image>
      </Rule>
    </ProcessTerminate>
  </RuleGroup>
  <RuleGroup name="RG=ProcessTerminate Exclude Group" groupRelation="or">
      <ProcessTerminate onmatch="exclude">
      <Image condition="end with">Microsoft\Teams\current\Teams.exe</Image>
      <Image condition="end with">\git.exe</Image>
      <Image condition="end with">Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe</Image>
      <Image condition="begin with">C:\ProgramData\Lenovo\ImController\</Image>
    </ProcessTerminate>
  </RuleGroup>
  <!--SYSMON EVENT ID 6 : DRIVER LOADED INTO KERNEL [DriverLoad]-->
    <!--DATA: RuleName, UtcTime, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->
    <!--TECHNICAL: Sysmon will check the signing certificate revocation status of any driver you don't exclude.-->
  <RuleGroup name="RG=DriverLoad Include Group" groupRelation="or">
    <DriverLoad onmatch="include">
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Driver: Driver Load,Level=4,Alert=Solarwinds/FireEye sunburst driver hashes,Risk=100" groupRelation="and">
        <Hashes condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hashes><!-- exclude non executable files -->
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Driver: Driver Load,Level=4,Alert=Vulnerable Dell Drivers Detected,Risk=100" groupRelation="and">
        <Hashes condition="contains any">0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5;c948ae14761095e4d76b55d9de86412258be7afd;c996d7971c49252c582171d9380360f2;ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1;10b30bdee43b3a2ec4aa63375577ade650269d25;d2fd132ab7bbc6bbb87a84f026fa0244</Hashes><!-- exclude non executable files -->
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=DumpExt.dll driver loaded,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">DumpExt.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=Mimikatz driver loaded,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">mimidrv</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=PWDump6 driver loaded,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">lsremora</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=wceaux.dll driver loaded,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">wceaux.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1040,Tactic=Discovery,Technique=Network Sniffing,DS=Driver: Driver Load,Level=4,Alert=NPCap packet capture driver loaded,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">npcap</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Driver Loaded in Temp" groupRelation="and">
        <ImageLoaded condition="contains">\Temp</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Driver Loaded in Users Directories" groupRelation="and">
        <ImageLoaded condition="contains">:\Users</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1019,Technique=System Firmware,Tactic=Persistence,DS=Driver: Driver Load,Level=4,Alert=UEFI Rootkit detection,Risk=100" groupRelation="and">
        <Signature condition="contains">ChongKim Chan</Signature>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Unknown Signature Driver Loaded" groupRelation="and">
        <SignatureStatus condition="contains">?</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Revoked Signature Driver Loaded" groupRelation="and">
        <SignatureStatus condition="contains">Revoked</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Unavailable Signature Driver Loaded" groupRelation="and">
        <SignatureStatus condition="contains">Unavailable</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Valid Signature Driver Loaded" groupRelation="and">
        <SignatureStatus condition="contains">Valid</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Unsigned Driver Loaded" groupRelation="and">
        <Signed condition="contains">false</Signed>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Driver: Driver Load,Level=4,Alert=Vulnerable Driver Loaded,Risk=100,Author=Nasreddine Bencherchali,Risk=75" groupRelation="or">
        <!--# List below is from https://github.com/namazso/physmem_drivers and the SHA1 are from VT-->
        <Hashes condition="contains">SHA1=2261198385d62d2117f50f631652eded0ecc71db</Hashes>
        <Hashes condition="contains">SHA1=8db869c0674221a2d3280143cbb0807fac08e0cc</Hashes>
        <Hashes condition="contains">SHA1=27d3ebea7655a72e6e8b95053753a25db944ec0f</Hashes>
        <Hashes condition="contains">SHA1=33cdab3bbc8b3adce4067a1b042778607dce2acd</Hashes>
        <Hashes condition="contains">SHA1=21e6c104fe9731c874fab5c9560c929b2857b918</Hashes>
        <Hashes condition="contains">SHA1=d979353d04bf65cc92ad3412605bc81edbb75ec2</Hashes>
        <Hashes condition="contains">SHA1=2f991435a6f58e25c103a657d24ed892b99690b8</Hashes>
        <Hashes condition="contains">SHA1=f02af84393e9627ba808d4159841854a6601cf80</Hashes>
        <Hashes condition="contains">SHA1=bb962c9a8dda93e94fef504c4159de881e4706fe</Hashes>
        <Hashes condition="contains">SHA1=b97a8d506be2e7eaa4385f70c009b22adbd071ba</Hashes>
        <Hashes condition="contains">SHA1=92f251358b3fe86fd5e7aa9b17330afa0d64a705</Hashes>
        <Hashes condition="contains">SHA1=8b6aa5b2bff44766ef7afbe095966a71bc4183fa</Hashes>
        <Hashes condition="contains">SHA1=af6e1f2cfb230907476e8b2d676129b6d6657124</Hashes>
        <Hashes condition="contains">SHA1=fcde5275ee1913509927ce5f0f85e6681064c9d2</Hashes>
        <Hashes condition="contains">SHA1=00a442a4305c62cefa8105c0b4c4a9a5f4d1e93b</Hashes>
        <Hashes condition="contains">SHA1=6523b3fd87de39eb5db1332e4523ce99556077dc</Hashes>
        <Hashes condition="contains">SHA1=72966ca845759d239d09da0de7eebe3abe86fee3</Hashes>
        <Hashes condition="contains">SHA1=57511ef5ff8162a9d793071b5bf7ebe8371759de</Hashes>
        <Hashes condition="contains">SHA1=2d503a2457a787014a1fdd48a2ece2e6cbe98ea7</Hashes>
        <Hashes condition="contains">SHA1=400f833dcc2ef0a122dd0e0b1ec4ec929340d90e</Hashes>
        <Hashes condition="contains">SHA1=89cd760e8cb19d29ee08c430fb17a5fd4455c741</Hashes>
        <Hashes condition="contains">SHA1=1d0df45ee3fa758f0470e055915004e6eae54c95</Hashes>
        <Hashes condition="contains">SHA1=d5fd9fe10405c4f90235e583526164cd0902ed86</Hashes>
        <Hashes condition="contains">SHA1=c52cef5b9e1d4a78431b7af56a6fdb6aa1bcad65</Hashes>
        <Hashes condition="contains">SHA1=609fa1efcf61e26d64a5ceb13b044175ab2b3a13</Hashes>
        <Hashes condition="contains">SHA1=7d7c03e22049a725ace2a9812c72b53a66c2548b</Hashes>
        <Hashes condition="contains">SHA1=f9519d033d75e1ab6b82b2e156eafe9607edbcfb</Hashes>
        <Hashes condition="contains">SHA1=468e2e5505a3d924b14fedee4ddf240d09393776</Hashes>
        <Hashes condition="contains">SHA1=2e3de9bff43d7712707ef8a0b10f7e4ad8427fd8</Hashes>
        <Hashes condition="contains">SHA1=c9cbfdd0be7b35751a017ec59ff7237ffdc4df1f</Hashes>
        <Hashes condition="contains">SHA1=078ae07dec258db4376d5a2a05b9b508d68c0123</Hashes>
        <Hashes condition="contains">SHA1=623cd2abef6c92255f79cbbd3309cb59176771da</Hashes>
        <Hashes condition="contains">SHA1=1f3a9265963b660392c4053329eb9436deeed339</Hashes>
        <Hashes condition="contains">SHA1=4a235f0b84ff615e2879fa9e0ec0d745fcfdaa5c</Hashes>
        <Hashes condition="contains">SHA1=ace6b9e34e3e2e73fe584f3bbdb4e4ec106e0a7d</Hashes>
        <Hashes condition="contains">SHA1=4268f30b79ce125a81d0d588bef0d4e2ad409bbb</Hashes>
        <Hashes condition="contains">SHA1=c834c4931b074665d56ccab437dfcc326649d612</Hashes>
        <Hashes condition="contains">SHA1=8f5cd4a56e6e15935491aa40adb1ecad61eafe7c</Hashes>
        <Hashes condition="contains">SHA1=51b60eaa228458dee605430aae1bc26f3fc62325</Hashes>
        <Hashes condition="contains">SHA1=3270720a066492b046d7180ca6e60602c764cac7</Hashes>
        <Hashes condition="contains">SHA1=2a6e6bd51c7062ad24c02a4d2c1b5e948908d131</Hashes>
        <Hashes condition="contains">SHA1=19bd488fe54b011f387e8c5d202a70019a204adf</Hashes>
        <Hashes condition="contains">SHA1=a6fe4f30ca7cb94d74bc6d42cdd09a136056952e</Hashes>
        <Hashes condition="contains">SHA1=ea877092d57373cb466b44e7dbcad4ce9a547344</Hashes>
        <Hashes condition="contains">SHA1=205c69f078a563f54f4c0da2d02a25e284370251</Hashes>
        <Hashes condition="contains">SHA1=f9feb60b23ca69072ce42264cd821fe588a186a6</Hashes>
        <Hashes condition="contains">SHA1=b25170e09c9fb7c0599bfba3cf617187f6a733ac</Hashes>
        <Hashes condition="contains">SHA1=160c96b5e5db8c96b821895582b501e3c2d5d6e7</Hashes>
        <Hashes condition="contains">SHA1=a2e0b3162cfa336cd4ab40a2acc95abe7dc53843</Hashes>
        <Hashes condition="contains">SHA1=4e826430a1389032f3fe06e2cc292f643fb0c417</Hashes>
        <Hashes condition="contains">SHA1=7ab4565ba24268f0adadb03a5506d4eb1dc7c181</Hashes>
        <Hashes condition="contains">SHA1=dc7b022f8bd149efbcb2204a48dce75c72633526</Hashes>
        <Hashes condition="contains">SHA1=0307d76750dd98d707c699aee3b626643afb6936</Hashes>
        <Hashes condition="contains">SHA1=5711c88e9e64e45b8fc4b90ab6f2dd6437dc5a8a</Hashes>
        <Hashes condition="contains">SHA1=6714380bc0b8ab09b9a0d2fa66d1b025b646b946</Hashes>
        <Hashes condition="contains">SHA1=8626ab1da6bfbdf61bd327eb944b39fd9df33d1d</Hashes>
        <Hashes condition="contains">SHA1=30a224b22592d952fbe2e6ad97eda4a8f2c734e0</Hashes>
        <Hashes condition="contains">SHA1=c95db1e82619fb16f8eec9a8209b7b0e853a4ebe</Hashes>
        <Hashes condition="contains">SHA1=fe1d909ab38de1389a2a48352fd1c8415fd2eab0</Hashes>
        <Hashes condition="contains">SHA1=b4d1554ec19504215d27de0758e13c35ddd6db3e</Hashes>
        <Hashes condition="contains">SHA1=5dd2c31c4357a8b76db095364952b3d0e3935e1d</Hashes>
        <Hashes condition="contains">SHA1=ecb4d096a9c58643b02f328d2c7742a38e017cf0</Hashes>
        <Hashes condition="contains">SHA1=4a705af959af61bad48ef7579f839cb5ebd654d2</Hashes>
        <Hashes condition="contains">SHA1=d2e6fc9259420f0c9b6b1769be3b1f63eb36dc57</Hashes>
        <Hashes condition="contains">SHA1=c948ae14761095e4d76b55d9de86412258be7afd</Hashes>
        <Hashes condition="contains">SHA1=ddbe809b731a0962e404a045ab9e65a0b64917ad</Hashes>
        <Hashes condition="contains">SHA1=745bad097052134548fe159f158c04be5616afc2</Hashes>
        <Hashes condition="contains">SHA1=8d59fd14a445c8f3f0f7991fa6cd717d466b3754</Hashes>
        <Hashes condition="contains">SHA1=2dfcb799b3c42ecb0472e27c19b24ac7532775ce</Hashes>
        <Hashes condition="contains">SHA1=cc51be79ae56bc97211f6b73cc905c3492da8f9d</Hashes>
        <Hashes condition="contains">SHA1=ac13941f436139b909d105ad55637e1308f49d9a</Hashes>
        <Hashes condition="contains">SHA1=2b0bb408ff0e66bcdf6574f1ca52cbf4015b257b</Hashes>
        <Hashes condition="contains">SHA1=cc0e0440adc058615e31e8a52372abadf658e6b1</Hashes>
        <Hashes condition="contains">SHA1=5520ac25d81550a255dc16a0bb89d4b275f6f809</Hashes>
        <Hashes condition="contains">SHA1=6afc6b04cf73dd461e4a4956365f25c1f1162387</Hashes>
        <Hashes condition="contains">SHA1=4b009e91bae8d27b160dc195f10c095f8a2441e1</Hashes>
        <Hashes condition="contains">SHA1=6003184788cd3d2fc624ca801df291ccc4e225ee</Hashes>
        <Hashes condition="contains">SHA1=0466e90bf0e83b776ca8716e01d35a8a2e5f96d3</Hashes>
        <Hashes condition="contains">SHA1=e6305dddd06490d7f87e3b06d09e9d4c1c643af0</Hashes>
        <Hashes condition="contains">SHA1=89909fa481ff67d7449ee90d24c167b17b0612f1</Hashes>
        <Hashes condition="contains">SHA1=d7e8aef8c8feb87ce722c0b9abf34a7e6bab6eb4</Hashes>
        <Hashes condition="contains">SHA1=5e6ddd2b39a3de0016385cbd7aa50e49451e376d</Hashes>
        <Hashes condition="contains">SHA1=976777d39d73034df6b113dfce1aa6e1d00ffcfd</Hashes>
        <Hashes condition="contains">SHA1=9c6749fc6c1127f8788bff70e0ce9062959637c9</Hashes>
        <Hashes condition="contains">SHA1=53acd4d9e7ba0b1056cf52af0d191f226eddf312</Hashes>
        <Hashes condition="contains">SHA1=3abb9d0a9d600200ae19c706e570465ef0a15643</Hashes>
        <Hashes condition="contains">SHA1=27eab595ec403580236e04101172247c4f5d5426</Hashes>
        <Hashes condition="contains">SHA1=78b9481607ca6f3a80b4515c432ddfe6550b18a8</Hashes>
        <Hashes condition="contains">SHA1=414cd15d6c991d19fb5be02e3b9fb0e6c5ce731c</Hashes>
        <Hashes condition="contains">SHA1=d9c09dd725bc7bc3c19b4db37866015817a516ef</Hashes>
        <Hashes condition="contains">SHA1=9c256edd10823ca76c0443a330e523027b70522d</Hashes>
        <Hashes condition="contains">SHA1=35829e096a15e559fcbabf3441d99e580ca3b26e</Hashes>
        <Hashes condition="contains">SHA1=b8de3a1aeeda9deea43e3f768071125851c85bd0</Hashes>
        <Hashes condition="contains">SHA1=054a50293c7b4eea064c91ef59cf120d8100f237</Hashes>
        <Hashes condition="contains">SHA1=d94f2fb3198e14bfe69b44fb9f00f2551f7248b2</Hashes>
        <Hashes condition="contains">SHA1=01a578a3a39697c4de8e3dab04dba55a4c35163e</Hashes>
        <Hashes condition="contains">SHA1=14bf0eaa90e012169745b3e30c281a327751e316</Hashes>
        <Hashes condition="contains">SHA1=f50c6b84dfb8f2d53ba3bce000a55f0a486c0e79</Hashes>
        <Hashes condition="contains">SHA1=6100eb82a25d64a7a7702e94c2b21333bc15bd08</Hashes>
        <Hashes condition="contains">SHA1=bf87e32a651bdfd9b9244a8cf24fca0e459eb614</Hashes>
        <Hashes condition="contains">SHA1=28b1c0b91eb6afd2d26b239c9f93beb053867a1a</Hashes>
        <Hashes condition="contains">SHA1=879fcc6795cebe67718388228e715c470de87dca</Hashes>
        <Hashes condition="contains">SHA1=1f7501e01d84a2297c85cb39880ec4e40ac3fe8a</Hashes>
        <Hashes condition="contains">SHA1=152b6bb9ffd2ffec00cc46f5c6e29362d0e66e67</Hashes>
        <Hashes condition="contains">SHA1=5f8356ffa8201f338dd2ea979eb47881a6db9f03</Hashes>
        <Hashes condition="contains">SHA1=a7bd05de737f8ea57857f1e0845a25677df01872</Hashes>
        <Hashes condition="contains">SHA1=cce9b82f01ec68f450f5fe4312f40d929c6a506e</Hashes>
        <Hashes condition="contains">SHA1=e35a2b009d54e1a0b231d8a276251f64231b66a3</Hashes>
        <Hashes condition="contains">SHA1=37364cb5f5cefd68e5eca56f95c0ab4aff43afcc</Hashes>
        <Hashes condition="contains">SHA1=d62fa51e520022483bdc5847141658de689c0c29</Hashes>
        <Hashes condition="contains">SHA1=93aa3bb934b74160446df3a47fa085fd7f3a6be9</Hashes>
        <Hashes condition="contains">SHA1=ec4cc6de4c779bb1ca1dd32ee3a03f7e8d633a9b</Hashes>
        <Hashes condition="contains">SHA1=35f1ba60ba0da8512a0b1b15ee8e30fe240d77cd</Hashes>
        <Hashes condition="contains">SHA1=3805e4e08ad342d224973ecdade8b00c40ed31be</Hashes>
        <Hashes condition="contains">SHA1=65d8a7c2e867b22d1c14592b020c548dd0665646</Hashes>
        <Hashes condition="contains">SHA1=c8d87f3cd34c572870e63a696cf771580e6ea81b</Hashes>
        <Hashes condition="contains">SHA1=c4d7fb9db3c3459f7e8c0e3d48c95c7c9c4cff60</Hashes>
        <Hashes condition="contains">SHA1=d34a7c497c603f3f7fcad546dc4097c2da17c430</Hashes>
        <Hashes condition="contains">SHA1=1fd7f881ea4a1dbb5c9aeb9e7ad659a85421745b</Hashes>
        <Hashes condition="contains">SHA1=0b8b83f245d94107cb802a285e6529161d9a834d</Hashes>
        <Hashes condition="contains">SHA1=c969f1f73922fd95db1992a5b552fbc488366a40</Hashes>
        <Hashes condition="contains">SHA1=ac600a2bc06b312d92e649b7b55e3e91e9d63451</Hashes>
        <Hashes condition="contains">SHA1=da9cea92f996f938f699902482ac5313d5e8b28e</Hashes>
        <Hashes condition="contains">SHA1=33285b2e97a0aeb317166cce91f6733cf9c1ad53</Hashes>
        <Hashes condition="contains">SHA1=21edff2937eb5cd6f6b0acb7ee5247681f624260</Hashes>
        <Hashes condition="contains">SHA1=f052dc35b74a1a6246842fbb35eb481577537826</Hashes>
        <Hashes condition="contains">SHA1=f0c463d29a5914b01e4607889094f1b7d95e7aaf</Hashes>
        <Hashes condition="contains">SHA1=0c26ab1299adcd9a385b541ef1653728270aa23e</Hashes>
        <Hashes condition="contains">SHA1=f36a47edfacd85e0c6d4d22133dd386aee4eec15</Hashes>
        <Hashes condition="contains">SHA1=460008b1ffd31792a6deadfa6280fb2a30c8a5d2</Hashes>
        <Hashes condition="contains">SHA1=738b7918d85e5cb4395df9e3f6fc94ddad90e939</Hashes>
        <Hashes condition="contains">SHA1=43419df1f9a07430a18c5f3b3cc74de621be0f8e</Hashes>
        <Hashes condition="contains">SHA1=558aad879b6a47d94a968f39d0a4e3a3aaef1ef1</Hashes>
        <Hashes condition="contains">SHA1=7fb52290883a6b69a96d480f2867643396727e83</Hashes>
        <!--# The list below is from https://github.com/jbaines-r7/dellicious and https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/ -->
        <Hashes condition="contains">SHA1=f5696fb352a3fbd14fb1a89ad21a71776027f9ab</Hashes>
        <Hashes condition="contains">SHA1=693a2645c28fc3b248fda95179c36c3ac64f6fc2</Hashes>
        <Hashes condition="contains">SHA1=05c0c49e8bcf11b883d41441ce87a2ee7a3aba1d</Hashes>
        <Hashes condition="contains">SHA1=d25340ae8e92a6d29f599fef426a2bc1b5217299</Hashes>
        <Hashes condition="contains">SHA1=7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c</Hashes>
        <Hashes condition="contains">SHA1=fe10018af723986db50701c8532df5ed98b17c39</Hashes>
        <Hashes condition="contains">SHA1=bfe55cacc7c56c9f7bd75bdb4b352c0b745d071b</Hashes>
        <Hashes condition="contains">SHA1=a21c84c6bf2e21d69fa06daaf19b4cc34b589347</Hashes>
        <Hashes condition="contains">SHA1=82ba5513c33e056c3f54152c8555abf555f3e745</Hashes>
        <Hashes condition="contains">SHA1=d098600152e5ee6a8238d414d2a77a34da8afaaa</Hashes>
        <Hashes condition="contains">SHA1=64e4ac8b9ea2f050933b7ec76a55dd04e97773b4</Hashes>
        <Hashes condition="contains">SHA1=bbc1e5fd826961d93b76abd161314cb3592c4436</Hashes>
        <Hashes condition="contains">SHA1=90a76945fd2fa45fab2b7bcfdaf6563595f94891</Hashes>
        <Hashes condition="contains">SHA1=b03b1996a40bfea72e4584b82f6b845c503a9748</Hashes>
        <Hashes condition="contains">SHA1=c771ea59f075170e952c393cfd6fc784b265027c</Hashes>
        <Hashes condition="contains">SHA1=cb44c6f0ee51cb4c5836499bc61dd6c1fbdf8aa1</Hashes>
        <Hashes condition="contains">SHA1=0918277fcdc64a9dc51c04324377b3468fa1269b</Hashes>
        <Hashes condition="contains">SHA1=b09bcc042d60d2f4c0d08284818ed198cededa04</Hashes>
        <!--# The list below is from https://gist.github.com/k4nfr3/af970e7facb09195e56f2112e1c9549c -->
        <Hashes condition="contains">SHA1=8dc2097a90eb7e9d6ee31a7c7a95e7a0b2093b89</Hashes>
        <Hashes condition="contains">SHA1=15df139494d2c40a645fb010908551185c27f3c5</Hashes>
        <Hashes condition="contains">SHA1=012db3a80faf1f7f727b538cbe5d94064e7159de</Hashes>
        <Hashes condition="contains">SHA1=d04e5db5b6c848a29732bfd52029001f23c3da75</Hashes>
        <Hashes condition="contains">SHA1=490109fa6739f114651f4199196c5121d1c6bdf2</Hashes>
        <Hashes condition="contains">SHA1=b4d014b5edd6e19ce0e8395a64faedf49688ecb5</Hashes>
        <Hashes condition="contains">SHA1=a87d6eac2d70a3fbc04e59412326b28001c179de</Hashes>
        <Hashes condition="contains">SHA1=3f223581409492172a1e875f130f3485b90fbe5f</Hashes>
        <Hashes condition="contains">SHA1=5db61d00a001fd493591dc919f69b14713889fc5</Hashes>
        <!--# https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md -->
        <Hashes condition="contains">SHA1=9923c8f1e565a05b3c738d283cf5c0ed61a0b90f</Hashes>
        <Hashes condition="contains">SHA1=15d1a6a904c8409fb47a82aefa42f8c3c7d8c370</Hashes>
        <Hashes condition="contains">SHA1=9d07df024ec457168bf0be7e0009619f6ac4f13c</Hashes>
        <Hashes condition="contains">SHA1=9a35ae9a1f95ce4be64adc604c80079173e4a676</Hashes>
        <Hashes condition="contains">SHA1=c6bd965300f07012d1b651a9b8776028c45b149a</Hashes>
        <Hashes condition="contains">SHA1=e83458c4a6383223759cd8024e60c17be4e7c85f</Hashes>
        <Hashes condition="contains">SHA1=cb3de54667548a5c9abf5d8fa47db4097fcee9f1</Hashes>
        <Hashes condition="contains">SHA1=9c24dd75e4074041dbe03bf21f050c77d748b8e9</Hashes>
        <Hashes condition="contains">SHA1=dc55217b6043d819eadebd423ff07704ee103231</Hashes>
        <Hashes condition="contains">SHA1=e92817a8744ebc4e4fa5383cdce2b2977f01ecd4</Hashes>
        <Hashes condition="contains">SHA1=dc0e97adb756c0f30b41840a59b85218cbdd198f</Hashes>
        <Hashes condition="contains">SHA1=26c4a7b392d7e7bd7f0a2a758534e45c0d9a56ab</Hashes>
        <Hashes condition="contains">SHA1=d0d39e1061f30946141b6ecfa0957f8cc3ddeb63</Hashes>
        <Hashes condition="contains">SHA1=c6d349823bbb1f5b44bae91357895dba653c5861</Hashes>
        <Hashes condition="contains">SHA1=f42f28d164205d9f6dab9317c9fecad54c38d5d2</Hashes>
        <Hashes condition="contains">SHA1=bbc0b9fd67c8f4cefa3d76fcb29ff3cef996b825</Hashes>
        <Hashes condition="contains">SHA1=8183a341ba6c3ce1948bf9be49ab5320e0ee324d</Hashes>
        <Hashes condition="contains">SHA1=eb1ecad3d37bb980f908bf1a912415cff32e79e6</Hashes>
        <Hashes condition="contains">SHA1=eb0d45aa6f537f5b2f90f3ad99013606eafcd162</Hashes>
        <Hashes condition="contains">SHA1=6053d258096bccb07cb0057d700fe05233ab1fbb</Hashes>
        <Hashes condition="contains">SHA1=29a190727140f40cea9514a6420f5a195e36386b</Hashes>
        <Hashes condition="contains">SHA1=a4b2c56c12799855162ca3b004b4b2078c6ecf77</Hashes>
        <Hashes condition="contains">SHA1=7667b72471689151e176baeba4e1cd9cd006a09a</Hashes>
        <Hashes condition="contains">SHA1=d7f7594ff084201c0d9fa2f4ef1626635b67bce5</Hashes>
        <Hashes condition="contains">SHA1=99201c9555e5faf6e8d82da793b148311f8aa4b8</Hashes>
        <Hashes condition="contains">SHA1=947db58d6f36a8df9fa2a1057f3a7f653ccbc42e</Hashes>
        <Hashes condition="contains">SHA1=6a3d3b9ab3d201cd6b0316a7f9c3fb4d34d0f403</Hashes>
        <Hashes condition="contains">SHA1=d702d88b12233be9413446c445f22fda4a92a1d9</Hashes>
        <Hashes condition="contains">SHA1=910cb12aa49e9f35ecc4907e8304adf0dcca8cf1</Hashes>
        <Hashes condition="contains">SHA1=643383938d5e0d4fd30d302af3e9293a4798e392</Hashes>
        <Hashes condition="contains">SHA1=c4ed28fdfba7b8a8dfe39e591006f25d39990f07</Hashes>
        <!--# The list below is derived from the ELASTIC yara rules https://github.com/elastic/protections-artifacts/search?q=VulnDriver -->
        <!--# These are the hashes mentioned in the "reference_sample" section that ELASTIC used to create their rules -->
        <Hashes condition="contains">SHA1=b0032b8d8e6f4bd19a31619ce38d8e010f29a816</Hashes>
        <Hashes condition="contains">SHA1=db6245578ec57bd767b27ecf8085095e1c8e5a6e</Hashes>
        <Hashes condition="contains">SHA1=166759fd511613414d3213942fe2575b926a6226</Hashes>
        <Hashes condition="contains">SHA1=02a8b74899591da7b7f49c0450328d39b939d7e4</Hashes>
        <Hashes condition="contains">SHA1=98ceed786f79288becc08c3b82c57e8d4bfa1bca</Hashes>
        <Hashes condition="contains">SHA1=f6b3577ea4b1a5641ae3421151a26268434c3db8</Hashes>
        <Hashes condition="contains">SHA1=4de33d03fee52f396a1c788000ca868d56ac30de</Hashes>
        <Hashes condition="contains">SHA1=c6920171fa6dff2c17eb83befb5fd28e8dddf5f0</Hashes>
        <Hashes condition="contains">SHA1=fbc6d2448739ddec35bb5d6c94b46df4148f648d</Hashes>
        <Hashes condition="contains">SHA1=6b54f8f137778c1391285fee6150dfa58a8120b1</Hashes>
        <Hashes condition="contains">SHA1=943593e880b4d340f2548548e6e673ef6f61eed3</Hashes>
        <Hashes condition="contains">SHA1=5ac4d0e2381fc4a8aebe94a0fb6fe5e7558e4dcd</Hashes>
        <Hashes condition="contains">SHA1=e44297a2b750ec1958bef265e2f1ae6fa4323b28</Hashes>
        <Hashes condition="contains">SHA1=aa2ea973bb248b18973e57339307cfb8d309f687</Hashes>
        <Hashes condition="contains">SHA1=3a5d176c50f97b71d139767ed795d178623f491d</Hashes>
        <Hashes condition="contains">SHA1=25d812a5ece19ea375178ef9d60415841087726e</Hashes>
        <Hashes condition="contains">SHA1=3795e32592ab6d8074b6f7ad33759c6a39b0df07</Hashes>
        <Hashes condition="contains">SHA1=fc121ed6fb37e97a004b6faf217435b772dfc4c0</Hashes>
        <Hashes condition="contains">SHA1=ab2b8602e4baef828b58b995d0889a8e5b8dbd02</Hashes>
        <Hashes condition="contains">SHA1=cf040040628b58f4a811f98c2690913c1e8e4e3c</Hashes>
        <Hashes condition="contains">SHA1=3296844d22c87dd5eba3aa378a8242b41d59db7a</Hashes>
        <Hashes condition="contains">SHA1=bc47e15537fa7c32dfefd23168d7e1741f8477ed</Hashes>
        <Hashes condition="contains">SHA1=cb22723faa5ae2809476e5c5e9b9a597b26cab9b</Hashes>
        <Hashes condition="contains">SHA1=f3c5e723ae009b336cd2719137b8cd194c9ee51d</Hashes>
        <Hashes condition="contains">SHA1=41f2d0f9863bce8920c207b1ef5d3d32b603edef</Hashes>
        <Hashes condition="contains">SHA1=eb93d2f564fea9b3dc350f386b45de2cd9a3e001</Hashes>
        <Hashes condition="contains">SHA1=3cd037fbba8aae82c1b111c9f8755349c98bcb3c</Hashes>
        <Hashes condition="contains">SHA1=9401389fba314d1810f83edce33c37e84a78e112</Hashes>
        <Hashes condition="contains">SHA1=7eb34cc1fcffb4fdb5cb7e97184dd64a65cb9371</Hashes>
        <Hashes condition="contains">SHA1=16d7ecf09fc98798a6170e4cef2745e0bee3f5c7</Hashes>
        <Hashes condition="contains">SHA1=fcd615df88645d1f57ff5702bd6758b77efea6d0</Hashes>
        <Hashes condition="contains">SHA1=f3db629cfe37a73144d5258e64d9dd8b38084cf4</Hashes>
        <Hashes condition="contains">SHA1=a00e444120449e35641d58e62ed64bb9c9f518d2</Hashes>
        <Hashes condition="contains">SHA1=38571f14fc014487194d1eecfa80561ee8644e09</Hashes>
        <Hashes condition="contains">SHA1=4d41248078181c7f61e6e4906aa96bbdea320dc2</Hashes>
        <Hashes condition="contains">SHA1=3599ea2ac1fa78f423423a4cf90106ea0938dde8</Hashes>
        <Hashes condition="contains">SHA1=3d6d53b0f1cc908b898610227b9f1b9352137aba</Hashes>
        <Hashes condition="contains">SHA1=4c18754dca481f107f0923fb8ef5e149d128525d</Hashes>
        <Hashes condition="contains">SHA1=8c377ab4eebc5f4d8dd7bb3f90c0187dfdd3349f</Hashes>
        <Hashes condition="contains">SHA1=cde32654a041fedc7b0fa1083f6005b950760062</Hashes>
        <Hashes condition="contains">SHA1=5fb9421be8a8b08ec395d05e00fd45eb753b593a</Hashes>
        <Hashes condition="contains">SHA1=b480c54391a2a2f917a44f91a5e9e4590648b332</Hashes>
        <Hashes condition="contains">SHA1=4f7a8e26a97980544be634b26899afbefb0a833c</Hashes>
        <!--# The list below is from https://github.com/namazso/physmem_drivers -->
        <Hashes condition="contains">SHA256=05F052C64D192CF69A462A5EC16DDA0D43CA5D0245900C9FCB9201685A2E7748</Hashes>
        <Hashes condition="contains">SHA256=4045AE77859B1DBF13972451972EAAF6F3C97BEA423E9E78F1C2F14330CD47CA</Hashes>
        <Hashes condition="contains">SHA256=6948480954137987A0BE626C24CF594390960242CD75F094CD6AAA5C2E7A54FA</Hashes>
        <Hashes condition="contains">SHA256=8CB62C5D41148DE416014F80BD1FD033FD4D2BD504CB05B90EEB6992A382D58F</Hashes>
        <Hashes condition="contains">SHA256=B1D96233235A62DBB21B8DBE2D1AE333199669F67664B107BFF1AD49B41D9414</Hashes>
        <Hashes condition="contains">SHA256=7196187FB1EF8D108B380D37B2AF8EFDEB3CA1F6EEFD37B5DC114C609147216D</Hashes>
        <Hashes condition="contains">SHA256=7F375639A0DF7FE51E5518CF87C3F513C55BC117DB47D28DA8C615642EB18BFA</Hashes>
        <Hashes condition="contains">SHA256=42579A759F3F95F20A2C51D5AC2047A2662A2675B3FB9F46C1ED7F23393A0F00</Hashes>
        <Hashes condition="contains">SHA256=2DA330A2088409EFC351118445A824F11EDBE51CF3D653B298053785097FE40E</Hashes>
        <Hashes condition="contains">SHA256=436CCAB6F62FA2D29827916E054ADE7ACAE485B3DE1D3E5C6C62D3DEBF1480E7</Hashes>
        <Hashes condition="contains">SHA256=B4D47EA790920A4531E3DF5A4B4B0721B7FEA6B49A35679F0652F1E590422602</Hashes>
        <Hashes condition="contains">SHA256=DDE6F28B3F7F2ABBEE59D4864435108791631E9CB4CDFB1F178E5AA9859956D8</Hashes>
        <Hashes condition="contains">SHA256=B48A309EE0960DA3CAAAAF1E794E8C409993AEB3A2B64809F36B97AAC8A1E62A</Hashes>
        <Hashes condition="contains">SHA256=025E7BE9FCEFD6A83F4471BBA0C11F1C11BD5047047D26626DA24EE9A419CDC4</Hashes>
        <Hashes condition="contains">SHA256=2AA1B08F47FBB1E2BD2E4A492F5D616968E703E1359A921F62B38B8E4662F0C4</Hashes>
        <Hashes condition="contains">SHA256=ECE0A900EA089E730741499614C0917432246CEB5E11599EE3A1BB679E24FD2C</Hashes>
        <Hashes condition="contains">SHA256=F40435488389B4FB3B945CA21A8325A51E1B5F80F045AB019748D0EC66056A8B</Hashes>
        <Hashes condition="contains">SHA256=2A652DE6B680D5AD92376AD323021850DAB2C653ABF06EDF26120F7714B8E08A</Hashes>
        <Hashes condition="contains">SHA256=950A4C0C772021CEE26011A92194F0E58D61588F77F2873AA0599DFF52A160C9</Hashes>
        <Hashes condition="contains">SHA256=0AAFA9F47ACF69D46C9542985994FF5321F00842A28DF2396D4A3076776A83CB</Hashes>
        <Hashes condition="contains">SHA256=47F08F7D30D824A8F4BB8A98916401A37C0FD8502DB308ABA91FE3112B892DCC</Hashes>
        <Hashes condition="contains">SHA256=B9A4E40A5D80FEDD1037EAED958F9F9EFED41EB01ADA73D51B5DCD86E27E0CBF</Hashes>
        <Hashes condition="contains">SHA256=5C04C274A708C9A7D993E33BE3EA9E6119DC29527A767410DBAF93996F87369A</Hashes>
        <Hashes condition="contains">SHA256=0040153302B88BEE27EB4F1ECA6855039E1A057370F5E8C615724FA5215BADA3</Hashes>
        <Hashes condition="contains">SHA256=3326E2D32BBABD69FEB6024809AFC56C7E39241EBE70A53728C77E80995422A5</Hashes>
        <Hashes condition="contains">SHA256=36B9E31240AB0341873C7092B63E2E0F2CAB2962EBF9B25271C3A1216B7669EB</Hashes>
        <Hashes condition="contains">SHA256=29E0062A017A93B2F2F5207A608A96DF4D554C5DE976BD0276C2590A03BD3E94</Hashes>
        <Hashes condition="contains">SHA256=45ABDBCD4C0916B7D9FAAF1CD08543A3A5178871074628E0126A6EDA890D26E0</Hashes>
        <Hashes condition="contains">SHA256=50DB5480D0392A7DD6AB5DF98389DC24D1ED1E9C98C9C35964B19DABCD6DC67F</Hashes>
        <Hashes condition="contains">SHA256=607DC4C75AC7AEF82AE0616A453866B3B358C6CF5C8F9D29E4D37F844306B97C</Hashes>
        <Hashes condition="contains">SHA256=61D6E40601FA368800980801A662A5B3B36E3C23296E8AE1C85726A56EF18CC8</Hashes>
        <Hashes condition="contains">SHA256=74A846C61ADC53692D3040AFF4C1916F32987AD72B07FE226E9E7DBEFF1036C4</Hashes>
        <Hashes condition="contains">SHA256=76FB4DEAEE57EF30E56C382C92ABFFE2CF616D08DBECB3368C8EE6B02E59F303</Hashes>
        <Hashes condition="contains">SHA256=81939E5C12BD627FF268E9887D6FB57E95E6049F28921F3437898757E7F21469</Hashes>
        <Hashes condition="contains">SHA256=9790A7B9D624B2B18768BB655DDA4A05A9929633CEF0B1521E79E40D7DE0A05B</Hashes>
        <Hashes condition="contains">SHA256=9A1D66036B0868BBB1B2823209FEDEA61A301D5DD245F8E7D390BD31E52D663E</Hashes>
        <Hashes condition="contains">SHA256=AA9AB1195DC866270E984F1BED5E1358D6EF24C515DFDB6C2A92D1E1B94BF608</Hashes>
        <Hashes condition="contains">SHA256=AF095DE15A16255CA1B2C27DAD365DFF9AC32D2A75E8E288F5A1307680781685</Hashes>
        <Hashes condition="contains">SHA256=D5586DC1E61796A9AE5E5D1CED397874753056C3DF2EB963A8916287E1929A71</Hashes>
        <Hashes condition="contains">SHA256=D8459F7D707C635E2C04D6D6D47B63F73BA3F6629702C7A6E0DF0462F6478AE2</Hashes>
        <Hashes condition="contains">SHA256=E81230217988F3E7EC6F89A06D231EC66039BDBA340FD8EBB2BBB586506E3293</Hashes>
        <Hashes condition="contains">SHA256=F88EBB633406A086D9CCA6BC8B66A4EA940C5476529F9033A9E0463512A23A57</Hashes>
        <Hashes condition="contains">SHA256=1C8DFA14888BB58848B4792FB1D8A921976A9463BE8334CFF45CC96F1276049A</Hashes>
        <Hashes condition="contains">SHA256=22418016E980E0A4A2D01CA210A17059916A4208352C1018B0079CCB19AAF86A</Hashes>
        <Hashes condition="contains">SHA256=405472A8F9400A54BB29D03B436CCD58CFD6442FE686F6D2ED4F63F002854659</Hashes>
        <Hashes condition="contains">SHA256=49F75746EEBE14E5DB11706B3E58ACCC62D4034D2F1C05C681ECEF5D1AD933BA</Hashes>
        <Hashes condition="contains">SHA256=4A3D4DB86F580B1680D6454BAEE1C1A139E2DDE7D55E972BA7C92EC3F555DCE2</Hashes>
        <Hashes condition="contains">SHA256=4AB41816ABBF14D59E75B7FAD49E2CB1C1FEB27A3CB27402297A2A4793FF9DA7</Hashes>
        <Hashes condition="contains">SHA256=54841D9F89E195196E65AA881834804FE3678F1CF6B328CAB8703EDD15E3EC57</Hashes>
        <Hashes condition="contains">SHA256=5EE292B605CD3751A24E5949AAE615D472A3C72688632C3040DC311055B75A92</Hashes>
        <Hashes condition="contains">SHA256=76B86543CE05540048F954FED37BDDA66360C4A3DDB8328213D5AEF7A960C184</Hashes>
        <Hashes condition="contains">SHA256=7F190F6E5AB0EDAFD63391506C2360230AF4C2D56C45FC8996A168A1FC12D457</Hashes>
        <Hashes condition="contains">SHA256=845F1E228DE249FC1DDF8DC28C39D03E8AD328A6277B6502D3932E83B879A65A</Hashes>
        <Hashes condition="contains">SHA256=84BF1D0BCDF175CFE8AEA2973E0373015793D43907410AE97E2071B2C4B8E2D4</Hashes>
        <Hashes condition="contains">SHA256=8EF0AD86500094E8FA3D9E7D53163AA6FEEF67C09575C169873C494ED66F057F</Hashes>
        <Hashes condition="contains">SHA256=A56C2A2425EB3A4260CC7FC5C8D7BED7A3B4CD2AF256185F24471C668853AEE8</Hashes>
        <Hashes condition="contains">SHA256=AC3F613D457FC4D44FA27B2E0B1BAA62C09415705EFB5A40A4756DA39B3AC165</Hashes>
        <Hashes condition="contains">SHA256=B1334A71CC73B3D0C54F62D8011BEC330DFC355A239BF94A121F6E4C86A30A2E</Hashes>
        <Hashes condition="contains">SHA256=B47BE212352D407D0EF7458A7161C66B47C2AEC8391DD101DF11E65728337A6A</Hashes>
        <Hashes condition="contains">SHA256=B9B3878DDC5DFB237D38F8D25067267870AFD67D12A330397A8853209C4D889C</Hashes>
        <Hashes condition="contains">SHA256=DB90E554AD249C2BD888282ECF7D8DA4D1538DD364129A3327B54F8242DD5653</Hashes>
        <Hashes condition="contains">SHA256=E61A54F6D3869B43C4ECEAC3016DF73DF67CCE03878C5A6167166601C5D3F028</Hashes>
        <Hashes condition="contains">SHA256=3871E16758A1778907667F78589359734F7F62F9DC953EC558946DCDBE6951E3</Hashes>
        <Hashes condition="contains">SHA256=DED2927F9A4E64EEFD09D0CABA78E94F309E3A6292841AE81D5528CAB109F95D</Hashes>
        <Hashes condition="contains">SHA256=0296E2CE999E67C76352613A718E11516FE1B0EFC3FFDB8918FC999DD76A73A5</Hashes>
        <Hashes condition="contains">SHA256=80CBBA9F404DF3E642F22C476664D63D7C229D45D34F5CD0E19C65EB41BECEC3</Hashes>
        <Hashes condition="contains">SHA256=BB50818A07B0EB1BD317467139B7EB4BAD6CD89053FECDABFEAE111689825955</Hashes>
        <Hashes condition="contains">SHA256=FF6729518A380BF57F1BC6F1EC0AA7F3012E1618B8D9B0F31A61D299EE2B4339</Hashes>
        <Hashes condition="contains">SHA256=3A5EC83FE670E5E23AEF3AFA0A7241053F5B6BE5E6CA01766D6B5F9177183C25</Hashes>
        <Hashes condition="contains">SHA256=61A1BDDDD3C512E681818DEBB5BEE94DB701768FC25E674FCAD46592A3259BD0</Hashes>
        <Hashes condition="contains">SHA256=07B6D69BAFCFD767F1B63A490A8843C3BB1F8E1BBEA56176109B5743C8F7D357</Hashes>
        <Hashes condition="contains">SHA256=21CCDD306B5183C00ECFD0475B3152E7D94B921E858E59B68A03E925D1715F21</Hashes>
        <Hashes condition="contains">SHA256=2D83CCB1AD9839C9F5B3F10B1F856177DF1594C66CBBC7661677D4B462EBF44D</Hashes>
        <Hashes condition="contains">SHA256=F581DECC2888EF27EE1EA85EA23BBB5FB2FE6A554266FF5A1476ACD1D29D53AF</Hashes>
        <Hashes condition="contains">SHA256=F8965FDCE668692C3785AFA3559159F9A18287BC0D53ABB21902895A8ECF221B</Hashes>
        <Hashes condition="contains">SHA256=3D23BDBAF9905259D858DF5BF991EB23D2DC9F4ECDA7F9F77839691ACEF1B8C4</Hashes>
        <Hashes condition="contains">SHA256=DD4A1253D47DE14EF83F1BC8B40816A86CCF90D1E624C5ADF9203AE9D51D4097</Hashes>
        <Hashes condition="contains">SHA256=509628B6D16D2428031311D7BD2ADD8D5F5160E9ECC0CD909F1E82BBBB3234D6</Hashes>
        <Hashes condition="contains">SHA256=525D9B51A80CA0CD4C5889A96F857E73F3A80DA1FFBAE59851E0F51BDFB0B6CD</Hashes>
        <Hashes condition="contains">SHA256=6DE84CAA2CA18673E01B91AF58220C60AECD5CCCF269725EC3C7F226B2167492</Hashes>
        <Hashes condition="contains">SHA256=09BEDBF7A41E0F8DABE4F41D331DB58373CE15B2E9204540873A1884F38BDDE1</Hashes>
        <Hashes condition="contains">SHA256=101402D4F5D1AE413DED499C78A5FCBBC7E3BAE9B000D64C1DD64E3C48C37558</Hashes>
        <Hashes condition="contains">SHA256=131D5490CEB9A5B2324D8E927FEA5BECFC633015661DE2F4C2F2375A3A3B64C6</Hashes>
        <Hashes condition="contains">SHA256=1DDFE4756F5DB9FB319D6C6DA9C41C588A729D9E7817190B027B38E9C076D219</Hashes>
        <Hashes condition="contains">SHA256=1E8B0C1966E566A523D652E00F7727D8B0663F1DFDCE3B9A09B9ADFAEF48D8EE</Hashes>
        <Hashes condition="contains">SHA256=2BBE65CBEC3BB069E92233924F7EE1F95FFA16173FCEB932C34F68D862781250</Hashes>
        <Hashes condition="contains">SHA256=30706F110725199E338E9CC1C940D9A644D19A14F0EB8847712CBA4CACDA67AB</Hashes>
        <Hashes condition="contains">SHA256=3124B0411B8077605DB2A9B7909D8240E0D554496600E2706E531C93C931E1B5</Hashes>
        <Hashes condition="contains">SHA256=38FA0C663C8689048726666F1C5E019FEAA9DA8278F1DF6FF62DA33961891D2A</Hashes>
        <Hashes condition="contains">SHA256=39CFDE7D401EFCE4F550E0A9461F5FC4D71FA07235E1336E4F0B4882BD76550E</Hashes>
        <Hashes condition="contains">SHA256=3D9E83B189FCF5C3541C62D1F54A0DA0A4E5B62C3243D2989AFC46644056C8E3</Hashes>
        <Hashes condition="contains">SHA256=3F2FDA9A7A9C57B7138687BBCE49A2E156D6095DDDABB3454EA09737E02C3FA5</Hashes>
        <Hashes condition="contains">SHA256=47F0CDAA2359A63AD1389EF4A635F1F6EEE1F63BDF6EF177F114BDCDADC2E005</Hashes>
        <Hashes condition="contains">SHA256=50D5EAA168C077CE5B7F15B3F2C43BD2B86B07B1E926C1B332F8CB13BD2E0793</Hashes>
        <Hashes condition="contains">SHA256=56A3C9AC137D862A85B4004F043D46542A1B61C6ACB438098A9640469E2D80E7</Hashes>
        <Hashes condition="contains">SHA256=591BD5E92DFA0117B3DAA29750E73E2DB25BAA717C31217539D30FFB1F7F3A52</Hashes>
        <Hashes condition="contains">SHA256=5D530E111400785D183057113D70623E17AF32931668AB7C7FC826F0FD4F91A3</Hashes>
        <Hashes condition="contains">SHA256=6F1FF29E2E710F6D064DC74E8E011331D807C32CC2A622CBE507FD4B4D43F8F4</Hashes>
        <Hashes condition="contains">SHA256=79E2D37632C417138970B4FEBA91B7E10C2EA251C5EFE3D1FC6FA0190F176B57</Hashes>
        <Hashes condition="contains">SHA256=85866E8C25D82C1EC91D7A8076C7D073CCCF421CF57D9C83D80D63943A4EDD94</Hashes>
        <Hashes condition="contains">SHA256=89B0017BC30CC026E32B758C66A1AF88BD54C6A78E11EC2908FF854E00AC46BE</Hashes>
        <Hashes condition="contains">SHA256=9254F012009D55F555418FF85F7D93B184AB7CB0E37AECDFDAB62CFE94DEA96B</Hashes>
        <Hashes condition="contains">SHA256=984A77E5424C6D099051441005F2938AE92B31B5AD8F6521C6B001932862ADD7</Hashes>
        <Hashes condition="contains">SHA256=98B734DDA78C16EBCAA4AFEB31007926542B63B2F163B2F733FA0D00DBB344D8</Hashes>
        <Hashes condition="contains">SHA256=99F4994A0E5BD1BF6E3F637D3225C69FF4CD620557E23637533E7F18D7D6CBA1</Hashes>
        <Hashes condition="contains">SHA256=9C10E2EC4F9EF591415F9A784B93DC9C9CDAFA7C69602C0DC860C5B62222E449</Hashes>
        <Hashes condition="contains">SHA256=A961F5939088238D76757669A9A81905E33F247C9C635B908DAAC146AE063499</Hashes>
        <Hashes condition="contains">SHA256=A9706E320179993DADE519A83061477ACE195DAA1B788662825484813001F526</Hashes>
        <Hashes condition="contains">SHA256=B7A20B5F15E1871B392782C46EBCC897929443D82073EE4DCB3874B6A5976B5D</Hashes>
        <Hashes condition="contains">SHA256=CC586254E9E89E88334ADEE44E332166119307E79C2F18F6C2AB90CE8BA7FC9B</Hashes>
        <Hashes condition="contains">SHA256=CD4A249C3EF65AF285D0F8F30A8A96E83688486AAB515836318A2559757A89BB</Hashes>
        <Hashes condition="contains">SHA256=CF4B5FA853CE809F1924DF3A3AE3C4E191878C4EA5248D8785DC7E51807A512B</Hashes>
        <Hashes condition="contains">SHA256=D0BD1AE72AEB5F3EABF1531A635F990E5EAAE7FDD560342F915F723766C80889</Hashes>
        <Hashes condition="contains">SHA256=D8B58F6A89A7618558E37AFC360CD772B6731E3BA367F8D58734ECEE2244A530</Hashes>
        <Hashes condition="contains">SHA256=D92EAB70BCECE4432258C9C9A914483A2267F6AB5CE2630048D3A99E8CB1B482</Hashes>
        <Hashes condition="contains">SHA256=E005E8D183E853A27AD3BB56F25489F369C11B0D47E3D4095AAD9291B3343BF1</Hashes>
        <Hashes condition="contains">SHA256=E68D453D333854787F8470C8BAEF3E0D082F26DF5AA19C0493898BCF3401E39A</Hashes>
        <Hashes condition="contains">SHA256=E83908EBA2501A00EF9E74E7D1C8B4FF1279F1CD6051707FD51824F87E4378FA</Hashes>
        <Hashes condition="contains">SHA256=EF86C4E5EE1DBC4F81CD864E8CD2F4A2A85EE4475B9A9AB698A4AE1CC71FBEB0</Hashes>
        <Hashes condition="contains">SHA256=F088B2BA27DACD5C28F8EE428F1350DCA4BC7C6606309C287C801B2E1DA1A53D</Hashes>
        <Hashes condition="contains">SHA256=FD8669794C67B396C12FC5F08E9C004FDF851A82FAF302846878173E4FBECB03</Hashes>
        <Hashes condition="contains">SHA256=91314768DA140999E682D2A290D48B78BB25A35525EA12C1B1F9634D14602B2C</Hashes>
        <Hashes condition="contains">SHA256=F0605DDA1DEF240DC7E14EFA73927D6C6D89988C01EA8647B671667B2B167008</Hashes>
        <Hashes condition="contains">SHA256=6CB51AE871FBD5D07C5AAD6FF8EEA43D34063089528603CA9CEB8B4F52F68DDC</Hashes>
        <Hashes condition="contains">SHA256=DB2A9247177E8CDD50FE9433D066B86FFD2A84301AA6B2EB60F361CFFF077004</Hashes>
        <Hashes condition="contains">SHA256=7EC93F34EB323823EB199FBF8D06219086D517D0E8F4B9E348D7AFD41EC9FD5D</Hashes>
        <Hashes condition="contains">SHA256=7049F3C939EFE76A5556C2A2C04386DB51DAF61D56B679F4868BB0983C996EBB</Hashes>
        <Hashes condition="contains">SHA256=7877C1B0E7429453B750218CA491C2825DAE684AD9616642EFF7B41715C70ACA</Hashes>
        <Hashes condition="contains">SHA256=159E7C5A12157AF92E0D14A0D3EA116F91C09E21A9831486E6DC592C93C10980</Hashes>
        <Hashes condition="contains">SHA256=3243AAB18E273A9B9C4280A57AECEF278E10BFFF19ABB260D7A7820E41739099</Hashes>
        <Hashes condition="contains">SHA256=7CFA5E10DFF8A99A5D544B011F676BC383991274C693E21E3AF40CF6982ADB8C</Hashes>
        <Hashes condition="contains">SHA256=C9B49B52B493B53CD49C12C3FA9553E57C5394555B64E32D1208F5B96A5B8C6E</Hashes>
        <Hashes condition="contains">SHA256=3EC5AD51E6879464DFBCCB9F4ED76C6325056A42548D5994BA869DA9C4C039A8</Hashes>
        <Hashes condition="contains">SHA256=47EAEBC920CCF99E09FC9924FEB6B19B8A28589F52783327067C9B09754B5E84</Hashes>
        <!--# The list below is from https://github.com/jbaines-r7/dellicious and https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/ -->
        <Hashes condition="contains">SHA256=1aaf4c1e3cb6774857e2eef27c17e68dc1ae577112e4769665f516c2e8c4e27b</Hashes>
        <Hashes condition="contains">SHA256=e6056443537d4d2314dabca1b9168f1eaaf17a14eb41f6f5741b6b82b3119790</Hashes>
        <Hashes condition="contains">SHA256=76660e91f1ff3cb89630df5af4fe09de6098d09baa66b1a130c89c3c5edd5b22</Hashes>
        <Hashes condition="contains">SHA256=6c7120e40fc850e4715058b233f5ad4527d1084a909114fd6a36b7b7573c4a44</Hashes>
        <Hashes condition="contains">SHA256=2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8</Hashes>
        <Hashes condition="contains">SHA256=71fe5af0f1564dc187eea8d59c0fbc897712afa07d18316d2080330ba17cf009</Hashes>
        <Hashes condition="contains">SHA256=39937d239220c1b779d7d55613de2c0a48bd6e12e0214da4c65992b96cf591df</Hashes>
        <Hashes condition="contains">SHA256=7ed26a593524a2a92ffcfb075a42bb4fa4775ffbf83af98525244a4710886ead</Hashes>
        <Hashes condition="contains">SHA256=aa717e9ab4d614497df19f602d289a6eddcdba8027c71bcc807780a219347d16</Hashes>
        <Hashes condition="contains">SHA256=ff5f6048a3d6f6738b60e911e3876fcbdc9a02ec9862f909345c8a50fd4cc0a7</Hashes>
        <Hashes condition="contains">SHA256=11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5</Hashes>
        <Hashes condition="contains">SHA256=58a74dceb2022cd8a358b92acd1b48a5e01c524c3b0195d7033e4bd55eff4495</Hashes>
        <Hashes condition="contains">SHA256=01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd</Hashes>
        <Hashes condition="contains">SHA256=22be050955347661685a4343c51f11c7811674e030386d2264cd12ecbf544b7c</Hashes>
        <Hashes condition="contains">SHA256=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427</Hashes>
        <!--# The list below is from https://gist.github.com/k4nfr3/af970e7facb09195e56f2112e1c9549c -->
        <Hashes condition="contains">SHA256=952199C28332BC90CFD74530A77EE237967ED32B3C71322559C59F7A42187DC4</Hashes>
        <Hashes condition="contains">SHA256=9529EFB1837B1005E5E8F477773752078E0A46500C748BC30C9B5084D04082E6</Hashes>
        <Hashes condition="contains">SHA256=A7B000ABBCC344444A9B00CFADE7AA22AB92CE0CADEC196C30EB1851AE4FA062</Hashes>
        <Hashes condition="contains">SHA256=4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b</Hashes>
        <Hashes condition="contains">SHA256=01e024cb14b34b6d525c642a710bfa14497ea20fd287c39ba404b10a8b143ece</Hashes>
        <Hashes condition="contains">SHA256=9fc29480407e5179aa8ea41682409b4ea33f1a42026277613d6484e5419de374</Hashes>
        <Hashes condition="contains">SHA256=06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50</Hashes>
        <Hashes condition="contains">SHA256=cbb8239a765bf5b2c1b6a5c8832d2cab8fef5deacadfb65d8ed43ef56d291ab6</Hashes>
        <Hashes condition="contains">SHA256=d205286bffdf09bc033c09e95c519c1c267b40c2ee8bab703c6a2d86741ccd3e</Hashes>
        <!--# https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md -->
        <Hashes condition="contains">SHA256=a7c2e7910942dd5e43e2f4eb159bcd2b4e71366e34a68109548b9fb12ac0f7cc</Hashes>
        <Hashes condition="contains">SHA256=2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d</Hashes>
        <Hashes condition="contains">SHA256=f929bead59e9424ab90427b379dcdd63fbfe0c4fb5e1792e3a1685541cd5ec65</Hashes>
        <Hashes condition="contains">SHA256=59626cac380d8fe0b80a6d4c4406d62ba0683a2f0f68d50ad506ca1b1cf25347</Hashes>
        <Hashes condition="contains">SHA256=552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9</Hashes>
        <Hashes condition="contains">SHA256=86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219</Hashes>
        <Hashes condition="contains">SHA256=1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8</Hashes>
        <Hashes condition="contains">SHA256=60c6f4f34c7319cb3f9ca682e59d92711a05a2688badbae4891b1303cd384813</Hashes>
        <Hashes condition="contains">SHA256=55fee54c0d0d873724864dc0b2a10b38b7f40300ee9cae4d9baaf8a202c4049a</Hashes>
        <Hashes condition="contains">SHA256=42f0b036687cbd7717c9efed6991c00d4e3e7b032dc965a2556c02177dfdad0f</Hashes>
        <Hashes condition="contains">SHA256=bb1135b51acca8348d285dc5461d10e8f57260e7d0c8cc4a092734d53fc40cbc</Hashes>
        <Hashes condition="contains">SHA256=b179e1ab6dc0b1aee783adbcad4ad6bb75a8a64cb798f30c0dd2ee8aaf43e6de</Hashes>
        <Hashes condition="contains">SHA256=314384b40626800b1cde6fbc51ebc7d13e91398be2688c2a58354aa08d00b073</Hashes>
        <Hashes condition="contains">SHA256=65db1b259e305a52042e07e111f4fa4af16542c8bacd33655f753ef642228890</Hashes>
        <Hashes condition="contains">SHA256=19a212e6fc324f4cb9ee5eba60f5c1fc0191799a4432265cbeaa3307c76a7fc0</Hashes>
        <Hashes condition="contains">SHA256=a7c8f4faf3cbb088cac7753d81f8ec4c38ccb97cd9da817741f49272e8d01200</Hashes>
        <Hashes condition="contains">SHA256=677c0b1add3990fad51f492553d3533115c50a242a919437ccb145943011d2bf</Hashes>
        <Hashes condition="contains">SHA256=fc22977ff721b3d718b71c42440ee2d8a144f3fbc7755e4331ddd5bcc65158d2</Hashes>
        <Hashes condition="contains">SHA256=ad40e6d0f77c0e579fb87c5106bf6de3d1a9f30ee2fbf8c9c011f377fa05f173</Hashes>
        <Hashes condition="contains">SHA256=18e1707b319c279c7e0204074088cc39286007a1cf6cb6e269d5067d8d0628c6</Hashes>
        <Hashes condition="contains">SHA256=c9cf1d627078f63a36bbde364cd0d5f2be1714124d186c06db5bcdf549a109f8</Hashes>
        <Hashes condition="contains">SHA256=afdd66562dea51001c3a9de300f91fc3eb965d6848dfce92ccb9b75853e02508</Hashes>
        <Hashes condition="contains">SHA256=a899b659b08fbae30b182443be8ffb6a6471c1d0497b52293061754886a937a3</Hashes>
        <Hashes condition="contains">SHA256=1963d5a0e512b72353953aadbe694f73a9a576f0241a988378fa40bf574eda52</Hashes>
        <Hashes condition="contains">SHA256=7133a461aeb03b4d69d43f3d26cd1a9e3ee01694e97a0645a3d8aa1a44c39129</Hashes>
        <Hashes condition="contains">SHA256=32e1a8513eee746d17eb5402fb9d8ff9507fb6e1238e7ff06f7a5c50ff3df993</Hashes>
        <Hashes condition="contains">SHA256=082c39fe2e3217004206535e271ebd45c11eb072efde4cc9885b25ba5c39f91d</Hashes>
        <Hashes condition="contains">SHA256=65329dad28e92f4bcc64de15c552b6ef424494028b18875b7dba840053bc0cdd</Hashes>
        <Hashes condition="contains">SHA256=f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35</Hashes>
        <Hashes condition="contains">SHA256=9f1229cd8dd9092c27a01f5d56e3c0d59c2bb9f0139abf042e56f343637fda33</Hashes>
        <Hashes condition="contains">SHA256=b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29</Hashes>
        <!--# The list below is derived from the ELASTIC yara rules https://github.com/elastic/protections-artifacts/search?q=VulnDriver -->
        <!--# These are the hashes mentioned in the "reference_sample" section that ELASTIC used to create their rules -->
        <Hashes condition="contains">SHA256=3943a796cc7c5352aa57ccf544295bfd6fb69aae147bc8235a00202dc6ed6838</Hashes>
        <Hashes condition="contains">SHA256=3c5bf92c26398695f9ced7ce647a7e9f6ddcc89eea66b45aa3607196a187431b</Hashes>
        <Hashes condition="contains">SHA256=478917514be37b32d5ccf76e4009f6f952f39f5553953544f1b0688befd95e82</Hashes>
        <Hashes condition="contains">SHA256=4ed2d2c1b00e87b926fb58b4ea43d2db35e5912975f4400aa7bd9f8c239d08b7</Hashes>
        <Hashes condition="contains">SHA256=b205835b818d8a50903cf76936fcf8160060762725bd74a523320cfbd091c038</Hashes>
        <Hashes condition="contains">SHA256=ab8f2217e59319b88080e052782e559a706fa4fb7b8b708f709ff3617124da89</Hashes>
        <Hashes condition="contains">SHA256=73327429c505d8c5fd690a8ec019ed4fd5a726b607cabe71509111c7bfe9fc7e</Hashes>
        <Hashes condition="contains">SHA256=87e38e7aeaaaa96efe1a74f59fca8371de93544b7af22862eb0e574cec49c7c3</Hashes>
        <Hashes condition="contains">SHA256=2270a8144dabaf159c2888519b11b61e5e13acdaa997820c09798137bded3dd6</Hashes>
        <Hashes condition="contains">SHA256=43ba8d96d5e8e54cab59d82d495eeca730eeb16e4743ed134cdd495c51a4fc89</Hashes>
        <Hashes condition="contains">SHA256=e1980c6592e6d2d92c1a65acad8f1071b6a404097bb6fcce494f3c8ac31385cf</Hashes>
        <Hashes condition="contains">SHA256=1dadd707c55413a16320dc70d2ca7784b94c6658331a753b3424ae696c5d93ea</Hashes>
        <Hashes condition="contains">SHA256=d84e3e250a86227c64a96f6d5ac2b447674ba93d399160850acb2339da43eae5</Hashes>
        <Hashes condition="contains">SHA256=5ae23f1fcf3fb735fcf1fa27f27e610d9945d668a149c7b7b0c84ffd6409d99a</Hashes>
        <Hashes condition="contains">SHA256=0f726d8ce21c0c9e01ebe6b55913c519ad6086bcaec1a89f8308f3effacd435f</Hashes>
        <Hashes condition="contains">SHA256=95d50c69cdbf10c9c9d61e64fe864ac91e6f6caa637d128eb20e1d3510e776d3</Hashes>
        <Hashes condition="contains">SHA256=0e14a4401011a9f4e444028ac5b1595da34bbbf9af04a00670f15ff839734003</Hashes>
        <Hashes condition="contains">SHA256=26c86227d3f387897c1efd77dc711eef748eb90be84149cb306e3d4c45cc71c7</Hashes>
        <Hashes condition="contains">SHA256=42d926cfb3794f9b1e3cb397498696cb687f505e15feb9df11b419c49c9af498</Hashes>
        <Hashes condition="contains">SHA256=1684e24dae20ab83ab5462aa1ff6473110ec53f52a32cfb8c1fe95a2642c6d22</Hashes>
        <Hashes condition="contains">SHA256=9b6a84f7c40ea51c38cc4d2e93efb3375e9d98d4894a85941190d94fbe73a4e4</Hashes>
        <Hashes condition="contains">SHA256=440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c</Hashes>
        <Hashes condition="contains">SHA256=e05eeb2b8c18ad2cb2d1038c043d770a0d51b96b748bc34be3e7fc6f3790ce53</Hashes>
        <Hashes condition="contains">SHA256=3a364a7a3f6c0f2f925a060e84fb18b16c118125165b5ea6c94363221dc1b6de</Hashes>
        <Hashes condition="contains">SHA256=fda506e2aa85dc41a4cbc23d3ecc71ab34e06f1def736e58862dc449acbc2330</Hashes>
        <Hashes condition="contains">SHA256=3ac5e01689a3d745e60925bc7faca8d4306ae693e803b5e19c94906dc30add46</Hashes>
        <Hashes condition="contains">SHA256=175eed7a4c6de9c3156c7ae16ae85c554959ec350f1c8aaa6dfe8c7e99de3347</Hashes>
        <Hashes condition="contains">SHA256=8596ea3952d84eeef8f5dc5b0b83014feb101ec295b2d80910f21508a95aa026</Hashes>
        <Hashes condition="contains">SHA256=52a90fd1546c068b92add52c29fbb8a87d472a57e609146bbcb34862f9dcec15</Hashes>
        <Hashes condition="contains">SHA256=543991ca8d1c65113dff039b85ae3f9a87f503daec30f46929fd454bc57e5a91</Hashes>
        <Hashes condition="contains">SHA256=e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf</Hashes>
        <Hashes condition="contains">SHA256=1aaa9aef39cb3c0a854ecb4ca7d3b213458f302025e0ec5bfbdef973cca9111c</Hashes>
        <Hashes condition="contains">SHA256=cc687fe3741bbde1dd142eac0ef59fd1d4457daee43cdde23bb162ef28d04e64</Hashes>
        <Hashes condition="contains">SHA256=3ed15a390d8dfbd8a8fb99e8367e19bfd1cced0e629dfe43ccdb46c863394b59</Hashes>
        <Hashes condition="contains">SHA256=8c95d28270a4a314299cf50f05dcbe63033b2a555195d2ad2f678e09e00393e6</Hashes>
        <Hashes condition="contains">SHA256=eea53103e7a5a55dc1df79797395a2a3e96123ebd71cdd2db4b1be80e7b3f02b</Hashes>
        <Hashes condition="contains">SHA256=37c637a74bf20d7630281581a8fae124200920df11ad7cd68c14c26cc12c5ec9</Hashes>
        <Hashes condition="contains">SHA256=32cccc4f249499061c0afa18f534c825d01034a1f6815f5506bf4c4ff55d1351</Hashes>
        <Hashes condition="contains">SHA256=c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5</Hashes>
        <Hashes condition="contains">SHA256=ff803017d1acafde6149fe7d463aee23b1c4f6f3b97c698c05f3ca6f07e4df6c</Hashes>
        <Hashes condition="contains">SHA256=000547560fea0dd4b477eb28bf781ea67bf83c748945ce8923f90fdd14eb7a4b</Hashes>
        <Hashes condition="contains">SHA256=0af5ccb3d33a9ba92071c9637be6254030d61998733a5eb3583e865e17844e05</Hashes>
        <Hashes condition="contains">SHA256=a13054f349b7baa8c8a3fcbd31789807a493cc52224bbff5e412eb2bd52a6433</Hashes>
      </Rule>
    </DriverLoad>
  </RuleGroup>
  <RuleGroup name="RG=DriverLoad Exclude Group" groupRelation="or">
    <DriverLoad onmatch="exclude">
    <!--COMMENT: Because drivers with bugs can be used to escalate to kernel permissions, be extremely selective
        about what you exclude from monitoring. Low event volume, little incentive to exclude.-->
    </DriverLoad>
  </RuleGroup>
  <!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->
    <!--COMMENT: Can potentially cause high system load depending on system workload. Monitor performance usage of Sysmon.-->
  <RuleGroup name="RG=Image Load Includes" groupRelation="or">
    <ImageLoad onmatch="include">
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Module: Module Load,Level=4,Alert=MSDT Loading diagnostic library: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <Image condition="image">msdt.exe</Image>
        <ImageLoaded condition="contains">sdiageng.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE7 Macro Image Loads with wshom,Risk=70" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="contains all">VBE7.DLL;VBE7INTL.DLL;VBEUI.DLL;wshom.ocx</ImageLoaded>
        <ImageLoaded condition="excludes all">wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Suspicious Process Loading ntkrnlmp.exe,Risk=50" groupRelation="and">
        <ImageLoaded condition="image">ntkrnlmp.exe</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,CVE=CVE-2021-1675,DS=Module: Module Load,Level=0,Desc=Printer Expoit,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains any">\spool\drivers\x64\3\;\spool\drivers\W32X86\3\;\spool\drivers\IA64\3\</ImageLoaded>
        <Image condition="contains any">spoolsv.exe;printisolationhost.exe</Image>
        <SignatureStatus condition="excludes">Valid</SignatureStatus>
        <Company condition="excludes any">Brother Industries;Canon;Sharp;Microsoft Corporation;DYMO;Euro Plus d.o.o;HP Inc;Hewlett-Packard</Company>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Module: Module Load,Level=0,Desc=DLL Image Load by System in Suspicious Locations" groupRelation="and">
        <Image condition="begin with">C:\Windows\</Image>
        <ImageLoaded condition="contains any">\Users\Public\;\Desktop\;\Downloads\;\AppData\Local\Temp\;\PerfLogs\;$Recycle;\Fonts\</ImageLoaded>
        <ImageLoaded condition="excludes any">\Program Files</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Equation editor loading itself,Risk=50" groupRelation="and">
        <Image condition="image">EQNEDT32.EXE</Image>
        <ImageLoaded condition="contains">EQNEDT32.EXE</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Module: Module Load,Level=2,Alert=Windows Active Directory Services DLL Loading in Susicious Directories,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains any">ACTIVEDS.DLL;Adsldpc.dll;Wldap32.dll;adsldp.dll</ImageLoaded>
        <Image condition="contains any">C:\Users;\Temp\;\ProgramData\</Image>
        <Image condition="excludes">ConnectWise.exe</Image>
        <Image condition="excludes">\MSP Anywhere for N-central\Viewer\tkcuploader.exe</Image>
      </Rule>
      <Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Module: Module Load,Level=2,Alert=Windows Active Directory Services DLL Loading by Suspicious Process,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains any">ACTIVEDS.DLL;Adsldpc.dll;Wldap32.dll;adsldp.dll</ImageLoaded>
        <Image condition="contains any">\wscript.exe;\cscript.exe;\powershell.exe;\powershell_ise.exe;\rundll32.exe;\msbuild.exe;\csc.exe</Image>
        <FileVersion condition="excludes">6.3.9600.20566 (winblue_ltsb_escrow.220812-1741)</FileVersion>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE6 Macro Image Loads with wshom,Risk=40" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="contains all">VBEUI.DLL;VBE6.DLL;VBE6INTL.DLL;wshom.ocx</ImageLoaded>
        <ImageLoaded condition="excludes all">wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll;fastprox.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE7 Macro Image Loads with wmi,Risk=30" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="contains all">VBE7.DLL;VBE7INTL.DLL;VBEUI.DLL;wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE6 Macro Image Loads with wmi,Risk=50" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="contains all">VBEUI.DLL;VBE6.DLL;VBE6INTL.DLL;wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office taskschd.dll Load" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WScript taskschd.dll Load" groupRelation="and">
        <Image condition="contains any">wscript.exe;cscript.exe</Image>
        <ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WMI taskschd.dll Load" groupRelation="and">
        <Image condition="image">wmiprvse.exe</Image>
        <ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Loading MSI.dll" groupRelation="and">
        <Image condition="image">powershell.exe</Image>
        <ImageLoaded condition="end with">msi.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Loading AMSI.dll" groupRelation="and">
        <Image condition="contains">powershell</Image>
        <ImageLoaded condition="end with">amsi.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Not Loading AMSI.dll" groupRelation="and">
        <Image condition="excludes">powershell</Image>
        <ImageLoaded condition="end with">amsi.dll</ImageLoaded>
        <Image condition="excludes any">C:\Program Files (x86)\N-Able Technologies\AutomationManagerEngine\2.70.0.4\AutomationManager.ScriptRunner64.exe;C:\Program Files\Cavelo\Cavelo Agent\osqueryi.exe;C:\Program Files (x86)\Duo Device Health\Duo Device Health.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Monitor logoncli.dll dll loads for injection - potential qbot activity" groupRelation="and">
        <ImageLoaded condition="end with">logoncli.dll</ImageLoaded>
        <Image condition="is not">C:\Windows\System32\wbem\WmiPrvSE.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office clr.dll Load" groupRelation="and">
        <Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
        <ImageLoaded condition="end with">clr.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Suspicious clr windows management dll Load" groupRelation="and">
        <ImageLoaded condition="contains all">clr.dll;System.Management.ni.dll;Microsoft.Build.Utilities</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Wscript Internet Access library Loads" groupRelation="and">
        <Image condition="contains any">wscript.exe;cscript.exe</Image>
        <ImageLoaded condition="contains all">msxml;wshom.ocx</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Wscript Internet Access library Loads 2" groupRelation="and">
        <Image condition="contains any">wscript.exe;cscript.exe</Image>
        <ImageLoaded condition="contains all">winhttp.dll;mswsock.dll;IPHLPAPI.DLL</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Interesting Installutil DLL Loads" groupRelation="and">
        <Image condition="contains any">installutil.exe</Image>
        <ImageLoaded condition="contains all">CustomMarshalers.dll;CustomMarshalers.ni.dll;System.Management.ni.dll;WMINet_Utils.dll;mswsock.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Automation NI DLL Loaded" groupRelation="and">
        <ImageLoaded condition="end with">System.Management.Automation.ni.dll</ImageLoaded>
        <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Automation DLL Loaded" groupRelation="and">
        <ImageLoaded condition="end with">System.Management.Automation.dll</ImageLoaded>
        <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\</ImageLoaded>
        <ImageLoaded condition="excludes any">Lenovo.Vantage.AddinHost;\Microsoft.Sara.exe;C:\Program Files\CONEXANT</ImageLoaded>
        <Image condition="excludes any">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe;C:\Program Files (x86)\N-able Technologies\AutomationManagerAgent\AutomationManager.AgentService.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Credential Manager DLL Loaded" groupRelation="and">
        <ImageLoaded condition="is">C:\Windows\System32\vaultcli.dll</ImageLoaded>
        <Image condition="excludes any">\svchost.exe;\GameBar.exe;C:\Program Files\WindowsApps;\Microsoft\Teams\current\Teams.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=UNC Path Image Loaded" groupRelation="and">
        <ImageLoaded condition="begin with">\\</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WLL Office Application Startup" groupRelation="and">
        <ImageLoaded condition="contains">\Microsoft\Word\Startup\</ImageLoaded>
        <ImageLoaded condition="end with">.wll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup" groupRelation="and">
        <ImageLoaded condition="contains">\Microsoft\Excel\Startup\</ImageLoaded>
        <ImageLoaded condition="end with">.xll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office Application Startup Generic" groupRelation="and">
        <ImageLoaded condition="contains">\Microsoft\Addins\</ImageLoaded>
        <ImageLoaded condition="contains any">.xla</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1090.003,Technique=Proxy: Multi-hop Proxy,Tactic=Defense Evasion,DS=Module: Module Load,Level=4,Alert=Ransomware detected tor library,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains">tor-lib.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Cred Dumping,Risk=90" groupRelation="and">
        <ImageLoaded condition="is any">C:\Windows\System32\WinSCard.dll;C:\Windows\System32\cryptdll.dll;C:\Windows\System32\hid.dll;C:\Windows\System32\samlib.dll;C:\Windows\System32\vaultcli.dll</ImageLoaded>
        <Image condition="excludes any">C:\Program Files\Cavelo\Cavelo Agent\osqueryi.exe;C:\Program Files\Veeam\Backup and Replication\Console\veeam.backup.shell.exe</Image>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Mimikatz Cred Dumping,Risk=100" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
        <ImageLoaded condition="contains all">vaultcli.dll;wlanapi.dll</ImageLoaded>
        <ImageLoaded condition="excludes">combase.dll</ImageLoaded>
        <ImageLoaded condition="excludes">cryptdll.dll</ImageLoaded>
        <ImageLoaded condition="excludes">imm32.dll</ImageLoaded>
        <ImageLoaded condition="excludes">logoncli.dll</ImageLoaded>
        <ImageLoaded condition="excludes">netapi32.dll</ImageLoaded>
        <ImageLoaded condition="excludes">ntasn1.dll</ImageLoaded>
        <ImageLoaded condition="excludes">ntdsapi.dll</ImageLoaded>
        <ImageLoaded condition="excludes">samlib.dll</ImageLoaded>
        <ImageLoaded condition="excludes">shcore.dll</ImageLoaded>
        <ImageLoaded condition="excludes">srvcli.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Potential C3 Framework,Risk=100" groupRelation="and">
        <ImageLoaded condition="contains all">odbc32.dll;winhttp.dll;netapi32.dll;SHLWAPI.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Explorer Loading Powershell in memory,Risk=100" groupRelation="and">
        <Image condition="image">C:\Windows\Explorer.EXE</Image>
        <ImageLoaded condition="is">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Programdata Image Loading exe Image from Programdata" groupRelation="and">
        <Image condition="begin with">C:\ProgramData\</Image>
        <ImageLoaded condition="begin with">C:\ProgramData\</ImageLoaded>
        <ImageLoaded condition="end with">.exe</ImageLoaded>
        <Company condition="excludes">Adobe</Company>
        <Image condition="excludes any">C:\ProgramData\Lenovo\;C:\ProgramData\Cavelo\jre\bin\java.exe</Image>
        <ImageLoaded condition="excludes">C:\ProgramData\Microsoft\Windows Defender\</ImageLoaded>
        <ImageLoaded condition="excludes">C:\ProgramData\sysmon\sysmon64.exe</ImageLoaded>
        <ImageLoaded condition="excludes">C:\ProgramData\sysmon\sysmon.exe</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Module: Module Load,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
        <ImageLoaded condition="contains any">C:\Users\Default\;C:\Users\Public\</ImageLoaded>
        <ImageLoaded condition="end with">.exe</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Module: Module Load,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
        <ImageLoaded condition="contains any">C:\Users\Default\;C:\Users\Public\</ImageLoaded>
        <ImageLoaded condition="end with">.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Module: Module Load,Level=4,Alert=Solarwinds/FireEye sunburst image hashes,Risk=100" groupRelation="and">
        <Hashes condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hashes><!-- exclude non executable files -->
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Module: Module Load,Level=4,Alert=Sept 2022 Exchange 0day DLL detection,Risk=100" groupRelation="or">
        <Hashes condition="contains">SHA256=074eb0e75bb2d8f59f1fd571a8c5b76f9c899834893da6f7591b68531f2b5d82</Hashes><!--Exchange Zero Day Dropped DLL-->
        <Hashes condition="contains">SHA256=45c8233236a69a081ee390d4faa253177180b2bd45d8ed08369e07429ffbe0a9</Hashes><!--Exchange Zero Day Dropped DLL-->
        <Hashes condition="contains">SHA256=9ceca98c2b24ee30d64184d9d2470f6f2509ed914dafb87604123057a14c57c0</Hashes><!--Exchange Zero Day Dropped DLL-->
        <Hashes condition="contains">SHA256=29b75f0db3006440651c6342dc3c0672210cfb339141c75e12f6c84d990931c3</Hashes><!--Exchange Zero Day Dropped DLL-->
        <Hashes condition="contains">SHA256=c8c907a67955bcdf07dd11d35f2a23498fb5ffe5c6b5d7f36870cf07da47bff2</Hashes><!--Exchange Zero Day Dropped DLL-->
        <Hashes condition="contains">SHA256=76a2f2644cb372f540e179ca2baa110b71de3370bb560aca65dcddbd7da3701e</Hashes><!--Exchange Zero Day Dropped DLL-->
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=SVCHost loading Unsigned DLL" groupRelation="and">
        <Image condition="image">C:\Windows\System32\svchost.exe</Image>
        <Signed condition="is">false</Signed>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Revoked Signature Libraries Loaded" groupRelation="and">
        <SignatureStatus condition="is">Revoked</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Expired Signature Libraries Loaded" groupRelation="and">
        <SignatureStatus condition="is">Expired</SignatureStatus>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=4,Alert=HTA Exec with IE JS Engine AMSI Bypass" groupRelation="and">
        <ImageLoaded condition="end with">jscript9.dll</ImageLoaded>
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <ImageLoaded condition="end with">scrobj.dll</ImageLoaded>
      <ImageLoaded condition="end with">crypt0.dll</ImageLoaded>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Wireless Credential Dumping" groupRelation="and">
        <ImageLoaded condition="end with">C:\Windows\System32\wlanapi.dll</ImageLoaded>
        <Image condition="excludes">C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA Share.exe</Image>
        <Image condition="excludes">C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA Share.exe</Image>
        <Image condition="excludes">C:\Program Files\WindowsApps\MicrosoftWindows.Client.WebExperience</Image>
        <Image condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
        <Image condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
        <Image condition="excludes">C:\Windows\System32\AppHostRegistrationVerifier.exe</Image>
        <Image condition="excludes">C:\Windows\System32\CompatTelRunner.exe</Image>
        <Image condition="excludes">C:\Windows\System32\DeviceCensus.exe</Image>
        <Image condition="excludes">C:\Windows\System32\DriverStore\FileRepository\</Image>
        <Image condition="excludes">C:\Windows\System32\LogonUI.exe</Image>
        <Image condition="excludes">C:\Windows\System32\MoNotificationUx.exe</Image>
        <Image condition="excludes">C:\Windows\System32\SystemSettingsBroker.exe</Image>
        <Image condition="excludes">C:\Windows\System32\dxgiadaptercache.exe</Image>
        <Image condition="excludes">C:\Windows\System32\netsh.exe</Image>
        <Image condition="excludes">C:\Windows\System32\wlanext.exe</Image>
        <Image condition="excludes">C:\Windows\UUS\amd64\MoUsoCoreWorker.exe</Image>
        <Image condition="excludes">C:\Windows\WinSxS\amd64_microsoft-windows-servicingstack_</Image>
        <Image condition="excludes">C:\Windows\explorer.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Module: Module Load,Level=2,Desc=Python DLL Loaded,Risk=30" groupRelation="and">
        <ImageLoaded condition="contains any">python</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Unsigned Global Assembly Cache Load" groupRelation="and">
        <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        <Signed condition="is">false</Signed>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Signed Global Assembly Cache Load" groupRelation="and">
        <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        <Signed condition="is">true</Signed>
        <Image condition="excludes any">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe;C:\Program Files (x86)\N-able Technologies\AutomationManagerAgent\AutomationManager.AgentService.exe;C:\Program Files (x86)\Duo Device Health\Duo Device Health.exe</Image>
      </Rule>
    </ImageLoad>
  </RuleGroup>
  <RuleGroup name="RG=Image Load Excludes" groupRelation="or">
    <ImageLoad onmatch="exclude">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup removal" groupRelation="and">
        <Image condition="contains">\Microsoft Office\</Image>
        <ImageLoaded condition="end with">\mscorlib.ni.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup removal" groupRelation="and">
        <Image condition="contains">\Microsoft Office\</Image>
        <ImageLoaded condition="end with">\sppc.dll</ImageLoaded>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=SVCHost Signed DLL" groupRelation="and">
        <Image condition="image">C:\Windows\System32\svchost.exe</Image>
        <Signed condition="is">true</Signed>
      </Rule>
      <!--Universal Exclusions: Be Careful-->
      <Rule name="Antivirus Exclusions" groupRelation="or">
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files (x86)\ESET</Image>
        <Image condition="begin with">C:\Program Files\ESET</Image>
        <Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\</Image>
      </Rule>
      <Company condition="contains">Fortinet</Company>
      <Company condition="contains">Lenovo</Company>
      <Company condition="contains">Sophos</Company>
      <Image condition="end with">mscorsvw.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Microsoft Office\root\Office15\officebackgroundtaskhandler.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
      <Image condition="image">C:\Program Files\Microsoft Office\root\Office15\officebackgroundtaskhandler.exe</Image>
      <Image condition="image">C:\Program Files\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
      <Image condition="image">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
      <Image condition="image">C:\Windows\System32\InstallAgentUserBroker.exe</Image>
      <Image condition="image">C:\Windows\System32\RuntimeBroker.exe</Image>
      <Image condition="image">C:\Windows\System32\SearchIndexer.exe</Image>
      <Image condition="image">C:\Windows\System32\SettingSyncHost.exe</Image>
      <Image condition="image">C:\Windows\System32\backgroundTaskHost.exe</Image>
      <Image condition="image">C:\Windows\System32\sppsvc.exe</Image>
      <Image condition="image">C:\Windows\System32\taskhost.exe</Image>
      <Image condition="image">C:\Windows\System32\taskhostw.exe</Image>
      <Image condition="image">C:\Windows\SystemApps\Microsoft.AAD.BrokerPlugin_cw5n1h2txyewy\Microsoft.AAD.BrokerPlugin.exe</Image>
      <Image condition="image">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
      <Image condition="image">HxTsr.exe</Image>
      <Image condition="image">SearchUI.exe</Image>
      <ImageLoaded condition="contains">C:\Program Files (x86)\Common Files\BIExcelFunctions1.1\32bit\Sage.</ImageLoaded>
      <ImageLoaded condition="contains">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Pfx.</ImageLoaded>
      <ImageLoaded condition="is">C:\Program Files (x86)\Adobe\Acrobat 10.0\Acrobat\Adist64.dll</ImageLoaded>
      <ImageLoaded condition="is">C:\Program Files (x86)\Microsoft Office\Office15\Library\Analysis\ANALYS32.XLL</ImageLoaded>
      <ImageLoaded condition="is">C:\Program Files (x86)\Microsoft Office\Office16\Library\Analysis\ANALYS32.XLL</ImageLoaded>
      <ImageLoaded condition="is">C:\Program Files\Microsoft Office\Office15\Library\Analysis\ANALYS32.XLL</ImageLoaded>
      <ImageLoaded condition="is">C:\Program Files\Microsoft Office\Office16\Library\Analysis\ANALYS32.XLL</ImageLoaded>
      <ImageLoaded condition="is">C:\Windows\SysWOW64\sppc.dll</ImageLoaded>
      <ImageLoaded condition="end with">Microsoft.Office.Interop.VisOcx.dll</ImageLoaded>
      <ImageLoaded condition="end with">Microsoft.Office.Interop.Word.dll</ImageLoaded>
      <ImageLoaded condition="end with">Microsoft.Vbe.Interop.dll</ImageLoaded>
      <ImageLoaded condition="end with">OFFICE.DLL</ImageLoaded>
    </ImageLoad>
  </RuleGroup>
  <!--SYSMON EVENT ID 8 : REMOTE THREAD CREATED [CreateRemoteThread]-->
    <!--DATA: RuleName, UtcTime, SourceProcessGuid, SourceProcessId, SourceImage, TargetProcessId, TargetImage, NewThreadId, StartAddress, StartModule, StartFunction-->
    <!--COMMENT: Monitor for processes injecting code into other processes. Often used by malware to cloak their actions. Also when Firefox loads Flash.-->
  <RuleGroup name="RG=CreateRemoteThread Include Group" groupRelation="or">
    <CreateRemoteThread onmatch="include">
      <!--Custom Rules-->
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Modification,Level=4,Alert=Credential Dumping from lsass,Risk=100" groupRelation="and">
        <StartAddress condition="is">0x001A0000</StartAddress>
        <TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privledge Escalation,DS=Process: Process Modification,Level=4,Alert=CreateRemoteThread with msiexec,Risk=100" groupRelation="and">
        <SourceImage condition="contains any">msiexec.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Remote Thread Injection Targetting Web Browser,Risk=70" groupRelation="and">
        <TargetImage condition="contains any">chrome.exe;firefox.exe;edge.exe;browser_broker.exe;iexplore.exe;opera.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Process: Process Modification,Level=0,Desc=LSASS Credential dumping,Risk=70" groupRelation="and">
        <StartAddress condition="is">0x001A0000</StartAddress>
        <TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Process: Process Modification,Level=0,Desc=Rundll32 LSASS Credential dumping,Risk=70" groupRelation="and">
        <TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
        <SourceImage condition="image">c:\windows\system32\rundll32.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,DS=Process: Process Modification,Level=4,Alert=Remote Thread Process debugging detected,Risk=30" groupRelation="and">
        <StartFunction condition="contains">DbgUiRemoteBreakin</StartFunction>
        <TargetImage condition="excludes">nacl64.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,DS=Process: Process Modification,Level=0,Desc=Remote Query Debug info,Risk=30" groupRelation="and">
        <StartFunction condition="contains">QueryProcessDebugInformationRemote</StartFunction>
        <TargetImage condition="excludes">nacl64.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Query Debug info 2,Risk=30" groupRelation="and">
        <StartFunction condition="contains">isdebuggerpresent</StartFunction>
        <TargetImage condition="excludes">nacl64.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1546.012,Technique=Process Debugging Detected,Tactic=Defense Evasion,DS=Process: Process Modification,Level=3,Alert=Process Debug of active Process,Risk=30" groupRelation="and">
        <StartFunction condition="contains">DebugActiveProcess</StartFunction>
        <TargetImage condition="excludes">nacl64.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1055.001,Technique=Process Injection: Dynamic-link Library Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=3,Alert=LoadLibrary DLL Injection,Risk=70" groupRelation="and">
        <StartFunction condition="contains">LoadLibrary</StartFunction>
        <SourceImage condition="excludes">C:\Program Files\Bitdefender\Endpoint Security\EPSecurityService.exe</SourceImage>
        <SourceImage condition="excludes">C:\Program Files\NVIDIA Corporation\Display.NvContainer\NVDisplay.Container.exe</SourceImage>
        <SourceImage condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</SourceImage>
        <SourceImage condition="excludes">C:\Windows\System32\DriverStore\FileRepository\</SourceImage>
        <SourceImage condition="excludes">C:\Windows\System32\igfxEM.exe</SourceImage>
        <SourceImage condition="excludes">C:\Windows\System32\igfxHK.exe</SourceImage>
        <SourceImage condition="excludes">Enterprise\Common7\IDE\devenv.exe</SourceImage>
        <TargetImage condition="excludes">C:\Program Files (x86)\ASUS\ROG Live Service\FileOperator.exe</TargetImage>
        <SourceImage condition="excludes all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=CreateFileMapping,Risk=70" groupRelation="and">
        <StartFunction condition="contains any">CreateFileMapping;MapViewOfFile</StartFunction>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=LdrLoadDll DLL Injection,Risk=70" groupRelation="and">
        <StartFunction condition="contains any">LdrLoadDll</StartFunction>
      </Rule>
      <Rule name="Attack=T1106,Technique=Native API,Tactic=Execution,DS=Process: Process Modification,Level=0,Desc=Crypt API Usage" groupRelation="and">
        <StartFunction condition="contains any">CryptAcquireContextA;CryptDecodeObjectEx;CryptImportPublicKeyInfo;CryptEncrypt;CryptGenKey;CryptDecrypt;CryptStringToBinary;CryptBinaryToString;CryptImportKey</StartFunction>
      </Rule>
      <Rule name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Modification,Level=0,Desc=Clipboard Usage Detected" groupRelation="and">
        <SourceImage condition="image">c:\windows\system32\csrss.exe</SourceImage>
        <StartFunction condition="contains">CrtlRoutine</StartFunction>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 1,Risk=100" groupRelation="and">
        <StartAddress condition="end with">0B80</StartAddress>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 2,Risk=100" groupRelation="and">
        <StartAddress condition="end with">0C7C</StartAddress>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 3,Risk=100" groupRelation="and">
        <StartAddress condition="end with">0C88</StartAddress>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Remote Desktop injection,Risk=30" groupRelation="and">
        <TargetImage condition="image">c:\windows\system32\mstsc.exe</TargetImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Modification,Alert=Potentially Detect EtwEventWrite Tampering with remote threads" groupRelation="and">
        <StartModule condition="is">C:\WINDOWS\SYSTEM32\ntdll.dll</StartModule>
        <StartFunction condition="contains">EtwEventWrite</StartFunction>
      </Rule>
    </CreateRemoteThread>
  </RuleGroup>
  <RuleGroup name="RG=CreateRemoteThread Exclude Group" groupRelation="or">
    <CreateRemoteThread onmatch="exclude">
      <!--COMMENT: Exclude mostly-safe sources and log anything else.-->
      <SourceImage condition="image">C:\Windows\SysWOW64\wbem\WmiPrvSE.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\audiodg.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\services.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\svchost.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\wbem\WmiPrvSE.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\wininit.exe</SourceImage>
      <SourceImage condition="image">C:\Windows\system32\winlogon.exe</SourceImage>
    </CreateRemoteThread>
  </RuleGroup>

  <!--SYSMON EVENT ID 9 : RAW DISK ACCESS [RawAccessRead]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, Device-->
    <!--COMMENT: Can cause high system load, disabled by default.-->
    <!--COMMENT: You may want to set this to a full capture on domain controllers, where no process should be doing raw reads.-->
  <RuleGroup name="RG=RawAccessRead Include Group" groupRelation="or">
    <RawAccessRead onmatch="include">
      <!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
    </RawAccessRead>
  </RuleGroup>

  <!--SYSMON EVENT ID 10 : INTER-PROCESS ACCESS [ProcessAccess]-->
    <!--DATA: RuleName, UtcTime, SourceProcessGuid, SourceProcessId, SourceThreadId, SourceImage, TargetProcessGuid, TargetProcessId, TargetImage, GrantedAccess, CallTrace-->
  <RuleGroup name="RG=ProcessAccess Include Group" groupRelation="or">
    <ProcessAccess onmatch="include">
      <!--Custom Rules-->
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CSShellExecute_ExecuteAssoc,Risk=30" groupRelation="and">
        <CallTrace condition="contains">C:\Windows\System32\SHELL32.dll+9b5bd</CallTrace>
        <TargetImage condition="excludes">\LocalBridge.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=WSHellExec,Risk=50" groupRelation="and">
        <CallTrace condition="contains any">C:\Windows\System32\wshom.ocx+c8a0;C:\Windows\System32\wshom.ocx+c39d</CallTrace>
      </Rule>
      <Rule name="Attack=T1047.005,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CWbemProviderGlueExecMethodAsync,Risk=50" groupRelation="and">
        <CallTrace condition="contains">C:\Windows\SYSTEM32\framedynos.dll+2cb3e</CallTrace>
        <TargetImage condition="excludes any">C:\Windows\system32\SgrmBroker.exe;C:\Windows\system32\SecurityHealthService.exe;C:\ProgramData\Microsoft\Windows Defender\platform\;C:\Windows\system32\services.exe;C:\Windows\system32\wininit.exe;C:\Windows\system32\sppsvc.exe;C:\Windows\System32\smss.exe;C:\Windows\system32\csrss.exe;C:\Windows\System32\svchost.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1047.005,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=ProviderExecMethod 1,Risk=60" groupRelation="and">
        <CallTrace condition="contains">C:\Windows\SYSTEM32\framedynos.dll+2b496</CallTrace>
      </Rule>
      <Rule name="Attack=T1003.001,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=MiniDumpWriteDump,Risk=50" groupRelation="and">
        <CallTrace condition="contains">C:\Windows\SYSTEM32\dbgcore.DLL+6cfb</CallTrace>
      </Rule>
      <Rule name="Attack=T1003.001,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=PssCaptureSnapShot,Risk=50" groupRelation="and">
        <CallTrace condition="contains">C:\Windows\System32\KernelBase.dll+de67e</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Dotnet Debugging detected,Risk=30" groupRelation="and">
        <CallTrace condition="contains">ntdll.dll+a0044</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Alert=DInvoke detected,Risk=100" groupRelation="and">
        <CallTrace condition="contains any">clr.dll+6c23;clr.dll+6b38</CallTrace>
      </Rule>
      <Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 1,Risk=30" groupRelation="and">
        <CallTrace condition="contains all">C:\Windows\\SYSTEM32\ntdll.dll+;|C:\Windows\System32\KERNELBASE.dll+;|UNKNOWN(</CallTrace>
        <CallTrace condition="end with">)</CallTrace>
      </Rule>
      <Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 2,Risk=30" groupRelation="and">
        <CallTrace condition="contains all">"UNKNOWN(;)|UNKNOWN(</CallTrace>
        <CallTrace condition="end with">)</CallTrace>
      </Rule>
      <Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 3,Risk=30" groupRelation="and">
        <CallTrace condition="contains all">"UNKNOWN</CallTrace>
        <GrantedAccess condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF</GrantedAccess>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Access,Level=0,Desc=Office Macro Injection Detected,Risk=100" groupRelation="and">
        <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
        <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        <TargetImage condition="excludes">C:\Program Files (x86)\Intuit\</TargetImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Credential Access,Risk=70" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x1FFFFF</GrantedAccess>
        <CallTrace condition="contains">UNKNOWN</CallTrace>
        <CallTrace condition="excludes">WmiPerfClass.dll</CallTrace>
        <SourceImage condition="excludes any">C:\Windows\sysWOW64\wbem\wmiprvse.exe;C:\Windows\system32\wbem\wmiprvse.exe;C:\Program Files\VMware\VMware Tools\vmtoolsd.exe;C:\Program Files (x86)\VMware\VMware Tools\vmtoolsd.exe;WmiPerfClass.dll;C:\Program Files (x86)\Adobe\Adobe Sync\CoreSync\customhook\CoreSyncCustomHook.exe;C:\Program Files\Adobe\Adobe Sync\CoreSync\customhook\CoreSyncCustomHook.exe;C:\Program Files (x86)\Common Files\Adobe</SourceImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=Mimikatz through Windows Remote Management,Risk=100" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <SourceImage condition="image">C:\Windows\system32\wsmprovhost.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS process access by LaZagne,Risk=100" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x1FFFFF</GrantedAccess>
        <CallTrace condition="contains all">python27.dll;_ctypes.pyd;KERNELBASE.dll;ntdll.dll</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS process access by Mimikatz,Risk=100" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <CallTrace condition="begin with">C:\Windows\SYSTEM32\ntdll.dll+4595c|C:\Windows\system32\KERNELBASE.dll+8185</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Cobalt Strike Monitor,Risk=70" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <CallTrace condition="begin with">C:\WINDOWS\SYSTEM32\ntdll.dll+</CallTrace>
        <CallTrace condition="end with">)</CallTrace>
        <CallTrace condition="contains all">|C:\WINDOWS\System32\KERNELBASE.dll+;|UNKNOWN(</CallTrace>
        <CallTrace condition="excludes any">wow64.dll;)|C;Exchange.Diagnostics;Microsoft.Exchange</CallTrace>
        <SourceImage condition="excludes any">C:\Program Files\Bitdefender\Endpoint Security\EPSecurityService.exe;c:\windows\system32\inetsrv\w3wp.exe;MSExchangeHMHost.exe;C:\Windows\sysWOW64\wbem\wmiprvse.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Rubeus Mimikatz Like Detection,Risk=70" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\winlogon.exe</TargetImage>
        <GrantedAccess>0x1F3FFF</GrantedAccess>
        <CallTrace condition="contains any">C:\Windows\Microsoft.NET;UNKNOWN</CallTrace>
        <SourceImage condition="excludes">C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe</SourceImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Suspicious Process Accessing Sysmon,Risk=50" groupRelation="and">
        <SourceImage condition="end with">.exe</SourceImage>
        <TargetImage condition="contains any">C:\Windows\sysmon64.exe;C:\Windows\sysmon64.exe</TargetImage>
        <GrantedAccess>0x1C00</GrantedAccess>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access,Risk=20" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x1F1FFF</GrantedAccess>
        <CallTrace condition="contains">UNKNOWN</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access 2,Risk=20" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x1010</GrantedAccess>
        <CallTrace condition="contains">UNKNOWN</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access 3,Risk=20" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x143A</GrantedAccess>
        <CallTrace condition="contains">UNKNOWN</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=LSASS Memory Dump,Risk=100" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <GrantedAccess>0x1fffff</GrantedAccess>
        <CallTrace condition="contains any">dbghelp.dll;dbgcore.dll</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=Process access with dbghelp,Risk=30" groupRelation="and">
        <CallTrace condition="contains any">dbghelp.dll;dbgcore.dll</CallTrace>
        <TargetImage condition="excludes">C:\Windows\system32\lsass.exe</TargetImage>
        <SourceImage condition="excludes">C:\wfx32\</SourceImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Powershell accessing another process memory" groupRelation="and">
        <SourceImage condition="image">powershell.exe</SourceImage>
        <TargetImage condition="excludes any">C:\Programdata\sysmon\sysmon64.exe;C:\Programdata\sysmon\sysmon.exe;C:\Windows\sysmon.exe;C:\Windows\sysmon64.exe;\dismhost.exe</TargetImage>
        <CallTrace condition="excludes all">C:\WINDOWS\SYSTEM32\ntdll.dll+;|C:\WINDOWS\System32\KERNELBASE.dll+;|C:\ProgramData\Microsoft\Windows Defender\Platform\;\MPCLIENT.DLL;\MpOav.dll+;|C:\WINDOWS\SYSTEM32\amsi.dll</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Potential Keylogger detected,Risk=100" groupRelation="and">
        <CallTrace condition="contains">getasynckeystate</CallTrace>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Access,Level=0,Desc=CMSTP UAC Bypass" groupRelation="and">
        <CallTrace condition="contains">cmlua.dll</CallTrace>
      </Rule>
      <Rule name="Attack=T1086,Technique=PowerShell,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Powershell without Powershell,Risk=30" groupRelation="and">
        <CallTrace condition="contains">System.Management.Automation</CallTrace>
        <CallTrace condition="excludes">C:\ProgramData\Microsoft\Windows Defender\platform\</CallTrace>
        <CallTrace condition="excludes">ctiuser.dll</CallTrace>
        <SourceImage condition="excludes">AutomationManager.ScriptRunner64.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files\Citrix\ConfigSync\ConfigSyncRun.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V14\bin\ExSetupUI.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V15\bin\ExSetupUI.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V16\bin\ExSetupUI.exe</SourceImage>
        <SourceImage condition="is not">C:\Windows\SysWOW64\sdiagnhost.exe</SourceImage>
        <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        <SourceImage condition="is not">C:\Windows\Temp\ExchangeSetup\ExSetupUI.exe</SourceImage>
        <SourceImage condition="is not">C:\system32\WindowsPowerShell\v1.0\PowerShell_ISE.exe</SourceImage>
        <TargetImage condition="is not">C:\Program Files\Microsoft Azure Active Directory Connect\AzureADConnect.exe</TargetImage>
        <TargetImage condition="is not">C:\Windows\system32\HOSTNAME.EXE</TargetImage>
        <TargetImage condition="is not">C:\Windows\system32\ROUTE.exe</TargetImage>
        <TargetImage condition="is not">C:\Windows\system32\query.exe</TargetImage>
        <TargetImage condition="is not">MsMpEng.exe</TargetImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=3,Alert=Kaodic credential access detected,Risk=100" groupRelation="and">
        <TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
        <CallTrace condition="contains">comsvcs.dll</CallTrace>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Office Macro Execution VBE7,Risk=80" groupRelation="and">
        <CallTrace condition="contains any">VBE7.dll;VBEUI.DLL;VBE7INTL.DLL</CallTrace>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Office Macro Execution VBE6,Risk=80" groupRelation="and">
        <CallTrace condition="contains any">VBE6.dll;VBEUI.DLL;VBE6INTL.DLL</CallTrace>
      </Rule>
      <Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=verclsid Office Execution,Risk=80" groupRelation="and">
        <SourceImage condition="contains">Office</SourceImage>
        <TargetImage condition="contains">verclsid.exe</TargetImage>
        <CallTrace condition="contains any">VBE7.dll;VBEUI.DLL;VBE7INTL.DLL</CallTrace>
        <CallTrace condition="contains any">|UNKNOWN(</CallTrace>
        <GrantedAccess condition="contains">0x1FFFFF</GrantedAccess>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CreateProcessW,Risk=70" groupRelation="and">
        <SourceImage condition="contains">C:\Program Files\Microsoft Office\Root\Office</SourceImage>
        <CallTrace condition="contains">C:\Windows\System32\KERNELBASE.dll+76516</CallTrace>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CSShellExecute_DoExecute,Risk=30" groupRelation="and">
        <CallTrace condition="contains" >C:\Windows\System32\SHELL32.dll+ae3b9</CallTrace>
        <TargetImage condition="excludes">C:\WINDOWS\system32\sihost.exe</TargetImage>
        <TargetImage condition="excludes">C:\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub</TargetImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=CobaltStrike BOF using OpenProcess/NtOpenProcess" groupRelation="and">
        <CallTrace condition="begin with">UNKNOWN</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=Typical ProcessAccess Pattern of CobaltStrike BOF" groupRelation="and">
        <CallTrace condition="contains">|UNKNOWN(</CallTrace>
        <CallTrace condition="begin with">C:\WINDOWS\SYSTEM32\ntdll.dll+</CallTrace>
        <CallTrace condition="contains">|C:\WINDOWS\System32\KERNELBASE.dll+</CallTrace>
        <CallTrace condition="end with">)</CallTrace>
        <CallTrace condition="excludes">C:\Program Files\SentinelOne\</CallTrace>
        <GrantedAccess condition="contains any">0x1028;0x1fffff</GrantedAccess>
        <SourceImage condition="excludes any">C:\Program Files\SmartGit\bin\;C:\Program Files (x86)\ASUS\Update\;C:\Program Files (x86)\Razer\Synapse3\Service\Razer Synapse Service.exe;C:\Program Files (x86)\Citrix\ICA Client\Receiver\UpdaterService.exe;C:\WINDOWS\SysWOW64\config\systemprofile\Citrix\UpdaterBinaries\;C:\Program Files\Mozilla Firefox\firefox.exe;C:\Program Files\SmartGit\git;\Intel\Driver and Support Assistant\DSAService.exe;C:\Program Files (x86)\N-able Technologies\AutomationManagerAgent\;C:\Program Files (x86)\MspPlatform\RequestHandlerAgent\RequestHandlerAgent.exe;C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe;C:\ProgramData\Cavelo\jre\bin\java.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe;C:\Program Files\Cavelo\Cavelo Agent\parser.exe</SourceImage>
        <SourceImage condition="excludes all">C:\Windows\Microsoft.NET\Framework\;\NGenTask.exe</SourceImage>
        <TargetImage condition="excludes any">\Intel\Driver and Support Assistant\</TargetImage>
        <TargetImage condition="excludes any">C:\Program Files\AMD\CNext\CNext\Radeonsoftware.exe;C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.UserSessionHelper.exe</TargetImage>
        <TargetImage condition="excludes all">C:\Windows\Microsoft.NET\Framework\;\ngen.exe</TargetImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=3,Alert=Potential MalDoc Behavior" groupRelation="and">
        <SourceImage condition="contains any">winword.exe;excel.exe;powerpnt.exe</SourceImage>
        <CallTrace condition="contains all">:\Windows\Microsoft.NET\Framework64\v2.;UNKNOWN</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=Potential Metasploit Process Migration" groupRelation="and">
        <CallTrace condition="contains">UNKNOWN</CallTrace>
        <GrantedAccess condition="contains">0x147a</GrantedAccess>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Access,Level=4,Alert=SysmonEnte Detection,DS=Process: Process Access,Level=4,Risk=100" groupRelation="and">
        <TargetImage condition="contains any">C:\Windows\Sysmon64.exe;C:\Windows\Sysmon.exe</TargetImage>
        <SourceImage condition="is not">C:\WINDOWS\system32\wbem\wmiprvse.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files (x86)\ASUS\Update\AsusUpdate.exe</SourceImage>
        <SourceImage condition="is not">C:\Program Files\Intel\SUR\QUEENCREEK\x64\esrv_svc.exe</SourceImage>
        <SourceImage condition="excludes any">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe;C:\Program Files (x86)\Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe;C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</SourceImage>
        <GrantedAccess condition="contains">0x1400</GrantedAccess>
        <CallTrace condition="excludes">C:\Program Files\SentinelOne\</CallTrace>
      </Rule>
      <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE: possible memory injection -->
      <Rule name="Attack=T1093,Technique=Process Hollowing,Tactic=Defense Evasion,DS=Process: Process Access,Level=4,Alert=Process Hollowing Detected,Risk=100" groupRelation="and">
        <GrantedAccess condition="is">0x0800</GrantedAccess>
      </Rule>
      <!-- PROCESS_SUSPEND_RESUME -->
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator" groupRelation="and">
        <GrantedAccess condition="is">0x0810</GrantedAccess>
      </Rule>
      <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ: possible memory dump to extract sensitive information -->
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Access,Level=0,Desc=Possible Memory Dump,Risk=70" groupRelation="and">
        <GrantedAccess condition="is">0x0820</GrantedAccess>
      </Rule>
      <!-- PROCESS_SUSPEND_RESUME -->
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=70" groupRelation="and">
        <GrantedAccess condition="is">0x810</GrantedAccess>
      </Rule>
      <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ: possible memory dump to extract sensitive information -->
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Modification,Risk=70" groupRelation="and">
        <GrantedAccess condition="is">0x820</GrantedAccess>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=CScript accessing another process memory,Risk=30" groupRelation="and">
        <SourceImage condition="end with">cscript.exe</SourceImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=WScript accessing another process memory,Risk=30" groupRelation="and">
        <SourceImage condition="end with">wscript.exe</SourceImage>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Java Script accessing another process memory,Risk=30" groupRelation="and">
        <SourceImage condition="end with">jjs.exe</SourceImage>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=100" groupRelation="and">
        <CallTrace condition="contains">dump</CallTrace>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=100" groupRelation="and">
        <CallTrace condition="contains">mimikatz</CallTrace>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=ProcessAccess with CorperfmontExt.dll,Risk=70" groupRelation="and">
        <CallTrace condition="contains">CorperfmontExt.dll</CallTrace>
      </Rule>
    </ProcessAccess>
  </RuleGroup>
  <RuleGroup name="RG=ProcessAccess Exclude Group" groupRelation="or">
    <ProcessAccess onmatch="exclude">
      <Rule name="wmi accessing lsass" groupRelation="and">
        <SourceImage condition="image">wmiprvse.exe</SourceImage>
        <TargetImage condition="image">lsass.exe</TargetImage>
      </Rule>
      <Rule name="lsass accessing winlogon" groupRelation="and">
        <SourceImage condition="image">lsass.exe</SourceImage>
        <TargetImage condition="image">winlogon.exe</TargetImage>
      </Rule>
      <!-- These binaries appear to access lsass legitimately -->
      <Rule name="legitimate lsass access" groupRelation="and">
        <TargetImage condition="image">lsass.exe</TargetImage>
        <SourceImage condition="excludes any">C:\Windows\system32\w32tm.exe;C:\Windows\System32\ping.exe;C:\Windows\System32\net.exe;C:\Windows\System32\net1.exe;C:\Windows\SYSTEM32\HOSTNAME.EXE;C:\Programdata\sysmon\sysmon.exe;C:\Programdata\sysmon\sysmon64.exe;C:\Program Files\Windows Defender\MsMpEng.exe;C:\Program Files (x86)\BeAnywhere Support Express\;C:\Program Files (x86)\CheckPoint\;C:\Program Files (x86)\Common Files\Intuit\QuickBooks\;C:\Program Files (x86)\Fortinet\;C:\Program Files (x86)\Trend Micro\;C:\Program Files\Adobe\Adobe Creative Cloud Experience\;C:\Program Files\CheckPoint\;C:\Program Files\Fortinet\;C:\Program Files\Realtek;C:\Program Files\Trend Micro\;C:\ProgramData\Microsoft\Windows Defender\platform\;C:\Program Files (x86)\Lenovo\;snmpd.exe;taskmgr;:\Windows\System32\smss.exe;:\Windows\system32\wininit.exe;\Bin\FMS.exe; <!-- Exchange Process -->\EMET_GUI.exe;\EMET_Service.exe;\Google\Update\GoogleUpdate.exe;\RAAGTAPP.EXE;\controls\cef\ConnectWise.exe;C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SavService.exe;C:\Program Files\Hewlett-Packard\AMS\service\hpqams.exe;C:\Program Files\Intel\SUR\WILLAMETTE\ESRV\esrv_svc.exe;C:\Program Files\VMware\VMware Tools\vmtoolsd.exe;C:\Program Files\Windows Defender\MsMpEng.exe;C:\WINDOWS\system32\WerFault.exe;C:\WINDOWS\system32\taskkill.exe;C:\Windows\SysWOW64\WerFault.exe;C:\Windows\System32\snmp.exe;C:\Windows\system32\msiexec.exe;C:\Windows\system32\spoolsv.exe;C:\Windows\system32\svchost.exe</SourceImage>
      </Rule>
      <!-- These binaries get or access processes running .NET -->
      <SourceImage condition="end with">:\Windows\system32\sppsvc.exe</SourceImage>
      <SourceImage condition="end with">:\Windows\system32\sdiagnhost.exe</SourceImage>
      <!-- In testing a common false-positive is memory space that DLLS would be expected to mapped to. -->
      <CallTrace condition="contains">UNKNOWN(00007F</CallTrace>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Direct System Call Events" groupRelation="and">
        <CallTrace condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
        <CallTrace condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
        <CallTrace condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>
      </Rule>
      <Rule name="Antivirus Exclusions" groupRelation="or">
        <SourceImage condition="begin with">C:\Program Files (x86)\Kaspersky Lab</SourceImage>
        <SourceImage condition="begin with">C:\Program Files\Kaspersky Lab</SourceImage>
        <SourceImage condition="begin with">C:\Program Files (x86)\ESET</SourceImage>
        <SourceImage condition="begin with">C:\Program Files\ESET</SourceImage>
        <SourceImage condition="begin with">C:\ProgramData\Microsoft\Windows Defender\</SourceImage>
      </Rule>
    </ProcessAccess>
  </RuleGroup>

  <!--SYSMON EVENT ID 11 : FILE CREATED [FileCreate]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime-->
    <!--NOTE:  Other filesystem "minifilters" can make it appear to Sysmon that some files are being written twice. This is not a Sysmon issue, per Mark Russinovich.-->
    <!--NOTE:  You may not see files detected by antivirus. Other filesystem minifilters, like antivirus, can act before Sysmon receives the alert a file was written.-->
  <RuleGroup name="RG=FileCreate Include Group" groupRelation="or">
    <FileCreate onmatch="include">
      <!--MITRE ATT&CK TACTIC: Reconnaissance-->
      <!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=File: File Creation,Level=4,Alert=Nessus Temp Files Created,Risk=100" groupRelation="and">
        <TargetFilename condition="contains">\TEMP\nessus_</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
      <!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
      <!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

      <!--MITRE ATT&CK TACTIC: Resource Development-->
      <!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

      <!--MITRE ATT&CK TACTIC: Initial Access-->
      <!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Solarwinds sunburst suspicious file writes,Risk=100" groupRelation="and">
        <Image condition="contains any">solarwinds.businesslayerhost</Image>
        <TargetFilename condition="contains any">.exe;.dll;.ps1;.mz;.jpg;.png</TargetFilename>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Solarwinds sunburst malware dll,Risk=100" groupRelation="and">
        <TargetFilename condition="is">C:\WINDOWS\SysWOW64\netsetupsvc.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Dark Halo Software location,Risk=100" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SoftwareDistribution</TargetFilename>
        <TargetFilename condition="not begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_Delta_Patch</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="excludes">C:\Windows\SoftwareDistribution\Download\Install\AM_Delta.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=0,Desc=MSBuild Source Files created" groupRelation="or">
        <TargetFilename condition="end with">proj</TargetFilename>
        <TargetFilename condition="end with">.targets</TargetFilename>
        <TargetFilename condition="end with">.build</TargetFilename>
        <TargetFilename condition="end with">.props</TargetFilename>
        <TargetFilename condition="end with">.tasks</TargetFilename>
        <TargetFilename condition="end with">.sln</TargetFilename>
        <TargetFilename condition="end with">.cs</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->

      <!--MITRE ATT&CK TACTIC: Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch File scripting: Batch scripts" groupRelation="and">
        <TargetFilename condition="end with">.bat</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy btm Extension" groupRelation="and">
        <TargetFilename condition="end with">.btm</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy cmd Extension" groupRelation="and">
        <TargetFilename condition="end with">.cmd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy com Extension" groupRelation="and">
        <TargetFilename condition="end with">.com</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=CMDLine File Created" groupRelation="and">
        <TargetFilename condition="end with">.cmdline</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch File Created" groupRelation="and">
        <TargetFilename condition="end with">.bas</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=BIN file created" groupRelation="and">
        <TargetFilename condition="end with">.bin</TargetFilename>
        <Image condition="excludes any">C:\Windows\System32\WUDFHost.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WMI Shell artifacts" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WMI Shell artifacts" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WS Scripting" groupRelation="and">
        <TargetFilename condition="end with">.ws</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSC Scripting" groupRelation="and">
        <TargetFilename condition="end with">.wsc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSF Scripting" groupRelation="and">
        <TargetFilename condition="end with">.wsf</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSH Scripting" groupRelation="and">
        <TargetFilename condition="end with">.wsh</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=PIF Scripting" groupRelation="and">
        <TargetFilename condition="end with">.pif</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: MSHTA-->
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=MSHTA Scripting" groupRelation="and">
        <TargetFilename condition="end with">.hta</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Python-->
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=IronPython,Risk=90" groupRelation="and">
        <TargetFilename condition="contains">IronPython</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" groupRelation="and">
        <TargetFilename condition="end with">.py</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" groupRelation="and">
        <TargetFilename condition="end with">.pyc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" groupRelation="and">
        <TargetFilename condition="end with">.pyd</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Powershell-->
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.cdxml</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.ps1</TargetFilename>
        <Image condition="excludes any">C:\Program Files (x86)\N-Able Technologies\AutomationManagerEngine\2.70.0.4\AutomationManager.ScriptRunner64.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.ps1xml</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.psc1</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.psd1</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.psm1</TargetFilename>
        <Image condition="excludes">AutomationManager.ScriptRunner64.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">.pssc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell Creating Files,Risk=10" groupRelation="and">
        <Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
        <TargetFilename condition="excludes">\Recent\CustomDestinations\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell directory modifications" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell directory modifications" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Persistence: PowerShell default profile" groupRelation="and">
        <TargetFilename condition="begin with">c:\Windows\System32\WindowsPowerShell\v1.0\profile</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Persistence: PowerShell default profile" groupRelation="and">
        <TargetFilename condition="begin with">c:\Windows\Syswow64\WindowsPowerShell\v1.0\profile</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\powershell.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell Console History" groupRelation="and">
        <TargetFilename condition="end with">PSReadLine\ConsoleHost_history.txt</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Javascript-->
      <Rule name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=vbs script created" groupRelation="and">
        <TargetFilename condition="end with">.vbs</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Java JRE Timestamp usage for DFIR" groupRelation="and">
        <TargetFilename condition="contains">.oracle_jre_usage\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=JavaScript" groupRelation="and">
        <TargetFilename condition="end with">.js</TargetFilename>
        <Image condition="excludes any">C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=JavaScript" groupRelation="and">
        <TargetFilename condition="end with">.jse</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" groupRelation="and">
        <TargetFilename condition="end with">.vb</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" groupRelation="and">
        <TargetFilename condition="end with">.vbe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" groupRelation="and">
        <TargetFilename condition="end with">.vbsript</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=CVE-2019-1315,Risk=70" groupRelation="and">
        <TargetFilename condition="end with">Report.wer.tmp</TargetFilename>
        <TargetFilename condition="excludes">\WER\</TargetFilename>
        <Image condition="image">C:\Windows\system32\wermgr.exe</Image>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Office App Creating Exe File,Risk=70" groupRelation="and">
        <Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Users</TargetFilename>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Office App Creating DLL File,Risk=70" groupRelation="and">
        <Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="begin with">C:\Users</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
      <!--MITRE ATT&CK TECHNIQUE: Native API-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: System Services-->
      <!--MITRE ATT&CK TECHNIQUE: User Execution-->
      <!--MITRE ATT&CK TECHNIQUE: User Execution: Malicious File-->
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Generic Ransomware Detection" groupRelation="and">
        <TargetFilename condition="contains any">!!!-WARNING-!!!.html;!!!-WARNING-!!!.txt;!!! HOW TO DECRYPT FILES !!!;!!!README!!!;!!!READ_TO_UNLOCK!!!.TXT;!!!_READ_ME_;!Recovery_;!Where_are_my_files!.html;!_HOW_TO_RESTORE_;!_RECOVERY_HELP_!.txt;!recover!;# DECRYPT MY FILES #.html;# DECRYPT MY FILES #.txt;# DECRYPT MY FILES #.vbs;# SATAN CRYPTOR #;+recover+;.8lock8;.31392E30362E32303136_;.ABCDEF;.CIop;.CR1;.CRAB;.CRYPTOSHIELD;.Cl0p;.Contact_Here_To_Recover_Your_Files.txt;.CryptoTorLocker2015!;.HERMES;.HakunaMatata;.How_To_Decrypt.txt;.How_To_Get_Back.txt;.KEYZ.KEYH0LES;.L0CKED;.LOL!;.MATRIX;.OMG!;.R.i.P;.RMCM1;.RSplited;.SUPERCRYPT;.SecureCrypted;.TheTrumpLocker;.VBRANSOM;.VforVendetta;.Where_my_files.txt;.XBTL;._AiraCropEncrypted!;.airacropencrypted!;.areyoulovemyrans;.berkshire;.bitpy;.bitx;.blocatto;.bomber;.braincrypt;.breakingbad;.breeding123;.cerber;.cifgksaffsfyghd;.country82000;.crypt;.crypted;.crypton;.cryptotorlocker;.decrypt2017;.deria;.dglnl;.disposed2017;.doomed;.encrypted.locked;.encrypted;.encryptedyourfiles;.enjey;.evillock;.filegofprencrp;.fileiscryptedhard;.firecrypt;.fuckyourdata;.gangbang;.gefickt;.googl;.happydayzz;.hceem;.helpdecrypt;.helpmeencedfiles;.hnumkhotep;.hydracrypt_ID;.iaufkakfhsaraf;.info.txt;.jimm;.kharma;.killedXXX;.lambda_l0cked;.letmetrydecfiles;.locked;.locker16;.loveransisgood;.lovewindows;.magic_software_syndicate;.mention9823;.moments2900;.myrandsext2017;.newlock;.no_more_ransom;.nochance;.noproblemwedecfiles;.notfoundrans;.ohwqg;.one-we_can-help_you;.oops;.osiris;.otherinformation;.paytounlock;.powerfulldecrypt;.powned;.pr0lock;.prolock;.prosperous666;.pwnd;.ransom;.readme2unlock;.righ;.roger;.ryk;.satan;.savethequeen;.sigaint.org;.skjdthghh;.skynet;.snatch;.stubbin;.supported2017;.suppose666;.theworldisyours;.txd0t;.warn_wallet;.weapologize;.weareyourfriends;.weencedufiles;.wowreadfordecryp;.wowwhereismyfiles;.wvtr0;.yourransom;.zzzzz ;.{CRYPTENDBLACKDC};-DECRYPT.txt;000-IF-YOU-WANT-DEC-FILES;000-No-PROBLEM-WE-DEC-FILES;000-PLEASE-READ-WE-HELP;001-READ-FOR-DECRYPT-FILES;1025-7152.exe;:\windows\update_collector.exe;=READ=THIS=PLEASE=;@cock.li;@countermail.com;@firemail.cc;@india.com;@mail.ru;@ukr.net;ASSISTANCE_IN_RECOVERY;ATTENTION!!!.txt;ATTENTION.url;Aescrypt.exe;AllFilesAreLocked;BTC_DECRYPT_FILES;BUYUNLOCKCODE.txt;BUYUNLOCKCODE;BitCryptorFileList.txt;C:\ProgramData\dtb.dat;C:\Programdata\WinMgr;C:\Programdata\clean.bat;C:\Programdata\run.bat;C:\Windows\svchost.exe;CEBER3;CHECK-IT-HELP-FILES;COME_RIPRISTINARE_I_FILE.;COMO_ABRIR_ARQUIVOS.txt;COMO_RESTAURAR_ARCHIVOS;Coin.Locker.txt;Comment débloquer mes fichiers.txt;Como descriptografar seus arquivos.txt;Corona-virus-Map;Corona.bat;Corona.sfx;CryptoRansomware;Crytp0l0cker;Cyber SpLiTTer Vbs.exe;Cyborg_DECRYPT;DALE_FILES.TXT;DECRYPT-FILES;DECRYPTION INSTRUCTIONS.;DECRYPTION_HOWTO.Notepad;DECRYPT_INFORMATION;DECRYPT_INSTRUCTION.HTML;DECRYPT_INSTRUCTION.URL;DECRYPT_INSTRUCTIONS.html;DECRYPT_INSTRUCTIONS;DECRYPT_ReadMe1.TXT;DECRYPT_Readme.TXT.ReadMe;DECRYPT_YOUR_FILES;DESIFROVANI_POKYNY.html;Decrypt All Files;DecryptAllFiles;DecryptFile;Decrypt_readme.txt;DesktopOsiris;ENTSCHLUSSELN_HINWEISE.html;EdgeLocker;FILESAREGONE.txt;FILES_BACK.txt;File Decrypt Help.html;GJENOPPRETTING_AV_FILER;GetYouFiles.txt;HAPPEN-ENCED-FILES;HELLOTHERE.TXT;HELP-ME-ENCED-FILES;HELPDECRYPT_YOUR_FILES.HTML;HELP_DECRYPT.HTML;HELP_DECRYPT.PNG;HELP_DECRYPT.URL;HELP_DECRYPT.lnk;HELP_ME_PLEASE.txt;HELP_RESTORE_FILES_;HELP_TO_SAVE_FILES.bmp;HELP_TO_SAVE_FILES;HELP_YOURFILES.HTML;HELP_YOUR_FILES.PNG;HELP_YOUR_FILES.html;HELP_YOUR_FILES;HOW-TO-DECRYPT-FILES.HTML;HOW-TO-RESTORE-FILES;HOW TO BACK YOUR FILES;HOW TO DECRYPT FILES.HTML;HOW TO DECRYPT FILES.txt;HOW TO RECOVER;HOWTO_RECOVER_FILES_;HOWTO_RESTORE_FILES;HOWTO_RESTORE_FILES_;HOW_DECRYPT.HTML;HOW_DECRYPT.TXT;HOW_DECRYPT.URL;HOW_OPEN_FILES;HOW_TO_DECRYPT.HTML;HOW_TO_DECRYPT_;HOW_TO_PAY_THE_RANSOM;HOW_TO_RESTORE_FILES.html;HOW_TO_RESTORE_FILES;HOW_TO_RESTORE_YOUR_DATA;HOW_TO_UNLOCK_FILES_README_;HWID Lock.exe;Hacked_Read_me_to_decrypt_files.html;Help Decrypt.html;How decrypt files.hta;How to decrypt LeChiffre files.html;How to decrypt your data.txt;HowDecrypt.gif;HowDecrypt.txt;How_to_decrypt_your_files.jpg;How_to_restore_files.hta;HowtoRestore_File;HowtoRestore_Files;Howto_RESTORE_FILES.html;Howto_Restore_FILES.TXT;IAMREADYTOPAY.TXT;IF-YOU-WANT-DEC-FILES;IF_WANT_FILES_BACK_PLS_READ.html;IHAVEYOURSECRET.KEY;IMPORTANT READ ME.txt;IMPORTANT.README;INSTALL_TOR.URL;INSTRUCCIONES;INSTRUCCIONES_DESCIFRADO.html;INSTRUCTION RESTORE FILE;INSTRUCTIONS_DE_DECRYPTAGE.html;INSTUCCIONES_DESCRIFRADO;ISTRUZIONI_DECRITTAZIONE.html;Important!.txt;Instructionaga.txt;KryptoLocker_README.txt;LEER_INMEDIATAMENTE;LET-ME-TRY-DEC-FILES;Locked-by-Mafia;MENSAGEM.txt;MERRY_I_LOVE_YOU_BRUCE.hta;No-PROBLEM-WE-DEC-FILES;OKSOWATHAPPENDTOYOURFILES.TXT;ONTSLEUTELINGS_INSTRUCTIES.html;OSIRIS-;PAYLOADBIN;PINGY@INDIA.COM;PLEASE-READ-WE-HELP.;PLEASE-READIT-IF_YOU-WANT.html;PLEASE-READIT-IF_YOU-WANT;PLEASE-README-AFFECTED-FILES;PLS-DEC-MY-FILES;PURELOCKER;Payment_Instructions.jpg;Please Read Me!!!;READ-FOR-DECCCC-FILESSS;READ-FOR-DECRYPT-FILES;READ-READ-READ;READ IF YOU WANT YOUR FILES BACK.html;READ ME FOR DECRYPT.txt;README HOW TO DECRYPT YOUR FILES.HTML;README!!!;README_DECRYPT_HYDRA_ID_;README_DECRYPT_HYRDA_ID_;README_DECRYPT_UMBRE_ID_;README_DONT_DELETE;README_HOW_TO_UNLOCK.HTML;README_HOW_TO_UNLOCK.TXT;README_RECOVER_FILES_;README_TO_RECURE_YOUR_FILES;READTHISNOW!!!.txt;READ_IT.txt;READ_ME_!.txt;READ_ME_TO_DECRYPT_YOU_INFORMA;READ_THIS_TO_DECRYPT.html;RECOVER-FILES;RECOVERY_FILE.;RECOVERY_FILES.TXT;RECOVER_MY_FILE;RESTORE_CORUPTED_FILES;RESTORE_FILES_;RETURN FILES.txt;RETURN YOUR FILES;RETURNFILES_.txt;RETURN_FILES.txt;RETURN_FILES_.txt;Rans0m_N0te_Read_ME;Read Me (How Decrypt) !!!!.txt;ReadDecryptFilesHere;Read_this_file.txt;Receipt.exe;RecoveryManual.html;Recovery_File_;Recovery_file_;Rooster865qq;SECRET.KEY;SECRETIDHERE.KEY;SHTODELATVAM.txt;SIFRE_COZME_TALIMATI.html;SORRY-FOR-FILES;Survey Locker.exe;TRY-READ-ME-TO-DEC;Temp\satan\satan;ThxForYurTyme;UNLOCK_FILES_INSTRUCTIONS.html;UNLOCK_FILES_INSTRUCTIONS.txt;UnblockFiles.vbs;VIP72.exe;Vape Launcher.exe;WANT_FILES_BACK;WE-MUST-DEC-FILES;WHERE-YOUR-FILES;WORMKILLER@INDIA.COM.XTBL;What happen to my files.txt;Whereisyourfiles;WindowsApplication1.exe;YOUGOTHACKED.TXT;YOUR_FILES.txt;YOUR_FILES.url;YOUR_FILES_ARE_DEAD;YOUR_FILES_ARE_ENCRYPTED.HTML;YOUR_FILES_ARE_ENCRYPTED.TXT;YOUR_FILES_ARE_LOCKED.txt;Your files are locked !!!!.txt;Your files are locked !!!.txt;Your files are locked !!.txt;Your files are locked !.txt;Your files encrypted by our friends !!! txt;Your files encrypted by our friends !!!.txt;[KASISKI];_Adatok_visszaallitasahoz_utasitasok;_DECRYPT_ASSISTANCE_;_DECRYPT_INFO_;_DECRYPT_INFO_szesnl;_DEC_FILES.;_FILES_WERE_ENCRYPTED_@.TXT;_HELP_HELP_HELP_;_HELP_Recover_Files_;_HELP_instructions.bmp;_HELP_instructions.txt;_HOWDO_text.bmp;_HOWDO_text.html;_HOW_TO_Decrypt;_H_e_l_p_RECOVER_INSTRUCTIONS+;_H_e_l_p_RECOVER_INSTRUCTIONS;_Locky_recover;_Locky_recover_instructions.bmp;_Locky_recover_instructions.txt;_README.hta;_README.jpg;_READ_ME!;_RECOVER_INSTRUCTIONS;_ReCoVeRy_+;_USE_TO_FIX_;_WHAT_is.html;_help_instruct;_how_recover.txt;_how_recover;_how_recover_;_recover_;_secret_code.txt;_steaveiwalker@india.com_;aeroware;confirmation.key;contains(to_string($message.file_created), "howrecover+;crjoker.html;cryptinfo.txt;cryptolocker.;cryptopp;de_crypt_readme.;de_crypt_readme.bmp;de_crypt_readme.html;de_crypt_readme.txt;decipher_ne;decrypt-instruct;decrypt explanations.;decrypt my file;decrypt your file;decrypt_Globe;decrypt_instruct;decrypted_files.dat;decryptional;decryptmyfiles;decypt_your_files.html;default32643264.bmp;default432643264.jpg;email-salazar_slytherin10;enc_files.txt;encryptor_raas_readme_liesmich;enigma.hta;enigma_encr.txt;exit.hhr.obleep;fattura_;file0locked;files_are_encrypted.;-filesencrypted;firemail.cc;firstransomware.exe;gmx.de;hacks.at.sigaint.org;help-file-decrypt.enc;help_decrypt;help_file_;help_instructions.;help_my_files;help_recover;help_recover_instructions;help_restore;help_restore_files;help_your_file;helpmeencedfiles;how to decrypt aes files.lnk;how to decrypt;how to get data.txt;how_decrypt.gif;how_recover;how_to_decrypt;how_to_recover;howrecover+ recoveryfile_;howrecover+;howto_recover_file;howto_restore;howtodecrypt;howtodecryptaesfiles.txt;inbox.ru;info@kraken.cc_worldcza@email.cz;install_tor;iran.ir;last_chance.txt;maestro@pizzacrypts.info;maxcrypt.bmp;only-we_can-help_you;openforyou@india.com;opensourcemail.org;padcrypt;paycrypt.bmp;popcorn_time.exe;powerfulldecrypt;protonmail.ch;qbmail.biz;randomname;readme_decrypt;readme_for_decrypt;readme_liesmich_encryptor_raas;recover_file;recover_file_;recover_instruction;recoverfile;recoverfile_;recovery+;recovery_file.txt;recovery_key.txt;recoveryfile;recover}-;restore_files.txt;restorefiles;restorefiles_;ryukreadme.html;tuta.io;tutanota.com;tutanota.de;unCrypte;vault.hta;vault.key;vault.txt;want your files back.;warning-!!;wie_zum_Wiederherstellen_von_Dateien.txt;wowreadfordecryp;wowwhereismyfiles;zXz.html;zycrypt.;zzzzzzzzzzzzzzzzzyyy</TargetFilename>
        <TargetFilename condition="excludes all">C:\Users\;\Google\Chrome Beta\User Data\;\IndexedDB\</TargetFilename>
        <TargetFilename condition="excludes any">C:\Program Files\WindowsApps\Microsoft.YourPhone_;C:\Program Files\dotnet\shared\Microsoft.NETCore.App\;\Microsoft.NET\assembly\GAC_MSIL</TargetFilename>
        <TargetFilename condition="excludes any">\System.Security.Cryptography</TargetFilename>
        <Image condition="excludes any">Microsoft.VisualStudio.Setup.Service\BackgroundDownload.exe</Image>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="contains">crackmapexec</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Crypto.Cipher._AES.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Crypto.Cipher._DES.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Crypto.Hash._SHA256.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Crypto.Random.OSRNG.winrandom.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Crypto.Util.strxor.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\crackmapexec.exe.manifest</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\greenlet.pyd</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=KeeFarce.exe default injected DLL name,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">BootStrapDLL.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=MegaCortex Ransomware,Risk=100" groupRelation="and">
        <TargetFilename condition="begin with">C:\windows\temp\wininit.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Mimikatz Files" groupRelation="and">
        <TargetFilename condition="contains any">lazycat;powerkatz;mimikatz;mimidrv;mimilove;mimilib;mimikittenz;mimiauth;invoke-mimi</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=RDP Wrapper,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">rdpwrap.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=winspool.drv dropped" groupRelation="and">
        <TargetFilename condition="end with">winspool.drv</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->
      <Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
      </Rule>
      <Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
      </Rule>
      <Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" groupRelation="and">
        <Image condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Persistence-->
      <!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <Rule name="Attack=T1547.001,Technique=Registry Startup Folder,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Autorun Folder Entries" groupRelation="and">
        <TargetFilename condition="contains">\Programs\Startup\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1547.001,Technique=Registry Startup Folder,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Autorun Folder Entries" groupRelation="and">
        <TargetFilename condition="contains">\Startup\</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
      <!--MITRE ATT&CK TECHNIQUE: Create Account-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" groupRelation="and">
        <TargetFilename condition="contains">\Word\STARTUP\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Templates\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" groupRelation="and">
        <TargetFilename condition="contains">\Excel\XLSTART\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="end with">.dotm</TargetFilename>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="end with">.XLSB</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Scheduled Task Modified" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Exchange 0day from September 2022 overwriting legit file,Risk=80" groupRelation="and">
        <TargetFilename condition="end with">RedirSuiteServiceProxy.aspx</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 1,Risk=80" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.aspx</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 2,Risk=80" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.asp</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 3,Risk=80" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.ashx</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Alert=Web Shells Dropped 4,Risk=80" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.php</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Alert=Web Shells Dropped 5,Risk=80" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.aaa</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 6,Risk=100" groupRelation="and">
        <TargetFilename condition="contains any">\wwwroot\aspnet_client\;\FrontEnd\HttpProxy\owa\auth</TargetFilename>
        <TargetFilename condition="contains any">.aspx;.php;.ashx</TargetFilename>
      </Rule>
      <Rule name="Attack=T1190,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=IIS Dropping Ps1 file,Risk=100" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.ps1</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping Bat file,Risk=100" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.bat</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping DLL file,Risk=100" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping VBS file,Risk=100" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.vbs</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping HTA file,Risk=100" groupRelation="and">
        <Image condition="image">w3wp.exe</Image>
        <TargetFilename condition="end with">.hta</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Files dropped in wwwroot directory,Risk=40" groupRelation="and">
        <TargetFilename condition="contains any">\wwwroot\</TargetFilename>
        <TargetFilename condition="excludes any">\wwwroot\aspnet_client\;jpg</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=ASP Files dropped outside wwwroot directory" groupRelation="and">
        <TargetFilename condition="end with">.asp</TargetFilename>
        <TargetFilename condition="excludes any">\wwwroot\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=ASPX Files dropped outside wwwroot directory" groupRelation="and">
        <TargetFilename condition="end with">.aspx</TargetFilename>
        <TargetFilename condition="excludes any">\wwwroot\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange ECP directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">\ecp\auth\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OAB directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">\oab\auth\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OWA directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">ClientAccess\Owa\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OWA directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">\owa\auth\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange RPC directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">httpproxy\rpc\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange ecp directory,Risk=80" groupRelation="and">
        <TargetFilename condition="contains">ClientAccess\ecp\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in wwwroot htdocs directory" groupRelation="and">
        <TargetFilename condition="contains">\htdocs\</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Privilege Escalation-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
      <Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=Printer Exploitation Detected,Risk=20" groupRelation="and">
        <TargetFilename condition="end with">.SPL</TargetFilename>
        <Image condition="excludes any">spoolsv.exe;printfilterpipelinesvc.exe;printisolationhost.exe;splwow64.exe;msiexec.exe;poqexec.exe</Image>
      </Rule>
      <Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=Printer Spooler Created exe file,Risk=40" groupRelation="and">
        <Image condition="image">spoolsv.exe</Image>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="excludes">C\:\Windows\System32\spool\;C\:\Windows\Temp\;C\:\Users\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=InstallerFileTakeOver,Risk=80,CVE=CVE-2021-41379" groupRelation="and">
        <Image condition="image">msiexec.exe</Image>
        <TargetFilename condition="contains">\Microsoft\Edge\Application</TargetFilename>
        <TargetFilename condition="end with">elevation_service.exe</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
      <!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WSL Locations" groupRelation="and">
        <TargetFilename condition="contains">\LocalState\rootfs\</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Masquerading-->
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="begin with">C:\PerfLogs\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="begin with">C:\Temp\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\Default\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\Public\</TargetFilename>
        <Image condition="excludes any">C:\Windows\System32\WUDFHost.exe</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Temp\</TargetFilename>
        <Image condition="not begin with">C:\Program Files\SentinelOne\</Image>
        <Image condition="excludes any">C:\Program Files\Cavelo\Cavelo Agent\osqueryi.exe;C:\Program Files\Cavelo\Cavelo Agent\parser.exe;C:\Program Files\Cavelo\Cavelo Agent\tesseract\tesseract.exe;AutomationManager.ScriptRunner64.exe</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="and">
        <TargetFilename condition="contains">\AppData\Temp\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Recycle bin files created" groupRelation="and">
        <TargetFilename condition="contains">$Recycle.Bin</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files Created from" groupRelation="and">
        <Image condition="contains">$Recycle.Bin</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Files Created within System Profile" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\</TargetFilename>
        <TargetFilename condition="contains">\config\systemprofile\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Files Created from System Profile executable" groupRelation="and">
        <Image condition="begin with">C:\Windows\</Image>
        <Image condition="contains">\config\systemprofile\</Image>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">      .exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.7z.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.doc.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.doc.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.docx.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.ico.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.iso.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.lnk.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.pdf.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.ppt.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.pptx.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.rar.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.rtf.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.txt.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.xls.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.xlsx.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">.zip.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="and">
        <TargetFilename condition="end with">______.exe</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
      <!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
      <!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
      <!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
      <!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
      <!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
      <!--MITRE ATT&CK TECHNIQUE: Rootkit-->
      <!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Compiled HTML File-->
      <Rule name="Attack=T1223,Technique=Compiled HTML File,Tactic=Defense Evasion,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="end with">.chm</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
      <!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Template Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
      <Rule name="Attack=T1127,Technique=Trusted Developer Utilities Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="end with">proj</TargetFilename>
      </Rule>
      <Rule name="Attack=T1127,Technique=Trusted Developer Utilities Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation" groupRelation="and">
        <TargetFilename condition="end with">.sln</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
      <!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

      <!--MITRE ATT&CK TACTIC: Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Brute Force-->
      <!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
      <!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
      <!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
      <!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->

      <!--MITRE ATT&CK TACTIC: Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
      <!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Query Registry-->
      <!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

      <!--MITRE ATT&CK TACTIC: Lateral Movement-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
      <Rule name="Attack=T1203,Technique=Exploitation of Remote Services,Tactic=Lateral Movement,DS=File: File Creation,Level=4,Alert=Exchange Exploitation UM Service File Creation,Risk=80,CVE=CVE-2021-26858" groupRelation="and">
        <Image condition="contains any">UMWorkerProcess.exe;UMService.exe</Image>
        <TargetFilename condition="contains any">.</TargetFilename>
        <TargetFilename condition="excludes any">.log;.cfg;.txt;cleanup;.HealthCheck;\wp.active;.db</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
      <!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

      <!--MITRE ATT&CK TACTIC: Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" groupRelation="and">
        <TargetFilename condition="end with">.7z</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" groupRelation="and">
        <TargetFilename condition="end with">.7zip</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" groupRelation="and">
        <TargetFilename condition="end with">.arj</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" groupRelation="and">
        <TargetFilename condition="end with">.s7z</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=.A Archive" groupRelation="and">
        <TargetFilename condition="end with">.a</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ACE Archive" groupRelation="and">
        <TargetFilename condition="end with">.ace</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=AR Archive" groupRelation="and">
        <TargetFilename condition="end with">.ar</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ARC Archive" groupRelation="and">
        <TargetFilename condition="end with">.arc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=BIN" groupRelation="and">
        <TargetFilename condition="end with">.bin</TargetFilename>
        <Image condition="excludes any">C:\Windows\System32\WUDFHost.exe</Image>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=CAB Archive" groupRelation="and">
        <TargetFilename condition="end with">.cab</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Game PAK Archive" groupRelation="and">
        <TargetFilename condition="end with">.pak</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Gzip Archive" groupRelation="and">
        <TargetFilename condition="end with">.gz</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=IMG Archive" groupRelation="and">
        <TargetFilename condition="end with">.img</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ISO Archive" groupRelation="and">
        <TargetFilename condition="end with">.iso</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=LZM Archive" groupRelation="and">
        <TargetFilename condition="end with">.lzm</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=LZMA Archive" groupRelation="and">
        <TargetFilename condition="end with">.lzma</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RAR Archive Extraction" groupRelation="and">
        <TargetFilename condition="contains">Temp\Rar$</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=RAR Archive" groupRelation="and">
        <TargetFilename condition="end with">.rar</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RAR SFX Archive Extraction" groupRelation="and">
        <TargetFilename condition="contains">RarSFX</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=SFX Archive" groupRelation="and">
        <TargetFilename condition="end with">.sfx</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=SZ Archive" groupRelation="and">
        <TargetFilename condition="end with">.sz</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR Archive" groupRelation="and">
        <TargetFilename condition="end with">.tar</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR.GZ Archive" groupRelation="and">
        <TargetFilename condition="end with">.tar.gz</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR.GZ Archive" groupRelation="and">
        <TargetFilename condition="end with">.tgz</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=XZ Archive" groupRelation="and">
        <TargetFilename condition="end with">.xz</TargetFilename>
      </Rule>
      <Rule name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ZIP Archive" groupRelation="and">
        <TargetFilename condition="end with">.zip</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Staged-->
      <!--MITRE ATT&CK TECHNIQUE: Email Collection-->
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .OST Created,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.ost</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.eml</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.msg</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.pst</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Video Capture-->

      <!--MITRE ATT&CK TACTIC: Command and Control-->
      <!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
      <Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=File: File Creation,Level=4,Alert=Cyrillic Letter obfuscation,Risk=100" groupRelation="and">
        <TargetFilename condition="contains any">Г;И;К;П;д;и;к;л;л;н;н;о;ф;ե;թ;յ;ն;ն;ն;ն;տ;ւ;ք</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
      <!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
      <!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Created by Teamviewer" groupRelation="and">
        <Image condition="image">Teamviewer.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Created by rundll32" groupRelation="and">
        <Image condition="image">rundll32.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Created with Remote Desktop Client" groupRelation="and">
        <Image condition="image">mstsc.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Created with command shell,Risk=30" groupRelation="and">
        <Image condition="image">cmd.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped with IronPython.exe,Risk=50" groupRelation="and">
        <Image condition="image">ipy.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped with WScript.exe,Risk=30" groupRelation="and">
        <Image condition="image">WScript.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with cscript.exe,Risk=30" groupRelation="and">
        <Image condition="image">cscript.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with mshta.exe,Risk=100" groupRelation="and">
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with python.exe,Risk=30" groupRelation="and">
        <Image condition="image">python.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with wmic.exe,Risk=30" groupRelation="and">
        <Image condition="image">wmic.exe</Image>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
        <TargetFilename condition="contains any">C:\Users\Default\;C:\Users\Public\</TargetFilename>
        <TargetFilename condition="end with">.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
        <TargetFilename condition="contains any">C:\Users\Default\;C:\Users\Public\</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
      <!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy: Multi-hop Proxy-->
      <Rule name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Hidden Service,Risk=100" groupRelation="and">
        <TargetFilename condition="contains">HiddenService</TargetFilename>
      </Rule>
      <Rule name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">torrc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" groupRelation="and">
        <TargetFilename condition="contains">\tor.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" groupRelation="and">
        <TargetFilename condition="contains">tor-gencert</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Web Service-->

      <!--MITRE ATT&CK TACTIC: Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Possible rclone Exfiltration,Risk=30" groupRelation="and">
        <TargetFilename condition="contains">rclone</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Possible s3browser Exfiltration,Risk=30" groupRelation="and">
        <TargetFilename condition="contains">s3browser</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Browser Credential exfiltration,Risk=30" groupRelation="and">
        <TargetFilename condition="contains">grabff.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Browser Credential exfiltration,Risk=30" groupRelation="and">
        <TargetFilename condition="contains">grabff.exe</TargetFilename>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Impact-->
      <!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
      <!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Snatch Ransomware Detected,Risk=100" groupRelation="and">
        <TargetFilename condition="contains all">RESTORE_;_FILES.txt</TargetFilename>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Snatch2 Ransomware Detected,Risk=100" groupRelation="and">
        <TargetFilename condition="contains all">DECRYPT_;_FILES.txt</TargetFilename>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Nanocore Detected,Risk=100" groupRelation="and">
        <TargetFilename condition="contains any">\run.dat;\task.dat;\storage.dat</TargetFilename>
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="excludes any">Symantec</TargetFilename>
        <TargetFilename condition="excludes any">BlueJeans</TargetFilename>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=RagnarLocker Virtualbox files: susceptible to FP,Risk=40" groupRelation="and">
        <TargetFilename condition="contains any">VBoxRT.dll;VboxC.dll</TargetFilename>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Defacement-->
      <!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
      <!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
      <!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Service Stop-->
      <!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
      <!--UEBA Detections-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Suspicious files within Content.IE5,Risk=40" groupRelation="and">
        <TargetFilename condition="contains any">Content.IE5;INetCache</TargetFilename>
        <TargetFilename condition="contains any">.exe;.zip;.ps1;.bat;.rar;.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Unusual OLE ActiveX execution from Microsoft Office,Risk=20" groupRelation="and">
        <TargetFilename condition="contains any">MSForms.exd</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected in System32" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\windows\system32\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected in Windows Directory" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\windows\</TargetFilename>
        <TargetFilename condition="excludes">\system32\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected Outside Windows Directory" groupRelation="and">
        <TargetFilename condition="contains any">.dll;.exe</TargetFilename>
        <TargetFilename condition="excludes">C:\windows\</TargetFilename>
        <TargetFilename condition="excludes">C:\Users\</TargetFilename>
        <TargetFilename condition="excludes">C:\Program Files\WindowsApps\</TargetFilename>
        <TargetFilename condition="excludes">C:\$WinREAgent\Scratch\Mount\Windows\WinSxS\</TargetFilename>
        <Image condition="excludes any">C:\Program Files (x86)\MspPlatform\FileCacheServiceAgent\FileCacheServiceAgent.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected Inside User Directory" groupRelation="and">
        <TargetFilename condition="contains any">.dll;.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Users\</TargetFilename>
        <Image condition="excludes">C:\Users\*\AppData\Local\Microsoft\Teams\Update.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WLL Office Application Startup" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Word\Startup\</TargetFilename>
        <TargetFilename condition="end with">.wll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc= Windows Defender Application Control changes" groupRelation="and">
        <TargetFilename condition="begin with">C:\windows\system32\CodeIntegrity\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=XLL Office Application Startup" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Excel\Startup\</TargetFilename>
        <TargetFilename condition="end with">.xll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook Macro Execution,Risk=90" groupRelation="and">
        <TargetFilename condition="end with">\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office Application Startup Generic" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Addins\</TargetFilename>
        <TargetFilename condition="contains any">.xla</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office VSTO Addin detected,Risk=20" groupRelation="and">
        <TargetFilename condition="end with">.vsto</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New bat file dropped to C:\Windows\,Risk=70" groupRelation="and">
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\</TargetFilename>
        <Image condition="excludes any">C:\ProgramData\Lenovo\SystemUpdate\sessionSE\</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New dll file dropped to C:\Windows\" groupRelation="and">
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Driver sys file dropped to C:\Windows\" groupRelation="and">
        <TargetFilename condition="end with">.sys</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\</TargetFilename>
        <TargetFilename condition="excludes any">C:\Windows\System32\;C:\windows\syswow64\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\System32" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\System32" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWow64\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New theme: Credential harvesting" groupRelation="and">
        <TargetFilename condition="end with">.theme</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Interesting files: Microsoft Office Isolated Conversion Environment" groupRelation="and">
        <TargetFilename condition="contains">\Packages\oice_</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Virtualbox VM Escape" groupRelation="and">
        <Image condition="image">VirtualboxVM.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files edited with Notepad Plus Plus" groupRelation="and">
        <Image condition="is">notepad++.exe</Image>
      </Rule>
      <Rule name="Attack=T1023,Technique=Shortcut Modification,Tactic=Persistence,DS=File: File Creation,Level=4,Alert=Potential LNK Malware File Downloaded" groupRelation="and">
        <TargetFilename condition="end with">.lnk:Zone.Identifier</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\msiexec.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" groupRelation="and">
        <TargetFilename condition="end with">\regsvr32.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Winrm Host Process" groupRelation="and">
        <TargetFilename condition="end with">\UsageLogs\wsmprovhost.exe.log</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Link" groupRelation="and">
        <TargetFilename condition="end with">.lnk</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=URL" groupRelation="and">
        <TargetFilename condition="end with">.url</TargetFilename>
      </Rule>
      <!--Drivers dropped-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver" groupRelation="and">
        <TargetFilename condition="end with">.sys</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver INF" groupRelation="and">
        <TargetFilename condition="end with">.inf</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" groupRelation="and">
        <TargetFilename condition="contains">\Drivers\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" groupRelation="and">
        <TargetFilename condition="end with">.drv</TargetFilename>
      </Rule>
      <!--Microsoft Office File Monitoring-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.xlam</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.xlsm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xla</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xls</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xlsb</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xlsx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xlt</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xltm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" groupRelation="and">
        <TargetFilename condition="end with">.xlw</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office Template created" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Templates\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook EML" groupRelation="and">
        <TargetFilename condition="end with">.eml</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook MSG" groupRelation="and">
        <TargetFilename condition="end with">.msg</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.potm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.pptm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint OpenXML Filetype" groupRelation="and">
        <TargetFilename condition="end with">.sldm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Recent Office Files" groupRelation="and">
        <TargetFilename condition="contains">\Microsoft\Office\Recent</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Forensic=Recent Office History" groupRelation="and">
        <TargetFilename condition="contains">oleObject</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Forensic=Recent Jumplist Custom Destinations" groupRelation="and">
        <TargetFilename condition="contains">\Recent\CustomDestinations\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=User Downloaded Files" groupRelation="and">
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=User Outlook Attachments" groupRelation="and">
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.docb</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Macro,Risk=30" groupRelation="and">
        <TargetFilename condition="end with">.wbk</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Perfect" groupRelation="and">
        <TargetFilename condition="end with">.ped</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Template" groupRelation="and">
        <TargetFilename condition="end with">.dot</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Template" groupRelation="and">
        <TargetFilename condition="end with">.dotx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" groupRelation="and">
        <TargetFilename condition="end with">.doc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" groupRelation="and">
        <TargetFilename condition="end with">.docm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" groupRelation="and">
        <TargetFilename condition="end with">.docx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.accdb</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.accde</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.accdr</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.accdt</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.mdb</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.mde</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.msc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.mst</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.potx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.ppam</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.ppsm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.ppsx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.ppt</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.pptm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.pptx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.pub</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.sldm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.sldx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.xls</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="and">
        <TargetFilename condition="end with">.xps</TargetFilename>
      </Rule>
      <!--SECTION: Certificates -->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.pem</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.crt</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.ca-bundle</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.cer</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.csr</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.der</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.p7b</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.p7r</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.p7s</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.pfx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.sto</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.p12</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.crl</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.sst</TargetFilename>
        <Image condition="excludes">SentinelAgent.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="and">
        <TargetFilename condition="end with">.key</TargetFilename>
      </Rule>
      <!--SECTION: Sideloading-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">.hlp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">ACLUI.DLL.UI</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">ACLUI.DLL</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">AFLogVw.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">AShld.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">AShldRes.DLL.asr</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">AShldRes.DLL</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">AhnI2.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">CamMute.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">CommFunc.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">CommFunc.jax</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">DESqmWrapper.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">DESqmWrapper.wrapper</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">FSPMAPI.dll.fsp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">FSPMAPI.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Gadget.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">LoLTWLauncher.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Mc.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">McUtil.dll.ping</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">McUtil.dll.url</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">McUtil.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">MpSvc.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">MsMpEng.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NvSmart.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">NvSmartMaxapp.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">OInfo11.ISO</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">OInfo11.ocx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">OInfoP11.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">OleView.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">OleView.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">POETWLauncher.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">RasTls.dll.config</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">RasTls.dll.msc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">RasTls.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">RasTls.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">RunHelp.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Sidebar.dll.doc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Sidebar.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Ushata.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Ushata.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">Ushata.fox</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">VeetlePlayer.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">boot.ldr</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">chrome_frame_helper.dll.rom</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">chrome_frame_helper.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">chrome_frame_helper.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">dvcemumanager.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">fsguidll.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">fslapi.dll.gui</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">fslapi.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">fsstm.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hccutils.dll.res</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hccutils.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hha.dll.bak</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hha.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hhc.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">hkcmd.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">iviewers.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">jli.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">libvlc.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mPclient.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcf.ep</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcf.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcupdui.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcut.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcutil.dll.bbc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mcvsmap.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">msi.dll.dat</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">msi.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">msseces.asm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">msseces.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">mtcReport.ktc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">rc.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">rc.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">rc.hlp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">sep_NE.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">sep_NE.slf</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">tplcdclr.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">winmm.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">wts.chm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">credwiz.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Op cell phone: https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers" groupRelation="and">
        <TargetFilename condition="end with">ssMUIDLL.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">aepic.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">ftllib.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" groupRelation="and">
        <TargetFilename condition="end with">userenv.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP Bitmap Cache" groupRelation="and">
        <TargetFilename condition="contains">\Terminal Server Client\Cache\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=File: File Creation,Forensic=Windows Prefetch Exec History" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Prefetch</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Suspicious TSClient share file creation,Risk=30" groupRelation="and">
        <TargetFilename condition="begin with">\\tsclient</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WebDav Cache Files Created" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\ServiceProfiles\LocalService\AppData\Local\Temp\TfsStore\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=File: File Creation,Level=4,Alert=SharpDump bin,Risk=100" groupRelation="and">
        <TargetFilename condition="end with">\Temp\debug.bin</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=7zip Archive Extraction" groupRelation="and">
        <TargetFilename condition="contains">Temp\7z</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Appcompat Shims" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\AppPatch\Custom</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CHM Filetype" groupRelation="and">
        <TargetFilename condition="end with">.chm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CIA Vault7: Control Panel Files https://wikileaks.org/ciav7p1/cms/page_16384212.html" groupRelation="and">
        <TargetFilename condition="end with">.cpl</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CIA Vault7: https://wikileaks.org/ciav7p1/cms/page_16384212.html" groupRelation="and">
        <TargetFilename condition="contains">.mht</TargetFilename>
      </Rule>
      <Rule name="Attack=T1176,Technique=Browser Extensions,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Chrome Extensions" groupRelation="and">
        <TargetFilename condition="contains">\Chrome\User Data\Default\Extensions\</TargetFilename>
      </Rule>
      <Rule name="Attack=T1176,Technique=Browser Extensions,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Chrome extension auditing" groupRelation="and">
        <TargetFilename condition="end with">.crx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=ClickOnce extension" groupRelation="and">
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Desktop Gadget File" groupRelation="and">
        <TargetFilename condition="end with">.gadget</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Encrypted JScript File type" groupRelation="and">
        <TargetFilename condition="end with">.JSE</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Executable file" groupRelation="and">
        <TargetFilename condition="end with">.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Explorer Command" groupRelation="and">
        <TargetFilename condition="end with">.scf</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped to Exchange OWA: Webshell,Risk=70" groupRelation="and">
        <TargetFilename condition="contains">Exchange Server\ClientAccess\Owa\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped to shadow copy" groupRelation="and">
        <TargetFilename condition="begin with">\Device\HarddiskVolumeShadowCopy</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File created/accessed from Zip File" groupRelation="and">
        <TargetFilename condition="contains">.zip\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Font File Type" groupRelation="and">
        <TargetFilename condition="end with">.FON</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Font File Type" groupRelation="and">
        <TargetFilename condition="end with">.FOT</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Group Policy Script File Dropped" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Group Policy Script File Dropped" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=IQY file used to pull down dropper" groupRelation="and">
        <TargetFilename condition="end with">.iqy</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Icon" groupRelation="and">
        <TargetFilename condition="end with">.ico</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Internet settings" groupRelation="and">
        <TargetFilename condition="end with">.isp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=MMC Snapin" groupRelation="and">
        <TargetFilename condition="end with">.msc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Manifest File Crated" groupRelation="and">
        <TargetFilename condition="end with">.manifest</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Memory dump" groupRelation="and">
        <TargetFilename condition="end with">MEMORY.dmp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft Installer" groupRelation="and">
        <TargetFilename condition="end with">.msi</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft:dotNet: Executed by cvtres.exe" groupRelation="and">
        <TargetFilename condition="end with">.cs</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft:dotNet: Executed by cvtres.exe" groupRelation="and">
        <TargetFilename condition="end with">.customDestinations-ms</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Minidump Crash dump created" groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Minidump</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=PAF" groupRelation="and">
        <TargetFilename condition="end with">.PAF</TargetFilename>
      </Rule>
      <Rule name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP Bitmap Cache" groupRelation="and">
        <TargetFilename condition="end with">.bmc</TargetFilename>
      </Rule>
      <Rule name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP" groupRelation="and">
        <TargetFilename condition="end with">.rdp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RTF files often 0day malware vectors when opened by Office,Risk=20" groupRelation="and">
        <TargetFilename condition="end with">.rtf</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Registry file" groupRelation="and">
        <TargetFilename condition="end with">.reg</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SHS Office File for copy pastes" groupRelation="and">
        <TargetFilename condition="end with">.SHS</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SLK file used for command execution" groupRelation="and">
        <TargetFilename condition="end with">.slk</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Screensaver" groupRelation="and">
        <TargetFilename condition="end with">.SCR</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Set" groupRelation="and">
        <TargetFilename condition="end with">.set</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SettingContent-ms" groupRelation="and">
        <TargetFilename condition="end with">.SettingContent-ms</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Spooled Print Job" groupRelation="and">
        <TargetFilename condition="end with">.SHD</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Spooled Print Job" groupRelation="and">
        <TargetFilename condition="end with">.SPL</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Screensaver file created" groupRelation="and">
        <TargetFilename condition="end with">.scr</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Vault7 file" groupRelation="and">
        <TargetFilename condition="end with">HammerDrillStatus.dll</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Error Dumps" groupRelation="and">
        <TargetFilename condition="contains">Microsoft\Windows\WER\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Icon" groupRelation="and">
        <TargetFilename condition="end with">.ICL</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Registry Database" groupRelation="and">
        <TargetFilename condition="end with">.sdb</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Script File Component File" groupRelation="and">
        <TargetFilename condition="end with">.SCT</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Shell Scrap Object Handler File" groupRelation="and">
        <TargetFilename condition="end with">.SHB</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Zip File Extraction from explorer" groupRelation="and">
        <TargetFilename condition="contains">Temp\Temp1_</TargetFilename>
      </Rule>
      <!--Uncategorized-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=DotNet UsageLogs" groupRelation="and">
        <TargetFilename condition="contains all">\Microsoft\;CLR_v;\UsageLogs\</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.ade</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.adp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.application</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.asc</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.bmf</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.cer</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.dmp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.gpg</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.htm</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.html</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.json</TargetFilename>
        <Image condition="excludes any">SentinelRanger.exe;C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.jsp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.key</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.mof</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.ocx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.p7b</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.p12</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.pem</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.pfx</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.pgp</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.php</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.ppk</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.war</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Extension Monitoring" groupRelation="and">
        <TargetFilename condition="end with">.xml</TargetFilename>
        <Image condition="excludes any">C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\NableUpdateService.exe;C:\Program Files (x86)\N-able Technologies\Reactive\bin\NableReactiveManagement.exe;C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe;C:\Program Files (x86)\MspPlatform\FileCacheServiceAgent\FileCacheServiceAgent.exe;AutomationManager.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe;C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.exe</Image>
      </Rule>
    </FileCreate>
  </RuleGroup>
  <!--SYSMON EVENT ID 12 & 13 & 14 : REGISTRY MODIFICATION [RegistryEvent]-->
    <!--EVENT 12: "Registry object added or deleted"-->
      <!--DATA: RuleName, UtcTime, EventType, ProcessGuid, ProcessId, Image, TargetObject, User-->
    <!--EVENT 13: "Registry value set"-->
      <!--DATA: RuleName, UtcTime, EventType, ProcessGuid, ProcessId, Image, TargetObject, Details, User-->
    <!--EVENT 14: "Registry objected renamed"-->
      <!--DATA: RuleName, UtcTime, EventType, ProcessGuid, ProcessId, Image, TargetObject, NetName, User-->
    <!--NOTE: Windows writes hundreds or thousands of registry keys a minute, so just because you're not changing things, doesn't mean these rules aren't being run.-->
    <!--NOTE: You do not have to spend a lot of time worrying about performance, CPUs are fast, but it's something to consider. Every rule and condition type has a small cost.-->
    <!--NOTE: "contains" works by finding the first letter, then matching the second, etc, so the first letters should be as low-occurrence as possible.-->
    <!--TECHNICAL: Possible prefixes are HKLM, HKCR, and HKU-->
    <!--CRITICAL: Schema version 3.30 and higher change HKLM\="\REGISTRY\MACHINE\" and HKU\="\REGISTRY\USER\" and HKCR\="\REGISTRY\MACHINE\SOFTWARE\Classes\" and CurrentControlSet="ControlSet001"-->
    <!--NOTE: Because Sysmon runs as a service, it has no filtering ability for, or concept of, HKCU or HKEY_CURRENT_USER. Use "contains" or "end with" to get around this limitation-->
    <!--CRITICAL NOTE: It may appear this section is MISSING important entries, but SOME RULES MONITOR MANY KEYS, so look VERY CAREFULLY to see if something is already covered.-->
    <!--               Sysmon's wildcard monitoring along with highly-tuned generic strings cuts the rulesets down immensely, compared to doing this in other tools.-->
    <!--               For example, most COM hijacking in CLSID's across the registry is covered by a single rule monitoring a InProcServer32 wildcard-->
  <RuleGroup name="RG=RegistryEvent Include Group" groupRelation="or">
    <RegistryEvent onmatch="include">
      <!--MITRE ATT&CK TACTIC: Reconnaissance-->
      <!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=indows Registry: Windows Registry Key Modification,Level=4,Alert=Advanced IP Scanner Scan Detected" groupRelation="and">
        <TargetObject condition="contains">Software\Famatech\advanced_ip_scanner\State</TargetObject>
        <TargetObject condition="end with">LastRangeUsed</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
      <!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
      <!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
      <!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
      <!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
      <!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

      <!--MITRE ATT&CK TACTIC: Resource Development-->
      <!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
      <!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

      <!--MITRE ATT&CK TACTIC: Initial Access-->
      <!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=RDP Connection History Tracking" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Terminal Server Client</TargetObject>
        <TargetObject condition="excludes">DefaultPrinter</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Keyloggers and new Keyboards" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96b-e325-11ce-bfc1-08002be10318}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect USB Input Devices" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{745a17a0-74d3-11d0-b6fe-00a0c90f57da}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Mice" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96f-e325-11ce-bfc1-08002be10318}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Composite Device" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{36fc9e60-c465-11cf-8056-444553540000}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Bluetooth Device" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{e0cbf06c-cd8b-4647-bb8a-263b43f0f974}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Disk Drive" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e967-e325-11ce-bfc1-08002be10318}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New WPD Devices" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{eec5ad98-8080-425f-922a-dabf3de3f69a}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Biometric Devices" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{53D29EF7-377C-4D14-864B-EB3A85769359}</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=Virtual DVD-ROM Drive Mounted,Forensic=Virtual DVD-ROM Drive Mounted" groupRelation="and">
        <TargetObject condition="contains all">Root\InventoryDevicePnp;prod_virtual_dvd-rom</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Mounted Device Detection" groupRelation="and">
        <TargetObject condition="contains">MountedDevices</TargetObject>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Mountpoints2 Mounted Device Detection" groupRelation="and">
        <TargetObject condition="contains">Mountpoints2</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Active Setup Installed Components" groupRelation="and">
        <TargetObject condition="contains">Active Setup\Installed Components</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Phishing-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Interactive Logon Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\SessionData\</TargetObject>
        <TargetObject condition="end with">LoggedOnUser</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Logged on User modification" groupRelation="and">
        <TargetObject condition="contains">LastLoggedOnUser</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Logged on Provider modification" groupRelation="and">
        <TargetObject condition="contains">LastLoggedOnProvider</TargetObject>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
      <!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Suspicious Set Value of MSDT in Registry: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <TargetObject condition="begin with">HKCR\ms-msdt\</TargetObject>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Scripted Diagnostics Turn Off Check Enabled: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnostics\TurnOffCheck</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
      <!--MITRE ATT&CK TECHNIQUE: Native API-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: System Services-->
      <Rule name="Attack=T1543.003,Tactic=Persistence,Technique=Create Windows Service,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=New SVCHost service,Risk=70" groupRelation="and">
        <TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost</TargetObject>
        <TargetObject condition="excludes">\print\</TargetObject>
        <TargetObject condition="excludes">\AzureAttestService\CoInitializeSecurityParam</TargetObject>
        <Image condition="excludes">C:\$WINDOWS.~BT\</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: User Execution-->
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project Object Model Macro Settings,Risk=30" groupRelation="and">
        <TargetObject condition="end with">\AccessVBOM</TargetObject>
        <Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project VBA Warnings Macro Setting Change,Risk=40" groupRelation="and">
        <TargetObject condition="end with">Security\VBAWarnings</TargetObject>
        <Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project VBA Warnings Macro Setting Change,Risk=40" groupRelation="and">
        <TargetObject condition="end with">Security\VBAWarnings</TargetObject>
        <Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
      </Rule>
      <Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Potential Office Macro Execution Detected" groupRelation="and">
        <Image condition="contains any">EXCEL.exe;WINWORD.exe</Image>
        <TargetObject condition="contains any">{8BD21D32-EC42-11CE-9E0D-00AA006002F3};{5B9D8FC8-4A71-101B-97A6-00000B65C08B}</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: User Execution: Malicious File-->
      <Rule name="Attack=T0000,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=NJRAT Detection,Risk=100" groupRelation="and">
        <TargetObject condition="is">HKCU\di</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lokibot Detection" groupRelation="and">
        <TargetObject condition="contains">HKCU\�</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AMSI Tamper Detection" groupRelation="or">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\AMSI\Providers\</TargetObject>
        <TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject condition="begin with">hkcu\software\microsoft\windows script\settings\amsienable</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->

      <!--MITRE ATT&CK TACTIC: Persistence-->
      <Rule name="Attack=T1176,Technique=Browser Extensions,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Old Chrome Extension auditing" groupRelation="and">
        <TargetObject condition="contains">Google\Chrome\Extensions</TargetObject>
        <TargetObject condition="end with">update_url</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <Rule name="Attack=T1176,Technique=Browser Extensions,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Chrome Extension auditing" groupRelation="and">
        <TargetObject condition="contains">Google\Chrome</TargetObject>
        <TargetObject condition="contains">extensions.settings</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Forced password reset detected" groupRelation="and">
        <TargetObject condition="contains">ForcePasswordReset</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Machine Password Change Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SECURITY\Policy\Secrets\$MACHINE.ACC\CurrVal</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Last Password Changed" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
        <TargetObject condition="end with">Last Password Change</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Account Expiration" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
        <TargetObject condition="end with">Account Expiration</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Failed Logon" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
        <TargetObject condition="end with">Last Failed Logon</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Account Added to Local Admin" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\00000220\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Account Added to Remote Desktop User Group" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\0000022B\</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Alert=Process Injection: injecting a 64-bit DLL into a 32-bit process" groupRelation="and">
        <TargetObject condition="contains">SOFTWARE\Microsoft\Wow64\x86\</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Alert=AutoRun Reg Keys,Risk=70" groupRelation="and">
        <EventType condition="is">SetValue</EventType>
        <TargetObject condition="contains">\CurrentVersion\Run\</TargetObject>
        <Image condition="excludes any">C:\Program Files\Microsoft OneDrive\Update\OneDriveSetup.exe;\AppData\Local\Microsoft\Teams\current\Teams.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <Details condition="excludes all">C:\Program Files\Google\Drive File Stream;\GoogleDriveFS.exe;startup_mode</Details>
        <Details condition="excludes all">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;no-startup-window;win-session-start;prefetch</Details>
        <Details condition="excludes all">\Application\chrome.exe;no-startup-window;win-session-start;prefetch</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Logon Logoff Shutdown Scripts" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\System\Scripts</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Logon Logoff Shutdown Scripts" groupRelation="and">
        <TargetObject condition="contains">\Windows\System\Scripts</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Service Command Line parameters" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\Setup\CmdLine</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: Boot" groupRelation="and">
        <TargetObject condition="end with">\Start</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: System" groupRelation="and">
        <TargetObject condition="end with">\Start</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: Automatic" groupRelation="and">
        <TargetObject condition="end with">\Start</TargetObject>
        <Details condition="contains">DWORD (0x00000002)</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Service Start Mode Changed to: Manual" groupRelation="and">
        <TargetObject condition="end with">\Start</TargetObject>
        <Details condition="contains">DWORD (0x00000003)</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Service Start Mode Changed to: Disabled" groupRelation="and">
        <TargetObject condition="end with">\Start</TargetObject>
        <Details condition="contains">DWORD (0x00000004)</Details>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Services and autoruns imagepath" groupRelation="and">
        <TargetObject condition="end with">\ImagePath</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Service DLL changes" groupRelation="and">
        <TargetObject condition="end with">\ServiceDll</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Manifest pointing to service's DLL" groupRelation="and">
        <TargetObject condition="end with">\ServiceManifest</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="begin with">hkcu\software\microsoft\windows nt\currentversion\windows\run\</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="contains all">hkcu\software\microsoft\windows nt\currentversion\accessibility\ATs\\*(1)\StartExe</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution: Print Processors-->
      <Rule name="Attack=T1013,Technique=Port Monitors,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification" groupRelation="and">
        <TargetObject condition="contains">\Print\Monitors</TargetObject>
      </Rule>
      <!--<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Printers\Connections</TargetObject>
      <TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Print\Environments\</TargetObject>
      <TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Servers\Printers\</TargetObject>
      <TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Print\V4 Connections</TargetObject>
      <TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">CurrentVersion\PrinterPorts</TargetObject>
      <TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">SWD\PRINTENUM</TargetObject>-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
      <!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
      <!--MITRE ATT&CK TECHNIQUE: Create Account-->
      <Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=New user created,Risk=40" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
        <TargetObject condition="excludes">$</TargetObject>
        <EventType condition="is">CreateKey</EventType>
      </Rule>
      <Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Creation,Level=0,Desc=Hidden New user created,Risk=40" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
        <TargetObject condition="contains">$</TargetObject>
        <EventType condition="is">CreateKey</EventType>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Sysmon Manifest change detected,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}</TargetObject>
        <Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
        <Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
        <Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Endpoint Protocol Handlers" groupRelation="and">
        <TargetObject condition="begin with">HKCR\</TargetObject>
        <TargetObject condition="end with">(Default)</TargetObject>
        <TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
        <Details condition="begin with">URL:</Details>
      </Rule>
      <Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor User Protocol Handlers" groupRelation="and">
        <TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
        <TargetObject condition="end with">(Default)</TargetObject>
        <TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
        <Details condition="begin with">URL:</Details>
      </Rule>
      <Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Endpoint File Associations" groupRelation="and">
        <TargetObject condition="begin with">HKCR\</TargetObject>
        <TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
        <Details condition="contains">%1</Details>
      </Rule>
      <Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor User Default File Associations" groupRelation="and">
        <TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
        <TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
        <Details condition="contains">%1</Details>
      </Rule>
      <Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor COM Hijacking" groupRelation="and">
        <TargetObject condition="end with">\shell\open\command\DelegateExecute</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Accessibility Features-->
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Utilman Priv Escalation,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\utilman.exe</TargetObject>
      </Rule>
      <Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=sethc.exe Priv Escalation,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=KnownDLLs" groupRelation="and">
        <TargetObject condition="contains">Session Manager\KnownDlls</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Outlook Addins" groupRelation="and">
        <TargetObject condition="contains">Outlook\Addins</TargetObject>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Word Addins" groupRelation="and">
        <TargetObject condition="contains">Word\Addins</TargetObject>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Excel Addins" groupRelation="and">
        <TargetObject condition="contains">Excel\Addins</TargetObject>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Powerpoint Addins" groupRelation="and">
        <TargetObject condition="contains">Powerpoint\Addins</TargetObject>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft VSTO Inclusions" groupRelation="and">
        <TargetObject condition="contains">Software\Microsoft\VSTO\Security\Inclusion\</TargetObject>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft VSTO Solution Metadata" groupRelation="and">
        <TargetObject condition="contains">Software\Microsoft\VSTO\SolutionMetadata\</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Privilege Escalation-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CMSTPLUA UAC Bypass" groupRelation="and">
        <TargetObject condition="contains any">cmmgr32.exe</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLU\Software\Microsoft\Command Processor\AutoRun</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\SetupExecute</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\Execute</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Command Processor\AutoRun</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\WindowsNT\CurrentVersion\Winlogon</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Command Processor\AutoRun</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit\</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AppSetup</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">UserInitMprLogonScript</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=BootVerificationProgram Autorun" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BootVerificationProgram\ImagePath</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution: Security Support Provider-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Authentication Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\Authentication Packages</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Notification Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\Notification Packages</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Security Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Authentication Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Authentication Packages</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Notification Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Notification Packages</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Security Packages" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
      <!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
      <!--Microsoft:Windows:COM Object Hijacking [ https://blog.gdatasoftware.com/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence ] | Credit @ion-storm -->
      <Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Suspicious Com Object Hijacking Locations,Risk=30" groupRelation="and">
        <TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
        <Details condition="contains any">C:\Users\Public\;$Recyclebin;\temp\;\Desktop\;\Downloads\;\Content.Outlook\;\Microsoft\Office\</Details>
        <Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
      </Rule>
      <Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Com Object Hijacking Locations,Risk=30" groupRelation="and">
        <TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
        <Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
      </Rule>
      <Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=TreatAs/ProgID Friendly Name Com Hijacking Evasion - check for following rundll32 -sta,Risk=30" groupRelation="and">
        <TargetObject condition="contains any">\ProgID\(Default);\TreatAs\(Default)</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Image File Execution Options Injection-->
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Image File Execution Options,Risk=30" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
        <TargetObject condition="contains any">Debugger;ReportingMode;MonitorProcess</TargetObject>
      </Rule>
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Globalflag Set,Risk=75" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
        <TargetObject condition="contains">GlobalFlag</TargetObject>
        <Details condition="contains">DWORD (0x00000200)</Details> <!--SilentProcessExit Dword Value-->
      </Rule>
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Process Execution entry,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <TargetObject condition="contains">MonitorProcess</TargetObject> <!--SilentProcessExit Monitor Process from werfault-->
      </Rule>
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Reporting Mode Enabled,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <TargetObject condition="contains">ReportingMode</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details> <!--SilentProcessExit Reporting Mode Enabled-->
      </Rule>
      <Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Process Added,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit</TargetObject>
        <EventType condition="is">CreateKey</EventType>
      </Rule>
      <Rule name="Attack=T1546,Technique=Event Triggered Execution,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Monitor Runtime Exception Handler execution on crash,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows\Windows Error Reporting\RuntimeExceptionHelperModules\</TargetObject>
        <Image condition="excludes all">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{;}\EDGEMITMP_;.tmp\setup.exe</Image>
        <Image condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <Image condition="excludes">C:\Program Files\Microsoft Office\root\integration\integrator.exe</Image>
        <Image condition="excludes all">C:\Program Files\Google\Chrome Beta\Application\;\Installer\setup.exe</Image>
        <Image condition="excludes all">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\;\OfficeClickToRun.exe</Image>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
      <Rule name="Attack=T1053,Technique=Scheduled Task,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=New Scheduled Task Created,Risk=80" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <TargetObject condition="end with">SD</TargetObject>
        <TargetObject condition="is not">Microsoft\Windows\UpdateOrchestrator</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\OneDrive Per-Machine Standalone Update Task\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates Logon\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Performance Monitor\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SnapshotCleanupTask\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office ClickToRun Service Monitor\SD</TargetObject>
        <TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Automatic Updates 2.0\SD</TargetObject>
        <TargetObject condition="excludes any">Microsoft\Windows\UpdateOrchestrator;\AMDInstallLauncher\SD;\SD;ASUS Switch;\PowerToys\Autorun for </TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation ID Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <TargetObject condition="end with">ID</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Author Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        <TargetObject condition="end with">Author</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Path Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        <TargetObject condition="end with">Path</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Date Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        <TargetObject condition="end with">Date</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Added to Logon" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Logon</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Added to Boot Time" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Boot</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

      <!--MITRE ATT&CK TACTIC: Defense Evasion-->
      <Rule name="Attack=T0000,Technique=Environment Value Modification,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Environment Value Modification" groupRelation="and">
        <EventType condition="is">SetValue</EventType>
        <TargetObject condition="contains">\Environment\</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
      <!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism: Bypass User Account Control-->
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Disablement Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=ConsentPromptBehaviorAdmin Disablement Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=PromptOnSecureDesktop Disablement Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\PromptOnSecureDesktop</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect UAC Tampering" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Bypass,Risk=70" groupRelation="and">
        <TargetObject condition="end with">\Software\Microsoft\Windows\CurrentVersion\App Paths\control.exe</TargetObject>
      </Rule>
      <Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Bypass,Risk=70" groupRelation="and">
        <TargetObject condition="end with">exefile\shell\runas\command\isolatedCommand</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
      <!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
      <!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
      <!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Explorer Setting modification" groupRelation="and">
        <TargetObject condition="end with">\Hidden</TargetObject>
      </Rule>
      <Rule name="Attack=T1564.002,Technique=Hide Artifacts: Hidden Users,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=User Account Hidden From Logon Screen,Risk=100" groupRelation="and">
        <TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist\</TargetObject>
        <TargetObject condition="end with">$</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
      <Rule name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Stealth Sysmon Change Detected,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SysmonDrv\Parameters</TargetObject>
        <Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
        <Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
        <Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
        <Image condition="excludes">C:\Programdata\sysmon\sysmon.exe</Image>
        <Image condition="excludes">C:\Windows\TEMP\sysmon.exe</Image>
        <!--Customize: Add your configuration directory above-->
      </Rule>
      <Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Modification to System Exploit Protection,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel</TargetObject>
        <TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
      </Rule>
      <Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Modification to Per-Process Exploit Protection,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
        <TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmcompute.exe\0\MitigationOptions</TargetObject>
        <TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmwp.exe\0\MitigationOptions</TargetObject>
        <Image condition="excludes">msiexec.exe</Image>
        <Image condition="excludes">TiWorker.exe</Image>
      </Rule>
      <Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Modification to WOW64 Per-Process Exploit Protection Mitigation Options,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
        <Image condition="excludes">C:\Program Files\Microsoft Office 15\root\integration\integrator.exe</Image>
        <TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Acro</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Task Manager Disablement Detection" groupRelation="and">
        <TargetObject condition="end with">DisableTaskMgr</TargetObject>
        <Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
        <Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Driver Altitude Change Detected - Causes Driver load failure on boot" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\</TargetObject>
        <TargetObject condition="contains all">\Instances\;Altitude</TargetObject>
        <TargetObject condition="is not">HKLM\System\CurrentControlSet\Services\CldFlt\Instances\CldFlt\Altitude</TargetObject>
        <EventType condition="is">SetValue</EventType>
      </Rule>
      <!--Detect Malware & Unauthorized Changes to Outlook, Excel, Powerpoint, and Access Security to enable execution of scripts/Macros -->
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=All Office Macros Enabled!,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Security\Level</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Notifications for all macros,Risk=50" groupRelation="and">
        <TargetObject condition="contains">\Security\Level</TargetObject>
        <Details condition="contains">DWORD (0x00000002)</Details>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Notifications for digitally signed macros - all other macros disabled,Risk=0" groupRelation="and">
        <TargetObject condition="contains">\Security\Level</TargetObject>
        <Details condition="contains">DWORD (0x00000003)</Details>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=All Office Macros Disabled without notification,Risk=0" groupRelation="and">
        <TargetObject condition="contains">\Security\Level</TargetObject>
        <Details condition="contains">DWORD (0x00000004)</Details>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Outlook Security Changes" groupRelation="and">
        <TargetObject condition="contains">\Outlook\Security</TargetObject>
        <!--Allow Outlook Details rules to fire-->
        <TargetObject condition="excludes">\Security\Level</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Word Security Changes" groupRelation="and">
        <TargetObject condition="contains">\Word\Security</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Excel Security Changes" groupRelation="and">
        <TargetObject condition="contains">\Excel\Security</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Unauthorized changes to Office Security" groupRelation="and">
        <TargetObject condition="contains">\Security\Level1Remove</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft:Windows:Security Center: HideSCAHealth" groupRelation="and">
        <TargetObject condition="end with">\HideSCAHealth</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center AV Disabled Notifications" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disable UAC Notify Monitoring" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disabled Monitoring" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disabled Monitoring" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disablement of Update notifications" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Firewall Override Monitoring" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Tampering: All Alerts Disabled" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
      </Rule>
      <Rule name="Attack=1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detected disablement of System Restore,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\RPSessionInterval</TargetObject>
      </Rule>
      <Rule name="Attack=1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detected disablement of System Restore,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\SystemRestorePointCreationFrequency</TargetObject>
      </Rule>
      <Rule name="Attack=1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected disablement of machine password,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Secure Channel Protection changes,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\FullSecureChannelProtection</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Refuse PW Change for workstations" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RefusePasswordChange</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender AntiSpyware Disablement Detection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Behavior Monitoring Disablement Detection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Real Time Protection Disablement Detection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Spynet Reporting Disablement Detection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable Windows Event Logging-->
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Windows Event Log Source,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
        <TargetObject condition="end with">\Enabled</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
        <Image condition="excludes">C:\WINDOWS\system32\DrvInst.exe</Image> <!--Common Driver Installs-->
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Enabling of Windows Event Log Source" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
        <TargetObject condition="end with">\Enabled</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Event log system integrity and ACL Modifications" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
        <TargetObject condition="excludes">\Enabled</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Change Winevt Event Access Permission Via Registry,Author=frack113" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\</TargetObject>
        <TargetObject condition="end with">\ChannelAccess</TargetObject>
        <Details condition="contains any">(A;;0x1;;;SY);(A;;0x5;;;BA);(A;;0x1;;;LA)</Details>
        <Image condition="excludes any">C:\Windows\servicing\TrustedInstaller.exe;\TiWorker.exe</Image>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Powershell Event Logging,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
        <TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
        <Image condition="excludes">C:\Program Files (x86)\N-able Technologies\AutomationManagerAgent\AutomationManager.AgentService.exe</Image>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Powershell Event Logging,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
        <TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
        <EventType condition="is any">DeleteKey;DeleteValue</EventType>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of cmdline Event Logging,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
        <TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of cmdline Event Logging,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
        <TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
        <EventType condition="is any">DeleteKey;DeleteValue</EventType>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Eventlog Security Descriptor Modification,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
        <TargetObject condition="end with">\CustomSD</TargetObject>
      </Rule>
      <Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Eventlog Size Modification,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
        <TargetObject condition="end with">\MaxSize</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify System Firewall-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Globally Opened Firewall port exceptions" groupRelation="and">
        <TargetObject condition="contains">globallyopenports</TargetObject>
      </Rule>
      <Rule name="Technique=Attack=1089,Disabling Security Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Firewall Enablement or Disablement" groupRelation="and">
        <TargetObject condition="end with">EnableFirewall</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=App added to Firewall Auth list" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=ETWEnabled Env Tampering,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\.NETFramework\ETWEnabled</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Usagelog Tampering,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\.NETFramework\NGenAssemblyUsageLog</TargetObject>
      </Rule>
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Usagelog Env Tampering,Risk=70" groupRelation="and">
        <EventType condition="is">SetValue</EventType>
        <TargetObject condition="contains">\Environment\NGenAssemblyUsageLog</TargetObject>
      </Rule>
      <Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=COMPlus_ETWEnabled Env Tampering,Risk=70" groupRelation="and">
        <EventType condition="is">SetValue</EventType>
        <TargetObject condition="contains">\Environment\COMPlus_ETWEnabled</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Masquerading-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Regedit history Detection,Risk=30" groupRelation="and">
        <TargetObject condition="end with">\LastKey</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Symbolic Registry Link Created" groupRelation="and">
        <TargetObject condition="contains">SymbolicLinkValue</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Suspicious Location Registry Change Detected" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer</TargetObject>
        <Image condition="contains any">\AppData\;\ProgramData\;\Temp\;C:\users</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Right to Left hidden Registry key,Risk=40" groupRelation="and">
        <TargetObject condition="contains">&#x202e;</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Remote Registry Setting Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\SecurePipeServers\winreg</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect System Certificate Modifications" groupRelation="and">
        <TargetObject condition="contains any">\Software\Policies\Microsoft\SystemCertificates\;\SOFTWARE\Microsoft\EnterpriseCertificates\;HKLM\SOFTWARE\Microsoft\SystemCertificates\;HKLM\Software\Microsoft\Cryptography\Services\ServiceName\SystemCertificates\</TargetObject>
        <EventType condition="is not">CreateKey</EventType>
        <Image condition="excludes">C:\WINDOWS\Sysmon64.exe</Image>
        <Image condition="excludes">C:\WINDOWS\Sysmon.exe</Image>
        <Image condition="excludes">C:\WINDOWS\system32\certsrv.exe</Image>
        <Image condition="excludes">C:\WINDOWS\system32\CompatTelRunner.exe</Image>
        <Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
        <Image condition="excludes">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
        <Image condition="excludes">C:\Windows\system32\SearchProtocolHost.exe</Image>
        <Image condition="excludes">C:\Windows\system32\taskhost.exe</Image>
        <Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
        <Image condition="excludes">C:\WINDOWS\System32\DriverStore\FileRepository\asus</Image>
        <Image condition="excludes">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image>
        <Image condition="excludes">C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.Service.exe</Image>
        <Image condition="excludes">C:\Program Files\NVIDIA Corporation\NvContainer\nvcontainer.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop fDenyTSConnections modification" groupRelation="and">
        <TargetObject condition="contains">fDenyTSConnections</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop Settings keys" groupRelation="and">
        <TargetObject condition="contains">Terminal Server\WinStations\RDP-Tcp</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop port modification" groupRelation="and">
        <TargetObject condition="end with">RDP-tcp\PortNumber</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Enablement of Multiple RDP Sessions" groupRelation="and">
        <TargetObject condition="end with">Control\Terminal Server\fSingleSessionPerUser</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
      <!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Unicode Replacement Character in Registry key,Risk=20" groupRelation="and">
        <TargetObject condition="contains">&#xfffd;</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryillic Character in Registry key,Risk=100" groupRelation="and">
        <TargetObject condition="contains any">Й;ќ;Л;я;К</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
      <!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
      <!--MITRE ATT&CK TECHNIQUE: Process Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
      <!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
      <!--MITRE ATT&CK TECHNIQUE: Rootkit-->
      <Rule name="Attack=T1109,Technique=Component Firmware,Tactic=Defense Escalation/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect ACPI Rootkits" groupRelation="and">
        <TargetObject condition="begin with">HKLM\HARDWARE\ACPI\DSDT</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
      <!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
      <!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Template Injection-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
      <!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
      <!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
      <!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

      <!--MITRE ATT&CK TACTIC: Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Brute Force-->
      <!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
      <!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
      <!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
      <!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
      <!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
      <!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
      <!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->
      <!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials: Credentials in Registry-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Outlook Profile Artifacts" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultPassword</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" groupRelation="and">
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Credentials in Registry: Domain" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultDomainName</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Credentials in Registry: Username" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultUserName</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 1,Risk=70" groupRelation="and">
        <TargetObject condition="contains">SecurityPasswordAES</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 2,Risk=70" groupRelation="and">
        <TargetObject condition="contains">OptionsPasswordAES</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 3,Risk=70" groupRelation="and">
        <TargetObject condition="contains">SecurityPasswordExported</TargetObject>
      </Rule>
      <Rule name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 4,Risk=70" groupRelation="and">
        <TargetObject condition="contains">PermanentPassword</TargetObject>
      </Rule>

      <!--MITRE ATT&CK TACTIC: Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
      <!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
      <!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
      <!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Query Registry-->
      <!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
      <!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

      <!--MITRE ATT&CK TACTIC: Lateral Movement-->
      <!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
      <!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Services-->
      <!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
      <!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
      <!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

      <!--MITRE ATT&CK TACTIC: Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
      <!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
      <!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
      <!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Staged-->
      <!--MITRE ATT&CK TECHNIQUE: Email Collection-->
      <!--MITRE ATT&CK TECHNIQUE: Input Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
      <!--MITRE ATT&CK TECHNIQUE: Video Capture-->

      <!--MITRE ATT&CK TACTIC: Command and Control-->
      <!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
      <!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
      <!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
      <!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
      <!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Git For Windows Detection: Revil: Sodinokibi,Risk=50" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\GitForWindows</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
      <!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
      <!--MITRE ATT&CK TECHNIQUE: Proxy-->
      <!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
      <!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
      <!--MITRE ATT&CK TECHNIQUE: Web Service-->

      <!--MITRE ATT&CK TACTIC: Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
      <!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
      <!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
      <!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
      <!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->

      <!--MITRE ATT&CK TACTIC: Impact-->
      <!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
      <Rule name="Attack=T1531,Technique=Account Access Removal,Tactic=Impact,DS=Windows Registry: Windows Registry Key Deletion,Level=1,Desc=User Account Deleted" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
        <EventType condition="is">DeleteKey</EventType>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Bitlocker Drive Encryption Enabled on System Drive" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Bitlocker Drive Encryption Disabled on System Drive" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
        <Details condition="contains">DWORD (0x00000000)</Details>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
      <!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
      <!--MITRE ATT&CK TECHNIQUE: Defacement-->
      <!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
      <!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
      <!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
      <Rule name="Attack=T1485,Technique=Inhibit System Recovery,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=VSS Disablement Detection,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Services\VSS\Diag\(Default)</TargetObject>
      </Rule>
      <!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
      <!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
      <!--MITRE ATT&CK TECHNIQUE: Service Stop-->
      <!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->

      <!-- UEBA/Uncategorized Detections-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lanmanserver Parameters Registry Change Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lanmanworkstation Parameters Registry Change Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Lanmanworkstation\Parameters</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Regedit history Detection,Risk=30" groupRelation="and">
        <TargetObject condition="end with">\LastKey</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=TS Farm Disable RDP Detection" groupRelation="and">
        <TargetObject condition="end with">\WinStationsDisabled</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=TS Farm Drain Mode Modification Detection" groupRelation="and">
        <TargetObject condition="end with">\TSServerDrainMode</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=IE history Detection" groupRelation="and">
        <TargetObject condition="end with">\TypedURLs</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IPv6 Changes detected: Disabled Components" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\disabledcomponents</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IPv6 Changes detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Linkage\Bind</TargetObject>
        <Details condition="excludes">Binary Data</Details>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Network Card Changes detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Service Listening Ports with URL ACL INFO" groupRelation="and">
        <TargetObject condition="contains">services\http\parameters\urlaclinf</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Adobe Recent File List History" groupRelation="and">
        <TargetObject condition="contains">cRecentFiles\c1\</TargetObject>
        <TargetObject condition="end with">tDIText</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Office History MRU" groupRelation="and">
        <TargetObject condition="end with">\File MRU\Item 1</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Sysmon Config Hash Modification Monitoring" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\SysmonDrv\Parameters\ConfigHash</TargetObject>
      </Rule>
      <!--Common Malware Persistence locations-->
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Classes\ CLSID\{73E709EA-5D93-4B2E-BBB0-99B7938DA9E4}\LocalServer32</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\RunService</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\Windows\Load</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\Windows\Run</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\Winlogon\Shell</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\Winlogon\System</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows NT\CurrentVersion\Windows\load</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.006,Technique=Impair Defenses: Indicator Blocking,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ETW Tampering,Risk=70" groupRelation="and">
        <TargetObject condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Group Policy Scripts" groupRelation="and">
        <TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
      </Rule>
      <Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=2,Alert=AutoRun Keys,Risk=70" groupRelation="and">
        <TargetObject condition="contains">Terminal Server\Wds\rdpwd\StartupPrograms</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Alternate Shell AvailableShells Hijack" groupRelation="and">
        <TargetObject condition="contains">Winlogon\AlternateShells\AvailableShells</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Alternative Shell Policy" groupRelation="and">
        <TargetObject condition="contains">Policies\System\Shell</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AutoStart on Connect" groupRelation="and">
        <TargetObject condition="contains">Windows CE Services\AutoStartOnConnect</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AutoStart on Disconnect" groupRelation="and">
        <TargetObject condition="contains">Windows CE Services\AutoStartOnDisconnect</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CurrentVersion URL Key" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\URL</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Font Drivers" groupRelation="and">
        <TargetObject condition="end with">\CurrentVersion\Font Drivers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Group Policy Shutdown scripts" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Icon Service Lib" groupRelation="and">
        <TargetObject condition="contains">CurrentVersion\Windows\IconServiceLib</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Installed Components" groupRelation="and">
        <TargetObject condition="contains">Active Setup\Installed Components</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lateral Movement: New Named Pipe added to NullSession" groupRelation="and">
        <TargetObject condition="contains">NullSessionShares</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lateral Movement: New Named Pipe added to NullSession" groupRelation="and">
        <TargetObject condition="end with">NullSessionPipes</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Password Expiry Info" groupRelation="and">
        <TargetObject condition="contains">PasswordExpiryNotification</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Safeboot Alternative Shell hijack" groupRelation="and">
        <TargetObject condition="contains">SafeBoot\AlternateShell</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Screen Save on Desktop" groupRelation="and">
        <TargetObject condition="contains">Desktop\Scrnsave.exe</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or DisplayVersion modified" groupRelation="and">
        <TargetObject condition="end with">\DisplayVersion</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Modify String modified" groupRelation="and">
        <TargetObject condition="end with">\ModifyPath</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Uninstall String modified" groupRelation="and">
        <TargetObject condition="contains">\Microsoft\Windows\CurrentVersion\Uninstall\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Uninstall String modified" groupRelation="and">
        <TargetObject condition="end with">\UninstallString</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Terminal Services Initial Program Key" groupRelation="and">
        <TargetObject condition="contains">Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Winlogon Taskman Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman</TargetObject>
      </Rule>
      <!--CLSID launch commands and file association changes-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=File Extension Mapping" groupRelation="and">
        <TargetObject condition="contains">\Explorer\FileExts\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Command Shell install Key" groupRelation="and">
        <TargetObject condition="contains">\shell\install\command\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=User SID History for Forensics" groupRelation="and">
        <TargetObject condition="end with">\ProfileImagePath</TargetObject>
      </Rule>
      <!--Windows shell hijack-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AllFileSystemObjects Classes" groupRelation="and">
        <TargetObject condition="contains">\Classes\AllFilesystemObjects\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Asterisk Classes" groupRelation="and">
        <TargetObject condition="contains">\Classes\*\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CFT LangBarAddin" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Ctf\LangBarAddin</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ContextMenuHandlers" groupRelation="and">
        <TargetObject condition="contains">\ContextMenuHandlers\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CurrentVersion Shell Keys" groupRelation="and">
        <TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect ShellExecuteHooks" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\ShellIconOverlayIdentifiers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Directory Classes" groupRelation="and">
        <TargetObject condition="contains">\Classes\Directory\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Drive Classes" groupRelation="and">
        <TargetObject condition="contains">\Classes\Drive\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Explorer Shell Execute Hooks" groupRelation="and">
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Folder Classes" groupRelation="and">
        <TargetObject condition="contains">\Classes\Folder\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Explorer Setting modification" groupRelation="and">
        <TargetObject condition="end with">\Hidden</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Extensions Explorer Setting modification" groupRelation="and">
        <TargetObject condition="end with">\HideFileExt</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Internet Explorer Desktop Components" groupRelation="and">
        <TargetObject condition="contains">\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Protocol Filter Classes" groupRelation="and">
        <TargetObject condition="contains">\SOFTWARE\Classes\Protocols\Filter</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Protocol Handler Classes" groupRelation="and">
        <TargetObject condition="contains">\SOFTWARE\Classes\Protocols\Handler</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=SharedTaskScheduler" groupRelation="and">
        <TargetObject condition="contains">\SharedTaskScheduler</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Super Hidden File Explorer Setting modification" groupRelation="and">
        <TargetObject condition="end with">\ShowSuperHidden</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ColumnHandlers" groupRelation="and">
        <TargetObject condition="contains">\ColumnHandlers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: CopyHookHandlers" groupRelation="and">
        <TargetObject condition="contains">\CopyHookHandlers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ExtShellFolderView" groupRelation="and">
        <TargetObject condition="contains">\ExtShellFolderViews</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: PropertySheetHandlers" groupRelation="and">
        <TargetObject condition="contains">\PropertySheetHandlers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ShellServiceObjectDelayLoad" groupRelation="and">
        <TargetObject condition="contains">\ShellServiceObjectDelayLoad</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ShellServiceObjects" groupRelation="and">
        <TargetObject condition="contains">\ShellServiceObjects</TargetObject>
      </Rule>
      <!--AppPaths hijacking-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\S0InitialCommand</TargetObject>
      </Rule>
      <!--Terminal service boobytraps-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Terminal Services BoobyTraps" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
      </Rule>
      <!--Group Policy interity-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Group Policy interity Detection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\</TargetObject>
      </Rule>
      <!--Winsock and Winsock2-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Popup Blocker Changes" groupRelation="and">
        <TargetObject condition="end with">\3\1809</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Protected Mode Changes" groupRelation="and">
        <TargetObject condition="end with">\3\2500</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Scripting Mode in Internet Zone Changes" groupRelation="and">
        <TargetObject condition="end with">\3\1206</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Security Setting Check Warning Changes" groupRelation="and">
        <TargetObject condition="end with">\DisableSecuritySettingsCheck</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\NameSpace_Catalog5\Catalog_Entries64</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Proxy Server Changes" groupRelation="and">
        <TargetObject condition="end with">\ProxyServer</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected IE Legacy setting modifications" groupRelation="and">
        <TargetObject condition="end with">SavedLegacySettings</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected IE Proxy setting modifications" groupRelation="and">
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\Internet Settings\Proxy</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Modifications of Console Tracing" groupRelation="and">
        <TargetObject condition="end with">EnableConsoleTracing</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Modifications of File Tracing" groupRelation="and">
        <TargetObject condition="end with">EnableFileTracing</TargetObject>
      </Rule>
      <!--Credential providers-->
      <Rule name="Attack=T1177,Tactic=Execution/Persistence,Technique=LSASS Driver,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Detection of Modification of LSASS Protection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Authentication PLAP Provider Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\PLAP Providers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Authentication Provider Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Credential provider Filter Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider Filters</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect LSA Credential Provider Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect NETSH Helper DLL Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Netsh</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Security Provider Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders\</TargetObject>
      </Rule>
      <!--Networking-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Network Interface Priority ordering" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Monitor Network History" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
      </Rule>
      <!--DLLs that get injected into every process launch-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AppInitDLL Monitoring: DLLs that get injected into every process launch" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AppInitDLL Monitoring: DLLs that get injected into every process launch" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject>
      </Rule>
      <!--Office-->
      <!--Microsoft Office-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Test Autorun Location Monitoring,Risk=40,Author=Hexacorn" groupRelation="and">
        <TargetObject condition="contains">Office Test\</TargetObject>
      </Rule>
      <!--IE-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Internet Explorer Toolbars" groupRelation="and">
        <TargetObject condition="contains">\Internet Explorer\Toolbar\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Internet Explorer Extensions" groupRelation="and">
        <TargetObject condition="contains">\Internet Explorer\Extensions\</TargetObject>
      </Rule>
      <!--Magic registry keys-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Browser Helper Object Modifications" groupRelation="and">
        <TargetObject condition="contains">\Browser Helper Objects\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Thumbnail cache autostart" groupRelation="and">
        <TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\</TargetObject>
      </Rule>
      <!--Infection artifacts-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ClickOnce URL Update Artifact" groupRelation="and">
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Installer Source Artifact" groupRelation="and">
        <TargetObject condition="end with">\InstallSource</TargetObject>
      </Rule>
      <!--Windows internals integrity monitoring-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Legacy Drivers Loaded" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect System Policy Changes" groupRelation="and">
        <TargetObject condition="contains">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Windows Defender Policy Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Path Changes,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Exclusions\Paths</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Extension Changes,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Exclusions\Extensions</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Processes Changes,Risk=100" groupRelation="and">
        <TargetObject condition="contains">\Exclusions\Processes</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Windows Defender Tamper Protection Modifications" groupRelation="and">
        <TargetObject condition="begin with">TamperProtection</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect malware changes to UAC prompt level" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\</TargetObject>
      </Rule>
      <!--Group Policy Scripts-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logoff Scripts" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logoff</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logoff Scripts" groupRelation="and">
        <TargetObject condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logoff</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logon Scripts" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logon</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logon Scripts" groupRelation="and">
        <TargetObject condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logon</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Shutdown Scripts" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Shutdown</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Shutdown Scripts" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Shutdown</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Startup Scripts" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Startup</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Startup Scripts" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Startup</TargetObject>
      </Rule>
      <!--Detect Network History-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AD Domain Change" groupRelation="and">
        <TargetObject condition="end with">Domain</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Default Gateway" groupRelation="and">
        <TargetObject condition="end with">DHCPDefaultGateway</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP IP Address" groupRelation="and">
        <TargetObject condition="end with">DhcpIPAddress</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Name Server Changes" groupRelation="and">
        <TargetObject condition="end with">DhcpNameserver</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Server Change" groupRelation="and">
        <TargetObject condition="end with">Dhcpserver</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Subnet mask Change" groupRelation="and">
        <TargetObject condition="end with">DhcpSubnetMask</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DNS Server Changes" groupRelation="and">
        <TargetObject condition="end with">Nameserver</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Default Gateway" groupRelation="and">
        <TargetObject condition="end with">\DefaultGateway</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network Persistent Route Change" groupRelation="and">
        <TargetObject condition="end with">PersistentRoutes</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network Type Change" groupRelation="and">
        <TargetObject condition="end with">}\Category</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network profile Changes" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Subnet Mask Change" groupRelation="and">
        <TargetObject condition="end with">SubnetMask</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro document to Trusted Records,Risk=30" groupRelation="and">
        <TargetObject condition="contains">\Trusted Documents\TrustRecords</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro document to Trusted Records 2,Risk=30" groupRelation="and">
        <TargetObject condition="contains">Software\Microsoft\VBA\7.1\Common</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro trusted certificate,Risk=30" groupRelation="and">
        <TargetObject condition="contains">Software\Microsoft\VBA\7.1\Trusted</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Security Settings: Monitor changes of security prompts" groupRelation="and">
        <TargetObject condition="contains">\Security\DontTrustInstalledFiles</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Trusted Location Changes" groupRelation="and">
        <TargetObject condition="contains">\Security\Trusted Locations</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of Internet files in Protected View" groupRelation="and">
        <TargetObject condition="end with">Security\ProtectedView\DisableInternetFilesInPV</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of attackments in Protected View" groupRelation="and">
        <TargetObject condition="end with">Security\ProtectedView\DisableAttachmentsInPV</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of Unsafe Locations in Protected View" groupRelation="and">
        <TargetObject condition="end with">Security\ProtectedView\DisableUnsafeLocationsInPV</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=WinRAR History" groupRelation="and">
        <TargetObject condition="contains">Software\WinRAR\ArcHistory</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Winzip History" groupRelation="and">
        <TargetObject condition="contains">WinZip\mru\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Misc Recent File List History" groupRelation="and">
        <TargetObject condition="contains">Recent File List</TargetObject>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Homepage Attack,Risk=70" groupRelation="and">
        <TargetObject condition="contains">Outlook\WebView\Inbox</TargetObject>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Homepage Attack,Risk=70" groupRelation="and">
        <TargetObject condition="contains">Outlook\Today\UserDefinedUrl</TargetObject>
      </Rule>
      <Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Calendar Homepage Attack,Risk=70" groupRelation="and">
        <TargetObject condition="contains">Outlook\WebView\Calendar</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Office History" groupRelation="and">
        <TargetObject condition="contains">\Place MRU</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-CompileTimeClaim" groupRelation="and">
        <TargetObject condition="end with">\LinkDate</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-DriverVer" groupRelation="and">
        <TargetObject condition="end with">\DriverVerVersion</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-DriverVer" groupRelation="and">
        <TargetObject condition="end with">\DriverVersion</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Path" groupRelation="and">
        <TargetObject condition="end with">\LowerCaseLongPath</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Pub" groupRelation="and">
        <TargetObject condition="end with">\Publisher</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Store" groupRelation="and">
        <TargetObject condition="contains">Compatibility Assistant\Store\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Ver" groupRelation="and">
        <TargetObject condition="end with">\BinProductVersion</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application Shortcuts" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryApplicationShortcut\</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Driver Binary Info" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryDriverBinary</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Driver Package Info" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryDriverPackage</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache PNP Device Info,Desc=Services: New or Updated Drivers" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryDevicePnp</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Device Info" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryDeviceContainer</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application Installation Info" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryApplication\</TargetObject>
        <TargetObject condition="contains any">ProgramID;Name;Version;Publisher;Language;InstallDate;Source;RootDirPath;HiddenArp;UninstallString;RegistryKeyPath;UserSID;sha256</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application File Info" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryApplicationFile\</TargetObject>
        <TargetObject condition="contains any">ProgramId;FileId;LowerCaseLongPath;Name;OriginalFileName;Publisher;Version;binfileversion;LinkDate;Size;Language;USN;IsPeFile;IsOsComponent;sha256;AppxPackageFullName</TargetObject>
        <TargetObject condition="excludes">pingsender.exe</TargetObject> <!--Related to Firefox-->
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache AppV Application Inventory" groupRelation="and">
        <TargetObject condition="contains">Root\InventoryApplicationAppV\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Office Information" groupRelation="and">
        <TargetObject condition="contains any">Root\InventoryMiscellaneousOfficeAddIn;Root\InventoryMiscellaneousOfficeIdentifiers;Root\InventoryMiscellaneousOfficeIESettings;Root\InventoryMiscellaneousOfficeInsights;Root\InventoryMiscellaneousOfficeProducts;Root\InventoryMiscellaneousOfficeSettings;Root\InventoryMiscellaneousOfficeVBA;Root\InventoryMiscellaneousOfficeVBARuleViolations</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Registry Hive List" groupRelation="and">
        <TargetObject condition="contains">\Control\hivelist</TargetObject>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=ISO Drive Mounted" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer\CD Burning\Drives\Volume</TargetObject>
        <TargetObject condition="end with">Drive Type</TargetObject>
        <Details condition="contains">DWORD (0x00000011)</Details>
      </Rule>
      <Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Mount Points" groupRelation="and">
        <TargetObject condition="end with">\Explorer\MountPoints2</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor DOS Devices Virtual Registry Paths" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\DOS Devices</TargetObject>
      </Rule>
      <Rule name="Attack=T1489,Technique=Service Stop,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Set for Deletion" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\DeleteFlag</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New Kernel Device Driver" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New File System Driver" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000002)</Details>
      </Rule>
      <Rule name="Attack=Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New Adapter Driver" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000004)</Details>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Own Process" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000020)</Details>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Share Process" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000020)</Details>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Interactive" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000100)</Details>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver Group" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Group</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DependOnService" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\DependOnService</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver BinaryPathName" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\BinaryPathName</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver RequiredPrivileges" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\RequiredPrivileges</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver Owners: Correlation to Amcache" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Owners</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ObjectName: User Service Runs as specified in ServiceStartName" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\ObjectName</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ObjectName: User Service Runs as" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\ServiceStartName</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ErrorControl" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\ErrorControl</TargetObject>
        <!--<Details name="Critical if lastknown good fails bugcheck" condition="contains">DWORD (0x00000003)</Details>
        <Details name="Severe last known good" condition="contains">DWORD (0x00000002)</Details>
        <Details name="Normal Boot on failure" condition="contains">DWORD (0x00000001)</Details>
        <Details name="Ignore Failure"condition="contains">DWORD (0x00000000)</Details>
        <Details condition="contains">DWORD (0x00000001)</Details>-->
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DependOnGroup" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\DependOnGroup</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DisplayName" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\DisplayName</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Group Order Modifications" groupRelation="and">
        <TargetObject condition="contains">HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder</TargetObject>
        <TargetObject condition="end with">\List</TargetObject>
      </Rule>
      <Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Set for Deletion" groupRelation="and">
        <TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
        <TargetObject condition="end with">\Type</TargetObject>
        <Details condition="contains">DWORD (0x00000001)</Details>
      </Rule>
      <!--Detect User Activity-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Bluetooth Audio Capture" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\bluetooth</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Contacts Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\contacts</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Input Capture Accesses/Keyloggers" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\hunmanInterfaceDevice</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Location Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\location</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Microphone Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\microphone</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect USB Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\usb\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Webcam Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\webcam</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect humanInterfaceDevice Accesses" groupRelation="and">
        <TargetObject condition="contains">\ConsentStore\humanInterfaceDevice</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Explorer Last Visited MRU" groupRelation="and">
        <TargetObject condition="contains">LastVisitedMRU</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Regedit Applets" groupRelation="and">
        <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\Applets\RegEdit</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Run MRU" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=USBStor USB Device History" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR</TargetObject>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Safeboot Service Added" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot\</TargetObject>
      </Rule>
      <Rule name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Crypto Trust Providers" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
      </Rule>
      <Rule name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Crypto Trust Providers" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
      </Rule>
      <Rule name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryptography OID Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
      </Rule>
      <Rule name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryptography OID Key" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect: Dns Server dll injection" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect: UAC Bypass" groupRelation="and">
        <TargetObject condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=New Device Connected" groupRelation="and">
        <TargetObject condition="end with">\FriendlyName</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Providers notified by Winlogon" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Proxy Autoconfig URL" groupRelation="and">
        <TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Internet Settings\AutoConfigURL</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Shell Service Object Delay Load" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Installer Engaged" groupRelation="and">
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AppCompat Shims" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AppCompat Shims" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Process Tracing Modifications,Risk=30" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Tracing\</TargetObject>
      </Rule>
      <Rule name="Alert=Detect PoisonTap,FP=2,Comment=May be noisy" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e972-e325-11ce-bfc1-08002be10318}</TargetObject>
        <Details condition="contains any">ndis;rndis</Details>
      </Rule>
      <Rule name="Attack=T1090,Technique=Connection Proxy,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=NetSH PortProxy Detected" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4</TargetObject>
      </Rule>
      <Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Alert=Possible Ursniff Malware Detected,FP=1" groupRelation="and">
        <TargetObject condition="contains">\Software\AppDataLow\Software\Microsoft\</TargetObject>
        <Details condition="contains any">.exe;.dll;powershell;wmic</Details>
      </Rule>
      <Rule name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=NetNTLM downgrade attack" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\lmcompatibilitylevel</TargetObject>
        <Details name="You should have this set to 5" condition="excludes">DWORD (0x00000005)</Details>
      </Rule>
      <Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Office Persistence Location,Risk=70" groupRelation="and">
        <TargetObject condition="end with">Software\Microsoft\Office test\Special\Perf</TargetObject>
      </Rule>
      <Rule name="Attack=T1177,Technique=LSASS Driver,Tactic=Execution/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Undocumented LSASS DLL Loading" groupRelation="and">
        <TargetObject condition="contains">\CurrentControlSet\Services\NTDS\LsaDbExtPt</TargetObject>
      </Rule>
      <Rule name="Attack=T1177,Technique=LSASS Driver,Tactic=Execution/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Undocumented LSASS DLL Loading" groupRelation="and">
        <TargetObject condition="contains">\Services\NTDS\DirectoryServiceExtPt</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=GoToMyPC File Transfer History,Risk=70" groupRelation="and">
        <TargetObject condition="contains">GoToMyPc\FileTransfer\history</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=GoToMyPC Guest Invite,Risk=70" groupRelation="and">
        <TargetObject condition="contains">GoToMyPc\GuestInvite</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=LogMeIn File Transfer Recipient" groupRelation="and">
        <TargetObject condition="contains">Filesharing</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=LogMeIn Guest Recipient" groupRelation="and">
        <TargetObject condition="contains">DesktopSharing</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer LogIncomingConnections Registry Key modification" groupRelation="and">
        <TargetObject condition="contains">LogIncomingConnections</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer LogOutgoingConnection Registry Key modification" groupRelation="and">
        <TargetObject condition="contains">LogOutgoingConnections</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer Password Registry Key date" groupRelation="and">
        <TargetObject condition="contains">PermanentPasswordDate</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer adminrights Key modification,Risk=70" groupRelation="and">
        <TargetObject condition="contains">Security_Adminrights</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VNC Incoming Connection History,Risk=70" groupRelation="and">
        <TargetObject condition="contains">vncviewer\MRU</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Autostart Key modification" groupRelation="and">
        <TargetObject condition="contains">Autostart_GUI</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Meeting Username Registry Key modification" groupRelation="and">
        <TargetObject condition="end with">Meeting_UserName</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Persistence Login Name" groupRelation="and">
        <TargetObject condition="end with">BuddyLoginName</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Persistence Token ID modification" groupRelation="and">
        <TargetObject condition="end with">BuddyLoginTokenID</TargetObject>
      </Rule>
      <Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer persistence Key modification" groupRelation="and">
        <TargetObject condition="contains">Always_Online</TargetObject>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Potential Ransomware Indicator: EnableLinkedConnections Registry key,Risk=100" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\CurrentVersion\Policies\System\EnableLinkedConnections</TargetObject>
      </Rule>
      <Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Potential Ransomware Indicator: REvil Sodinokibi Sodin Ransomware,Risk=100" groupRelation="and">
        <TargetObject condition="contains">Software\recfg</TargetObject>
      </Rule>
      <Rule name="Attack=T0000,Technique=Keyboard Layout,Tactic=N/A,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Suspicious Keyboard Layout Load" groupRelation="and">
        <TargetObject condition="contains">\Keyboard Layout\Preload\</TargetObject>
      </Rule>
      <Rule name="Attack=T0000,Technique=Keyboard Layout,Tactic=N/A,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Suspicious Keyboard Layout Load" groupRelation="and">
        <TargetObject condition="contains">\Keyboard Layout\Substitutes\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Hashes\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\KeyExchangeAlgorithms\Diffie-Hellman</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="end with">\Client\Enabled</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" groupRelation="and">
        <TargetObject condition="end with">\Server\Enabled</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Kitty Sessions,Risk=30" groupRelation="and">
        <TargetObject condition="contains">Kitty\Sessions</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=NetNTLM downgrade attack" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
      </Rule>
      <Rule name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=NetNTLM downgrade attack" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RestrictSendingNTLMTraffic</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Putty Sessions,Risk=30" groupRelation="and">
        <TargetObject condition="contains">PuTTY\Sessions</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=RDP History,Risk=10" groupRelation="and">
        <TargetObject condition="contains">Terminal Server Client\Servers</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=WINSCP Sessions,Risk=30" groupRelation="and">
        <TargetObject condition="contains">WinSCP 2\Sessions</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Desc=Antivirus Registry Moninitoring" groupRelation="or">
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
        <Image condition="begin with">C:\Program Files (x86)\ESET</Image>
        <Image condition="begin with">C:\Program Files\ESET</Image>
      </Rule>
        <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Browser Helper Object Contacted Domains" groupRelation="and">
        <TargetObject condition="end with">\EnableBHO</TargetObject>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Printer Port Changes,CVE=CVE-2020-1048" groupRelation="and">
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject> <!--Microsoft:Windows: Printer port changes as used in CVE-2020-1048 [ https://windows-internals.com/printdemon-cve-2020-1048/ ] -->
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=PrintNightmare Coverage,Author=Florian Roth" groupRelation="and">
        <TargetObject condition="contains">Control\Print\Environments\Windows x64\Drivers</TargetObject> <!-- PrinterNightmare coverage -->
      </Rule>
      <Rule name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=NGenAssemblyUsageLog Tampering Detected" groupRelation="and">
        <TargetObject condition="contains all">\Microsoft\.NETFramework;NGenAssemblyUsageLog</TargetObject>
      </Rule>
      <Rule name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=Winget admin settings Tampering Detected" groupRelation="and">
        <TargetObject condition="contains all">\REGISTRY\A\;LocalState\admin_settings</TargetObject>
      </Rule>
    </RegistryEvent>
  </RuleGroup>
  <!--SYSMON EVENT ID 15 : ALTERNATE DATA STREAM CREATED [FileCreateStreamHash]-->
  <RuleGroup name="RG=ADS Include Group" groupRelation="or">
    <FileCreateStreamHash onmatch="include">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Metadata,Level=0,Desc=Interesting Files temp locations,Risk=10" groupRelation="and">
        <TargetFilename condition="contains any">Content.IE5;INetCache</TargetFilename>
        <TargetFilename condition="contains any">.exe;.zip;.ps1;.bat;.rar;.vbs;.hta</TargetFilename>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Metadata,Level=4,Alert=HTML_Smuggling,Risk=50" groupRelation="and">
        <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
        <Contents condition="contains any">blob:;about:internet</Contents>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Metadata,Level=4,Alert=FireEye sunburst file hashes,Risk=100" groupRelation="and">
        <Hash condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hash><!-- exclude non executable files -->
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Metadata,Level=4,Alert=Sept 2022 Exchange 0day DLL detection,Risk=100" groupRelation="or">
        <Hash condition="contains">SHA256=074eb0e75bb2d8f59f1fd571a8c5b76f9c899834893da6f7591b68531f2b5d82</Hash><!--Exchange Zero Day Dropped DLL-->
        <Hash condition="contains">SHA256=45c8233236a69a081ee390d4faa253177180b2bd45d8ed08369e07429ffbe0a9</Hash><!--Exchange Zero Day Dropped DLL-->
        <Hash condition="contains">SHA256=9ceca98c2b24ee30d64184d9d2470f6f2509ed914dafb87604123057a14c57c0</Hash><!--Exchange Zero Day Dropped DLL-->
        <Hash condition="contains">SHA256=29b75f0db3006440651c6342dc3c0672210cfb339141c75e12f6c84d990931c3</Hash><!--Exchange Zero Day Dropped DLL-->
        <Hash condition="contains">SHA256=c8c907a67955bcdf07dd11d35f2a23498fb5ffe5c6b5d7f36870cf07da47bff2</Hash><!--Exchange Zero Day Dropped DLL-->
        <Hash condition="contains">SHA256=76a2f2644cb372f540e179ca2baa110b71de3370bb560aca65dcddbd7da3701e</Hash><!--Exchange Zero Day Dropped DLL-->
      </Rule>
      <Rule name="Attack=T1096,Technique=Alternate Data Streams,Tactic=Defense Evasion,DS=File: File Metadata,Level=0,Desc=Alternate Data Streams,Risk=10" groupRelation="and">
        <TargetFilename condition="contains any">Startup;Content.Outlook;Downloads;Recycle;\Users\;\ProgramData\;\Windows\;Temp\7z;Temp\;Startup;.vb;.vbe;.vbs;.application;.appref-ms;.bat;.cmd;.cmdline;.docm;.exe;.lnk;.eml;.dll;.sys;.hta;.pptm;.ps1;.sys;.reg;.docm;.xlsm;.xlam;.pptm;.potm;.pptm;.sldm;.scf;.appref-ms;.rdp;.vbs;.js;.pem;.crt;.ca-bundle;.cer;.csr;.der;.p7b;.p7r;.p7s;.pfx;.sto;.p12;.crl;.sst;.key;:bin;.mht;.manifest;.cpl;.scr;.inf</TargetFilename>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SysmonEnte Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
        <Hash condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hash>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SysmonQuiet Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
        <Hash condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hash>
      </Rule>
      <Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SharpEvtMute Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
        <Hash condition="contains">IMPHASH=330768a4f172e10acb6287b87289d83b</Hash>
      </Rule>
    </FileCreateStreamHash>
  </RuleGroup>
  <RuleGroup name="RG=ADS Exclude Group" groupRelation="or">
    <FileCreateStreamHash onmatch="exclude">
      <Hash condition="contains">IMPHASH=00000000000000000000000000000000</Hash>
      <TargetFilename condition="contains">AppData\Local\Microsoft\Windows\AppCache\</TargetFilename>
      <TargetFilename condition="contains">\Microsoft\Windows\INetCache\</TargetFilename>
      <TargetFilename condition="contains">\Microsoft\Windows\Temporary Internet Files\Content.IE5</TargetFilename>
      <TargetFilename condition="contains">\Mozilla\Firefox\Profiles\</TargetFilename>
      <TargetFilename condition="end with">.default\prefs-1.js</TargetFilename>
      <TargetFilename condition="end with">Microsoft\Windows\Start Menu\Programs\Startup</TargetFilename>
    </FileCreateStreamHash>
  </RuleGroup>
  <!--SYSMON EVENT ID 16 : SYSMON CONFIGURATION CHANGE-->
    <!--DATA: RuleName, UtcTime, Configuration, ConfigurationFileHash-->
    <!--COMMENT: This ONLY logs if the hash of the configuration changes. Running "sysmon.exe -c" with the current configuration will not be logged with Event 16-->
    <!--TECHNICAL: Cannot be filtered.-->

  <!--SYSMON EVENT ID 17 & 18 : PIPE CREATED / PIPE CONNECTED [PipeEvent]-->
    <!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, PipeName, Image-->
  <RuleGroup name="RG=PipeEvent Include Group" groupRelation="or">
    <PipeEvent onmatch="include">
      <Rule name="Attack=T1071,Technique=Application Layer Protocol,Tactic=Command and Control,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike named pipe detected,Risk=100" groupRelation="and">
        <PipeName condition="contains any">msagent_;\MSSE-;postex;\status_</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=NA,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Turla Advanced Persistent Threat Named Pipe Detection,Risk=100" groupRelation="and">
        <PipeName condition="contains any">\atctl;\userpipe;\iehelper;\sdlrpc;\comnap</PipeName>
      </Rule>
      <Rule name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lateral movement: psexec named pipe detected" groupRelation="or">
        <PipeName condition="contains">\PSEXESVC</PipeName>
        <PipeName condition="end with">-stdin</PipeName>
        <PipeName condition="end with">-stdout</PipeName>
      </Rule>
      <Rule name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Impacket PSExec.py Named Pipe Detected" groupRelation="and">
        <PipeName condition="contains">RemCom_</PipeName>
        <PipeName condition="contains any">stdin;stdout;stderr;communication</PipeName>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=3,Alert=MS-SCMR Execution" groupRelation="or">
        <PipeName condition="contains">\svcctl</PipeName>
      </Rule>
      <Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=3,Alert=NTSVCS Execution" groupRelation="or">
        <PipeName condition="contains">\ntsvcs</PipeName>
        <EventType condition="is">ConnectPipe</EventType>
      </Rule>
      <Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Credential Dumping Command Mimikatz,Risk=100" groupRelation="and">
        <PipeName condition="contains any">\lsadump;\cachedump;\wceservicepipe</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=9f81f59bc58452127884ce513865ed20 Named Pipe Detection,Risk=100" groupRelation="and">
        <PipeName condition="contains">\9f81f59bc58452127884ce513865ed20</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=46a676ab7f179e511e30dd2dc41bd388 Named Pipe Detection,Risk=100" groupRelation="and">
        <PipeName condition="contains">\46a676ab7f179e511e30dd2dc41bd388</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Kekeo Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">tssmp_endpoint</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=NamePipe_MoreWindows Named Pipe Detection,Risk=100,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\NamePipe_MoreWindows</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=WCEServicePipe detected,Risk=,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\WCEServicePipe</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=ahexec Named Pipe Detection,Risk=,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\ahexec</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=cachedump detected,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\cachedumppipe</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=csexec Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\csexec</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=e710f28d59aa529d6792ca6ff0ca1b34 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\e710f28d59aa529d6792ca6ff0ca1b34</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_dg2 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\isapi_dg</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_http Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\isapi_http</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_http Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\isapi_http</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lsadump detected,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\lsadump</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lsassw Named Pipe Detection,Risk=10,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\lsassw</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=paexec Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\paexec</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=pcheap_reuse Named Pipe Detection,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\pcheap_reuse</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Covanant C2 Named Pipe Detection,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\gruntsvc</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=remcom Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\remcom</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=rpchlp_3 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\rpchlp_3</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=sdlrpc Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\sdlrpc</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=winsession Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="contains">\winsession</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Turla HyperStack Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="begin with">\adschemerpc</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Hidden Cobra Hoplight Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="begin with">\AnonymousPipe</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Pacifier Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="begin with">\bc367</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Pacifier Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="begin with">\bc31a7</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Emissary Panda Hyerbri Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" groupRelation="and">
        <PipeName condition="begin with">\testPipe</PipeName>
      </Rule>
      <Rule name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Alert=lateral movement -meterpreter named pipe detected,Risk=100" groupRelation="and">
        <PipeName condition="contains">msf-pipe</PipeName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=LM or EXEC over atsvc named pipe" groupRelation="and">
        <PipeName condition="contains">\atsvc</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Malicious Named Pipe Detection 1" groupRelation="and">
        <PipeName condition="contains any">\isapi_http;\isapi_dg;\isapi_dg2;\sdlrpc;\ahexec;\winsession;\lsassw;\46a676ab7f179e511e30dd2dc41bd388;\9f81f59bc58452127884ce513865ed20;\e710f28d59aa529d6792ca6ff0ca1b34;\rpchlp_3;\NamePipe_MoreWindows;\pcheap_reuse;\gruntsvc;\583da945-62af-10e8-4902-a8f205c72b2e;\bizkaz;\Posh;\jaccdpqnvbrrxlaf;\csexecsvc</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Malicious Named Pipe Detection 2" groupRelation="and">
        <PipeName condition="contains any">\atctl;\userpipe;\iehelper;\sdlrpc;\comnap</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike Named Pipe Detection 1" groupRelation="and">
        <PipeName condition="contains any">\DserNamedPipe;\mypipe-;\windows.update.manager;\ntsvcs_;scerpc_;\demoagent;\PGMessagePipe;\MsFTeWds;\f4c3;\fullduplex_;\msrpc_;\f53f;\rpc_;\spoolss_;\win_svc;\SearchTextHarvester;demoagent_</PipeName>
        <PipeName condition="is not">\wkssvc</PipeName>
        <PipeName condition="is not">\spoolss</PipeName>
        <PipeName condition="is not">\scerpc</PipeName>
        <PipeName condition="is not">\ntsvcs</PipeName>
        <PipeName condition="is not">\SearchTextHarvester</PipeName>
        <PipeName condition="is not">\PGMessagePipe</PipeName>
        <PipeName condition="is not">\MsFteWds</PipeName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=4,Forensic=Detect suspicious named pipe connections to an AD FS WID,Author=Florian Roth" groupRelation="and">
        <EventType condition="is">ConnectPipe</EventType>
        <PipeName condition="is">\MICROSOFT##WID\tsql\query</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike Named Pipe Detection 2" groupRelation="and">
        <PipeName condition="begin with">\Winsock2\CatalogChangeListener-</PipeName>
        <PipeName condition="end with">-0,</PipeName>
      </Rule>
      <Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=EFSPotato Named Pipe Detection" groupRelation="and">
        <PipeName condition="contains any">\pipe\</PipeName>
        <PipeName condition="excludes">CtxSharefilepipe0</PipeName>
      </Rule>
      <!-- Noisy
      <PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=SMB Session Enumeration" condition="contains">\srvsvc</PipeName>
      -->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Remote Registry access and enumeration" groupRelation="and">
        <PipeName condition="contains">\winreg</PipeName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Anonymous Named Pipe Detected" groupRelation="and">
        <PipeName condition="contains">Anonymous Pipe</PipeName>
      </Rule>
      <!--Include Everything else to mark above rules-->
      <!-- Disabled for now
      <PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Uncategorized Events" condition="contains">\</PipeName>
      -->
    </PipeEvent>
  </RuleGroup>
  <RuleGroup name="RG=PipeEvent Exclude Group" groupRelation="or">
    <PipeEvent onmatch="exclude">
    <EventType name="Exclude ConnectPipe for noise reduction" condition="is">ConnectPipe</EventType>
    <!--COMMENT: Exclude known-good pipe users-->
        <!--ADDITIONAL REFERENCE: [ https://www.cobaltstrike.com/help-smb-beacon ] -->
        <!--ADDITIONAL REFERENCE: [ https://blog.cobaltstrike.com/2015/10/07/named-pipe-pivoting/ ] -->
      <!--SECTION: Microsoft-->
      <PipeName condition="contains">lsass</PipeName>
      <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
      <PipeName condition="is">\spoolss</PipeName>
      <Image name="This is noisy" condition="image">C:\Windows\system32\wbem\wmiprvse.exe</Image>
      <Image name="WSL" condition="image">C:\Windows\System32\LxRun.exe</Image>
      <Image condition="image">C:\Windows\System32\SearchIndexer.exe</Image>
      <Image condition="image">C:\Windows\System32\smss.exe</Image>
      <Image condition="image">C:\Windows\System32\spoolsv.exe</Image>
      <Image condition="image">C:\Windows\System32\wininit.exe</Image>
      <Image condition="image">C:\Windows\system32\DFSRs.exe</Image>
      <Image condition="begin with">C:\Windows\SystemApps\Microsoft.Windows</Image>
      <Rule name="ngen excludes" groupRelation="and">
        <Image condition="begin with">C:\Windows\Microsoft.NET\Framework</Image>
        <Image condition="image">ngen.exe</Image>
      </Rule>
      <Rule name="ShellExperienceHost excludes" groupRelation="and">
        <Image condition="begin with">C:\Windows\SystemApps\ShellExperienceHost_</Image>
        <Image condition="image">ShellExperienceHost.exe</Image>
      </Rule>
      <Image condition="image">C:\Windows\system32\SearchProtocolHost.exe</Image>
      <Image condition="image">\System</Image>
      <PipeName condition="contains">ProtectedPrefix\LocalService\FTHPIPE</PipeName>
      <!--SECTION: Microsoft Exchange Server -->
      <Image condition="contains">Exchange Server</Image>
      <!--SECTION: Microsoft IIS -->
      <Image condition="image">C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\BIN\OWSTIMER.EXE</Image>
      <Image condition="image">C:\Windows\syswow64\snmp.exe</Image>
      <Image condition="image">c:\windows\system32\inetsrv\w3wp.exe</Image>
      <PipeName condition="begin with">\M.E.C.Core.WinRMDataCommunicator.NamedPipe.</PipeName>
      <!--SECTION: Microsoft DNS Server -->
      <Image condition="image">C:\Windows\system32\dns.exe</Image>
      <!--SECTION: Microsoft SQL Server -->
      <PipeName condition="is">\sql\query</PipeName>
      <Image condition="image">C:\Program Files\Microsoft SQL Server\90\Shared\sqlwriter.exe</Image>
      <PipeName condition="contains">\TDLN-</PipeName>
      <PipeName condition="contains">vmware-</PipeName>
      <PipeName condition="is">\InitShutdown</PipeName>
      <PipeName condition="is">\MsFteWds</PipeName>
      <PipeName condition="is">\W32TIME_ALT</PipeName>
      <PipeName condition="is">\WiFiNetworkManagerTask</PipeName>
      <PipeName condition="is">\Winsock2CatelogChangeListener</PipeName>
      <PipeName condition="is">\browser</PipeName>
      <PipeName condition="is">\epmapper</PipeName>
      <PipeName condition="is">\eventlog</PipeName>
      <PipeName condition="is">\scerpc</PipeName>
      <PipeName condition="is">\wkssvc</PipeName>
      <PipeName condition="is">\ntapvsrq</PipeName>
      <PipeName condition="contains">Anonymous Pipe</PipeName>
    </PipeEvent>
  </RuleGroup>
  <!--SYSMON EVENT ID 19 & 20 & 21 : WMI EVENT MONITORING [WmiEvent]-->
    <!--DATA: EventType, UtcTime, Operation, User, Name, Type, Destination, Consumer, Filter-->
    <!--EVENT 19: "WmiEventFilter activity detected"-->
    <!--EVENT 20: "WmiEventConsumer activity detected"-->
    <!--EVENT 21: "WmiEventConsumerToFilter activity detected"-->
  <RuleGroup name="RG=WmiEvent Include Group" groupRelation="or">
    <WmiEvent onmatch="include">
      <Operation name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=WMI: WMI Creation" condition="is">Created</Operation>
    </WmiEvent>
  </RuleGroup>
  <!-- SYSMON EVENT ID 22 : DNS Queries-->
  <RuleGroup name="RG=DNS Query Includes" groupRelation="or">
    <DnsQuery onmatch="include">
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Powershell TXT Record exfiltration" groupRelation="and">
        <QueryResults condition="contains any">type: 16;type:  16</QueryResults>
        <Image condition="image">powershell.exe</Image>
      </Rule>
      <Rule name="Attack=T1059,Technique=Powershell,Tactic=Execution,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Powershell Connection to github" groupRelation="and">
        <QueryName condition="contains">github</QueryName>
        <Image condition="image">powershell.exe</Image>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious DNS Requests" groupRelation="and">
        <Image condition="contains any">powershell;cscript.exe;wscript.exe;mshta.exe;bitsadmin.exe;\cmd.exe</Image>
        <QueryName condition="contains">.</QueryName>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Dropbox Cloud Exfiltration" groupRelation="and">
        <QueryName condition="end with">dropboxapi.com</QueryName>
        <Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=OneDrive Cloud Exfiltration" groupRelation="and">
        <QueryName condition="contains">1drv</QueryName>
        <Image condition="excludes any">\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Box.com Cloud Exfiltration" groupRelation="and">
        <QueryName condition="contains all">.box.com;upload</QueryName>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Mega.co.nz Cloud Exfiltration" groupRelation="and">
        <QueryName condition="contains any">mega.nz;mega.co.nz</QueryName>
      </Rule>
      <Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Privatlab Cloud Exfiltration" groupRelation="and">
        <QueryName condition="contains any">privatlab.com</QueryName>
      </Rule>
      <Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Solarwinds/FireEye sunburst domains,Risk=100" groupRelation="or">
        <QueryName condition="contains any">thedoccloud.com;deftsecurity.com;websitetheme.com;highdatabase.com;incomeupdate.com;zupertech.com;panhardware.com;databasegalore.com;avsvmcloud.com;freescanonline.com</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Social Networking" groupRelation="or">
        <QueryName condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Internet Relay Chat,Risk=70" groupRelation="or">
        <QueryName condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Internet Chat,Risk=20" groupRelation="and">
        <QueryName condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Advanced IP scanner Detected,Risk=90"  groupRelation="or">
        <QueryName condition="contains any">advanced-ip-scanner.com</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Kali Linux Distribution Download/Apt URL,Risk=90"  groupRelation="or">
        <QueryName condition="contains any">kali.download</QueryName>
      </Rule>
      <!--Crypto Currency Mining pools-->
      <Rule name="Attack=T1496,Technique=Resource Hijacking,Tactic=Impact,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Crypto Currency Miner Detected,Risk=85"  groupRelation="or">
        <QueryName condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.nimpool.io;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool;analytics.blue;estream.to</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Microsoft Graph API Lookup" groupRelation="and">
        <QueryName condition="is">graph.microsoft.com</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Dropbox Download Detected" groupRelation="and">
        <QueryName condition="is">dl.dropboxusercontent.com</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=OneDrive API Lookup" groupRelation="and">
        <QueryName condition="is">api.onedrive.com</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Zoom Hostname Lookup" groupRelation="and">
        <QueryName condition="contains">zoom.us</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Teamviewer Hostname Lookup" groupRelation="and">
        <QueryName condition="contains">teamviewer</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Screenconnect Hostname Lookup" groupRelation="and">
        <QueryName condition="contains">Screenconnect</QueryName>
      </Rule>
      <!--Public Port Scan Detection-->
      <!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content" groupRelation="and">
        <QueryName condition="contains">census</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=ResearchScan DNS Query" groupRelation="and">
        <QueryName condition="contains">researchscan</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=ScanHub DNS Query" groupRelation="and">
        <QueryName condition="contains">scanhub</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Shadow DNS Query,Risk=20" groupRelation="and">
        <QueryName condition="contains">shadow</QueryName>
      </Rule>
      <Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Shodan.IO DNS Query,Risk=20" groupRelation="and">
        <QueryName condition="contains">shodan</QueryName>
      </Rule>
      <!--Domain TLD's to log-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Download TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.download</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=North Korea TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.kp</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Soviet Union TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.su</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Sudan TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.ss</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .xn DNS Query" groupRelation="and">
        <QueryName condition="end with">.xn</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Syria TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.sy</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Venezuela TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.ve</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=XXX TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.xxx</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=China TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.cn</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Click TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.click</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Club TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.club</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=IRAN TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.ir</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Russian TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.ru</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .Host DNS Query" groupRelation="and">
        <QueryName condition="end with">.host</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .ICU DNS Query" groupRelation="and">
        <QueryName condition="end with">.icu</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .PW DNS Query" groupRelation="and">
        <QueryName condition="end with">.pw</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .WEBSITE DNS Query" groupRelation="and">
        <QueryName condition="end with">.website</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .ninja DNS Query" groupRelation="and">
        <QueryName condition="end with">.ninja</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .rocks DNS Query" groupRelation="and">
        <QueryName condition="end with">.rocks</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Top TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.top</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Ukraine TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.ua</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=XYZ TLD DNS Query" groupRelation="and">
        <QueryName condition="end with">.xyz</QueryName>
      </Rule>
      <!--Malware Domains-->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious Domain,Risk=20" groupRelation="and">
        <QueryName condition="contains any">kuternull.com;rimrun.com;0ffice36o;asushotfix;infestexe;rahasn.webhop.org;rahasn.akamake.net;rahasn.homewealth.biz;winodwsupdates;israirairlines</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DNS Query to Github,Risk=20" groupRelation="and">
        <QueryName condition="contains any">githubusercontent.com;github.com</QueryName>
      </Rule>
      <!--Common Suspicious destinations-->
      <Rule name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Malware IP Check,Risk=30" groupRelation="and">
        <QueryName condition="contains any">api.ipify.org;whatismyipaddress.com;edns.ip-api.com;checkip.dyndns.org;icanhazip.com;ifconfig.me;ifconfig.co;ipaddress.com;ipecho.net;ident.me;api.ip.sb;www.myexternalip.com;ip.anysrc.net;wtfismyip.com;myexternalip.com;ipecho.net;checkip.amazonaws.com;goo.gl;git.io;bit.ly;ow.ly;ip-api.com</QueryName> <!--Malware uses to get external IP address-->
      </Rule>
      <!-- Malicious/Suspicious hosting domains-->
      <Rule name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Common Malware Hosting Domain: Tiny-share.com,Risk=30" groupRelation="and">
        <QueryName condition="contains any">tiny-share.com;paste.ee;pastebin.com</QueryName>
      </Rule>
      <!--Dynamic DNS Lookups-->
      <Rule name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=3,Alert=Dynamic DNS Query" groupRelation="and">
        <QueryName condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</QueryName>
      </Rule>
      <Rule name="Attack=T1188,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Tor2Web,Risk=100" groupRelation="and">
        <QueryName condition="contains any">darknet.to;hiddenservice.net;onion.cab;onion.city;onion.direct;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org</QueryName>
      </Rule>
      <Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DNS Over HTTPS Detected" groupRelation="and">
        <QueryName condition="contains any">adblock.mydns.network;ibksturm.synology.me;jcdns.fun;ibuki.cgnat.net;dns.twnic.tw;commons.host;doh.dnswarden.com;dns-nyc.aaflalo.me;dns.aaflalo.me;doh.appliedprivacy.net;doh.captnemo.in;doh.tiar.app;doh.tiarap.org;doh.defaultroutes.de;doh.dns.sb;dns.oszx.co;2.dnscrypt-cert.oszx.co;dnscrypt;edns.233py.com;hk-dns.233py.com;hk2dns.233py.com;hkdns.233py.com;hkdns.233py.com;ndns.233py.com;sdns.233py.com;wdns.233py.com;pastebin.com;dns.adguard.com;dns-family.adguard.com;security-filter-dns.cleanbrowsing.org;family-filter-dns.cleanbrowsing.org;adult-filter-dns.cleanbrowsing.org;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;dns.google;doh.opendns.com;dns.quad9.net;dns9.quad9.net;dns10.quad9.net;dns11.quad9.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;doh-ch.blahdns.com;doh-de.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;doh-2.seby.io;doh.seby.io;rdns.faelix.net;doh.li;doh.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DC Global Catalog Lookup" groupRelation="and">
        <QueryName condition="begin with">gc._msdcs.</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Kerberos Server Lookup" groupRelation="and">
        <QueryName condition="begin with">_kerberos._tcp.dc._msdcs.</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Kerberos Server Lookup" groupRelation="and">
        <QueryName condition="begin with">_kerberos._udp.dc._msdcs.</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Primary DC Lookup" groupRelation="and">
        <QueryName condition="begin with">_ldap._tcp.pdc._msdcs.</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Web Proxy Auto-Discovery Protocol Lookup" groupRelation="and">
        <QueryName condition="begin with">wpad</QueryName>
      </Rule>
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=3,Desc=Suspicious LDAP Lookup - Useful for identifying tools like sharphound,Risk=90" groupRelation="and">
        <QueryName condition="begin with">_ldap.</QueryName>
        <Image condition="excludes">C:\Windows\</Image>
        <Image condition="excludes">unknown process</Image>
        <Image condition="excludes all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\Windows Defender\MsMpEng.exe;C:\Windows\</Image>
      </Rule>
      <!--
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=AAAA Lookup" condition="begin with">type:  28</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=CNAME Lookup" condition="begin with">type:  5</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=MX Lookup" condition="begin with">type:  15</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Name Server" condition="begin with">type:  2</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=PTR Lookup" condition="begin with">type:  12</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SOA Lookup" condition="begin with">type:  6</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SPF Lookup" condition="begin with">type:  99</QueryResults>
      <QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SRV Lookup" condition="begin with">type:  33</QueryResults>
      -->
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=None,Information=Uncategorized Events" groupRelation="and">
        <Image condition="contains any">System;svchost.exe;services.exe;unknown process;\;;</Image>
        <Image condition="excludes any">C:\Program Files\Cavelo\Cavelo Agent\cavelo_windows_amd64.exe;C:\PROGRA~2\BEANYW~1\GETSUP~1\TCIntegratorCommHelper.exe;C:\ProgramData\Cavelo\jre\bin\java.exe;C:\Program Files\SentinelOne\;C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\agent.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\NableUpdateService.exe;C:\Program Files (x86)\N-able Technologies\Windows Software Probe\bin\wsp.exe;C:\Program Files (x86)\BeAnywhere Support Express\GetSupportService_N-Central\BASupSrvc.exe;C:\Program Files (x86)\lpagent\lpagent.exe;C:\Program Files (x86)\N-able Technologies\Windows Agent\bin\AgentMaint.exe;C:\Program Files (x86)\N-able Technologies\Reactive\bin\NableReactiveManagement.exe;C:\Program Files (x86)\N-able Technologies\AutomationManagerAgent\AutomationManager.AgentService.exe;C:\Program Files (x86)\N-able Technologies\AutomationManagerEngine\2.70.0.4\AutomationManager.ScriptRunner64.exe</Image>
      </Rule>
    </DnsQuery>
  </RuleGroup>
  <RuleGroup name="RG=DNS Query Excludes" groupRelation="or">
    <DnsQuery onmatch="exclude">
      <!-- Image Exclusions -->
      <Image condition="begin with">C:\Program Files (x86)\Admin Arsenal\</Image>
      <Image condition="begin with">C:\Program Files (x86)\CheckPoint\</Image>
      <Image condition="begin with">C:\Program Files (x86)\Fortinet\</Image>
      <Image condition="begin with">C:\Program Files\SentinelOne\</Image>
      <Image condition="begin with">C:\Program Files (x86)\OpenDNS\OpenDNS Connector</Image>
      <Image condition="begin with">C:\Program Files (x86)\Razer\Razer Services\</Image>
      <Image condition="begin with">C:\Program Files (x86)\Trend Micro\</Image>
      <Image condition="begin with">C:\Program Files (x86)\VMware</Image>
      <Image condition="begin with">C:\Program Files (x86)\Veeam\</Image>
      <Image condition="begin with">C:\Program Files\CheckPoint\</Image>
      <Image condition="begin with">C:\Program Files\Trend Micro\</Image>
      <Image condition="image">Slack.exe</Image>
      <Image condition="image">ConnectWise.exe</Image>
      <Image condition="image">git-remote-https.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Enpass\Enpass.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Fiserv\Vision\VisionGUI.NET.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Fortinet\FortiClient\update_task.exe</Image>
      <Image condition="image">C:\Program Files (x86)\Lenovo\System Update\Tvsukernel.exe</Image>
      <Image condition="image">C:\Program Files\VMware\vCenter Server\jre\bin\java.exe</Image>
      <Image condition="image">C:\Program Files\VMware\vCenter Server\python\python.exe</Image>
      <Image condition="image">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
      <Image condition="image">C:\Windows\System32\dsregcmd.exe</Image>
      <Image condition="image">C:\Windows\sysmon64.exe</Image>
      <Image condition="image">C:\Windows\sysmon.exe</Image>
      <QueryName condition="begin with">brave-sync.s3.dualstack.</QueryName>
      <QueryName condition="end with">.salesforceliveagent.com</QueryName>
      <QueryName condition="is">ads-serve.brave.com</QueryName>
      <!--Network noise-->
      <QueryName condition="end with">.msftncsi.com</QueryName> <!--Microsoft proxy detection | Microsoft default exclusion-->
      <QueryName condition="is">..localmachine</QueryName>
      <!--Microsoft-->
      <QueryName condition="end with">-pushp.svc.ms</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
      <QueryName condition="end with">.b-msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
      <QueryName condition="end with">.bing.com</QueryName> <!-- Microsoft | Microsoft default exclusion -->
      <QueryName condition="end with">.hotmail.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.live.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.live.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.microsoft.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.microsoftonline.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.microsoftstore.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.ms-acdc.office.com</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
      <QueryName condition="end with">.msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
      <QueryName condition="end with">.msn.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.msocdn.com</QueryName> <!--Microsoft-->
      <QueryName condition="end with">.s-microsoft.com</QueryName> <!--Microsoft-->
      <QueryName condition="end with">.skype.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.skype.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.windows.com</QueryName> <!--Microsoft-->
      <QueryName condition="end with">.windows.net.nsatc.net</QueryName> <!--Microsoft-->
      <QueryName condition="end with">.windowsupdate.com</QueryName> <!--Microsoft-->
      <QueryName condition="end with">.xboxlive.com</QueryName> <!--Microsoft-->
      <QueryName condition="is">login.windows.net</QueryName> <!--Microsoft-->
      <!--Microsoft:Office365/AzureAD-->
      <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName> <!--Microsoft: AzureAD-->
      <QueryName condition="end with">.msauth.net</QueryName>
      <QueryName condition="end with">.msftauth.net</QueryName>
      <QueryName condition="end with">.opinsights.azure.com</QueryName> <!--Microsoft: AzureAD/InTune client event monitoring-->
      <QueryName condition="is">management.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
      <QueryName condition="is">outlook.office365.com</QueryName> <!--Microsoft: Protected by HSTS-->
      <QueryName condition="is">portal.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
      <!--3rd-party applications-->
      <QueryName condition="end with">.mozaws.net</QueryName> <!--Mozilla-->
      <QueryName condition="end with">.mozilla.com</QueryName> <!--Mozilla-->
      <QueryName condition="end with">.mozilla.net</QueryName> <!--Mozilla-->
      <QueryName condition="end with">.mozilla.org</QueryName> <!--Mozilla-->
      <QueryName condition="end with">.spotify.com</QueryName> <!--Spotify-->
      <QueryName condition="end with">.spotify.map.fastly.net</QueryName> <!--Spotify-->
      <QueryName condition="end with">googleapis.com</QueryName> <!--Google-->
      <QueryName condition="is">clients1.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clients2.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clients3.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clients4.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clients5.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clients6.google.com</QueryName> <!--Google-->
      <QueryName condition="is">cloudsearch.googleapis.com</QueryName> <!--Google-->
      <QueryName condition="is">id.google.com</QueryName> <!--Google-->
      <QueryName condition="is">safebrowsing.googleapis.com</QueryName> <!--Google-->
      <QueryName condition="is">www.googleapis.com</QueryName> <!--Google-->
      <!--Goodlist CDN-->
      <QueryName condition="end with">.akadns.net</QueryName> <!--AkamaiCDN, extensively used by Microsoft | Microsoft default exclusion-->
      <QueryName condition="end with">.netflix.com</QueryName>
      <QueryName condition="end with">.typekit.net</QueryName> <!--Adobe fonts-->
      <QueryName condition="end with">aspnetcdn.com</QueryName> <!--Microsoft [ https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview ]-->
      <QueryName condition="is">ajax.googleapis.com</QueryName>
      <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
      <QueryName condition="is">cdnjs.cloudflare.com</QueryName> <!--Cloudflare: Hosts popular javascript libraries-->
      <QueryName condition="is">fonts.googleapis.com</QueryName> <!--Google fonts-->
      <!--Personal-->
      <QueryName condition="end with">.steamcontent.com</QueryName> <!--If you seriously host malware C2 in game binaries in Steam, I give up-->
      <!--Web resources-->
      <QueryName condition="end with">.disqus.com</QueryName> <!--Microsoft default exclusion-->
      <QueryName condition="end with">.fontawesome.com</QueryName>
      <QueryName condition="is">disqus.com</QueryName> <!--Microsoft default exclusion-->
      <!--Ads-->
      <QueryName condition="end with">.1rx.io</QueryName> <!--Ads-->
      <QueryName condition="end with">.2mdn.net</QueryName> <!--Ads: Google | Microsoft default exclusion-->
      <QueryName condition="end with">.adadvisor.net</QueryName> <!--Ads: Neustar [ https://better.fyi/trackers/adadvisor.net/ ] -->
      <QueryName condition="end with">.adap.tv</QueryName> <!--Ads:AOL | Microsoft default exclusion [ https://www.crunchbase.com/organization/adap-tv ] -->
      <QueryName condition="end with">.addthis.com</QueryName> <!--Ads:Oracle | Microsoft default exclusion [ https://en.wikipedia.org/wiki/AddThis ] -->
      <QueryName condition="end with">.adform.net</QueryName> <!--Ads-->
      <QueryName condition="end with">.adnxs.com</QueryName> <!--Ads: AppNexus | Microsoft default exclusion-->
      <QueryName condition="end with">.adroll.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.adrta.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.adsafeprotected.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.adsrvr.org</QueryName> <!--Ads-->
      <QueryName condition="end with">.advertising.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.amazon-adsystem.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.amazon-adsystem.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.analytics.yahoo.com</QueryName> <!--Ads:Yahoo-->
      <QueryName condition="end with">.aol.com</QueryName> <!--Ads | Microsoft default exclusion -->
      <QueryName condition="end with">.betrad.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.bidswitch.net</QueryName> <!--Ads-->
      <QueryName condition="end with">.casalemedia.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.chartbeat.net</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/chartbeat.com/ ]-->
      <QueryName condition="end with">.cnn.com</QueryName> <!-- Microsoft default exclusion-->
      <QueryName condition="end with">.convertro.com</QueryName> <!--Ads:Verizon-->
      <QueryName condition="end with">.criteo.com</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
      <QueryName condition="end with">.criteo.net</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
      <QueryName condition="end with">.crwdcntrl.net</QueryName> <!--Ads: Lotame [ https://better.fyi/trackers/crwdcntrl.net/ ] -->
      <QueryName condition="end with">.demdex.net</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.domdex.com</QueryName>
      <QueryName condition="end with">.dotomi.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.doubleclick.net</QueryName> <!--Ads:Conversant | Microsoft default exclusion [ https://www.crunchbase.com/organization/dotomi ] -->
      <QueryName condition="end with">.doubleverify.com</QueryName> <!--Ads: Google-->
      <QueryName condition="end with">.emxdgt.com</QueryName> <!--Ads: EMX-->
      <QueryName condition="end with">.exelator.com</QueryName> <!--Ads:Nielson Marketing Cloud-->
      <QueryName condition="end with">.google-analytics.com</QueryName> <!--Ads:Google | Microsoft default exclusion-->
      <QueryName condition="end with">.googleadservices.com</QueryName> <!--Google-->
      <QueryName condition="end with">.googlesyndication.com</QueryName> <!--Ads:Google, sometimes called during malicious ads, but not directly responsible | Microsoft default exclusion [ https://www.hackread.com/wp-content/uploads/2018/06/Bitdefender-Whitepaper-Zacinlo.pdf ]-->
      <QueryName condition="end with">.googletagmanager.com</QueryName> <!--Google-->
      <QueryName condition="end with">.googlevideo.com</QueryName> <!--Google | Microsoft default exclusion-->
      <QueryName condition="end with">.gstatic.com</QueryName> <!--Google | Microsoft default exclusion-->
      <QueryName condition="end with">.gvt1.com</QueryName> <!--Google-->
      <QueryName condition="end with">.gvt2.com</QueryName> <!--Google-->
      <QueryName condition="end with">.ib-ibi.com</QueryName> <!--Ads: Offerpath [ https://better.fyi/trackers/ib-ibi.com/ ] -->
      <QueryName condition="end with">.jivox.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.mathtag.com</QueryName> <!--Microsoft default exclusion-->
      <QueryName condition="end with">.moatads.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.moatpixel.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.mookie1.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.myvisualiq.net</QueryName> <!--Ads-->
      <QueryName condition="end with">.netmng.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.nexac.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.nexac.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.openx.net</QueryName> <!--Ads-->
      <QueryName condition="end with">.optimizely.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.outbrain.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.pardot.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.phx.gbl</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.pinterest.com</QueryName> <!--Pinerest-->
      <QueryName condition="end with">.pubmatic.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.quantcount.com</QueryName>
      <QueryName condition="end with">.quantserve.com</QueryName>
      <QueryName condition="end with">.revsci.net</QueryName> <!--Ads:Omniture | Microsoft default exclusion-->
      <QueryName condition="end with">.rfihub.net</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.rlcdn.com</QueryName> <!--Ads: Rapleaf [ https://better.fyi/trackers/rlcdn.com/ ] -->
      <QueryName condition="end with">.rubiconproject.com</QueryName> <!--Ads: Rubicon Project | Microsoft default exclusion [ https://better.fyi/trackers/rubiconproject.com/ ] -->
      <QueryName condition="end with">.scdn.co</QueryName> <!--Spotify-->
      <QueryName condition="end with">.scorecardresearch.com</QueryName> <!--Ads: Comscore | Microsoft default exclusion-->
      <QueryName condition="end with">.serving-sys.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.sharethrough.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.simpli.fi</QueryName>
      <QueryName condition="end with">.sitescout.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.smartadserver.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.snapads.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.spotxchange.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.taboola.com</QueryName> <!--Ads:Taboola-->
      <QueryName condition="end with">.taboola.map.fastly.net</QueryName> <!--Ads:Taboola-->
      <QueryName condition="end with">.tapad.com</QueryName>
      <QueryName condition="end with">.tidaltv.com</QueryName> <!--Ads: Videology [ https://better.fyi/trackers/tidaltv.com/ ] -->
      <QueryName condition="end with">.trafficmanager.net</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.tremorhub.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.tribalfusion.com</QueryName> <!--Ads: Exponential [ https://better.fyi/trackers/tribalfusion.com/ ] -->
      <QueryName condition="end with">.turn.com</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/turn.com/ ] -->
      <QueryName condition="end with">.twimg.com</QueryName> <!--Ads | Microsoft default exclusion-->
      <QueryName condition="end with">.tynt.com</QueryName> <!--Ads-->
      <QueryName condition="end with">.w55c.net</QueryName> <!--Ads:dataxu-->
      <QueryName condition="end with">.ytimg.com</QueryName> <!--Google-->
      <QueryName condition="end with">.zorosrv.com</QueryName> <!--Ads:Taboola-->
      <QueryName condition="end with">ads.yahoo.com</QueryName> <!--Ads: Yahoo-->
      <QueryName condition="is">1rx.io</QueryName>
      <QueryName condition="is">adservice.google.com</QueryName> <!--Google-->
      <QueryName condition="is">ampcid.google.com</QueryName> <!--Google-->
      <QueryName condition="is">clientservices.googleapis.com</QueryName> <!--Google-->
      <QueryName condition="is">d29x207vrinatv.cloudfront.net</QueryName> <!--Amazon-developed applications-->
      <QueryName condition="is">googleadapis.l.google.com</QueryName> <!--Google-->
      <QueryName condition="is">imasdk.googleapis.com</QueryName> <!--Google [ https://developers.google.com/interactive-media-ads/docs/sdks/html5/ ] -->
      <QueryName condition="is">l.google.com</QueryName> <!--Google-->
      <QueryName condition="is">ml314.com</QueryName> <!--Ads-->
      <QueryName condition="is">mtalk.google.com</QueryName> <!--Google-->
      <QueryName condition="is">update.googleapis.com</QueryName> <!--Google-->
      <QueryName condition="is">www.googletagservices.com</QueryName>
      <!--SocialNet-->
      <QueryName condition="end with">.pscp.tv</QueryName> <!--Twitter:Periscope-->
      <!--OSCP/CRL Common-->
      <QueryName condition="contains">adsniper.ru</QueryName>
      <QueryName condition="contains">cdnvideo.ru</QueryName>
      <QueryName condition="contains">chat.minergate.com</QueryName>
      <QueryName condition="contains">cwsa.minergate.com</QueryName>
      <QueryName condition="contains">forum.minergate.com</QueryName>
      <QueryName condition="contains">leadlab.click</QueryName>
      <QueryName condition="contains">mc.yandex.ru</QueryName>
      <QueryName condition="contains">pool.ntp.org</QueryName>
      <QueryName condition="contains">vmg.host</QueryName>
      <QueryName condition="contains">yandex.ru</QueryName>
      <QueryName condition="end with">.adobe.com</QueryName>
      <QueryName condition="end with">.autodesk.com</QueryName>
      <QueryName condition="end with">.avast.com</QueryName>
      <QueryName condition="end with">.avcdn.net</QueryName>
      <QueryName condition="end with">.cdn.bitdefender.net</QueryName>
      <QueryName condition="end with">.digicert.com</QueryName>
      <QueryName condition="end with">.eset.com</QueryName>
      <QueryName condition="end with">.globalsign.com</QueryName>
      <QueryName condition="end with">.globalsign.net</QueryName>
      <QueryName condition="end with">.intuit.com</QueryName>
      <QueryName condition="end with">.java.com</QueryName>
      <QueryName condition="end with">.macromedia.com</QueryName>
      <QueryName condition="end with">.oracle.com</QueryName>
      <QueryName condition="end with">.quickbooks.com</QueryName>
      <QueryName condition="end with">.usertrust.com</QueryName>
      <QueryName condition="end with">amazontrust.com</QueryName>
      <QueryName condition="end with">ocsp.identrust.com</QueryName>
      <QueryName condition="end with">pki.goog</QueryName>
      <QueryName condition="is">ads.playground.xyz</QueryName>
      <QueryName condition="is">citrixupdates.cloud.com</QueryName>
      <QueryName condition="is">forticlient.fortinet.net</QueryName>
      <QueryName condition="is">mft10.onbaseonline.com</QueryName>
      <QueryName condition="is">msocsp.com</QueryName> <!--Microsoft:OCSP-->
      <QueryName condition="is">ocsp.comodoca.com</QueryName>
      <QueryName condition="is">ocsp.cybertrust.ne.jp</QueryName>
      <QueryName condition="is">ocsp.entrust.net</QueryName>
      <QueryName condition="is">ocsp.entrust.net</QueryName>
      <QueryName condition="is">ocsp.godaddy.com</QueryName>
      <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
      <QueryName condition="is">ocsp.intel.com</QueryName>
      <QueryName condition="is">ocsp.msocsp.com</QueryName> <!--Microsoft:OCSP-->
      <QueryName condition="is">ocsp.quovadisglobal.com</QueryName>
      <QueryName condition="is">ocsp.quovadisoffshore.com</QueryName>
      <QueryName condition="is">ocsp.sectigo.com</QueryName>
      <QueryName condition="is">ocsp.starfieldtech.com</QueryName>
      <QueryName condition="is">ocsp.thawte.com</QueryName>
      <QueryName condition="is">ocsp.trustwave.com</QueryName>
      <QueryName condition="is">ocsp.verisign.com</QueryName>
      <QueryName condition="is">pki-goog.l.google.com</QueryName>
      <QueryName condition="is">pki.intel.com</QueryName>
      <QueryName condition="is">scrootca1.ocsp.secomtrust.net</QueryName>
      <QueryName condition="is">scrootca2.ocsp.secomtrust.net</QueryName>
      <QueryName condition="is">stats.anchor.host</QueryName>
      <QueryName condition="is">status.rapidssl.com</QueryName>
      <QueryName condition="is">status.thawte.com</QueryName>
      <QueryName condition="is">ts-ocsp.ws.symantec.com</QueryName>
      <QueryName condition="is">upgrade.bitdefender.com</QueryName>
    </DnsQuery>
  </RuleGroup>
  <!-- SYSMON EVENT ID 23 : File Delete and overwrite events which saves a copy to the archivedir: Includes -->
    <!-- TECHNICAL: Default set to disabled due to disk space implications, enable with care!-->
  <RuleGroup groupRelation="or">
    <FileDelete onmatch="include" />
  </RuleGroup>
  <!-- SYSMON EVENT ID 24 : Clipboard change events, only captures text, not files: Includes -->
    <!-- TECHNICAL: Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
  <RuleGroup groupRelation="or">
    <ClipboardChange onmatch="include" />
  </RuleGroup>
  <!--SYSMON EVENT ID 25 : Process tampering events-->
  <RuleGroup name="RG=Process Tampering Includes" groupRelation="or">
    <ProcessTampering onmatch="include">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Process Tampering Detected" groupRelation="and">
        <Image condition="contains any">.;&gt;;unknown;anonymous</Image>
        <Image condition="excludes">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="excludes">C:\Program Files (x86)\Symantec\</Image>
        <Image condition="excludes">C:\Program Files\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="excludes">C:\Program Files\Symantec\</Image>
      </Rule>
    </ProcessTampering>
  </RuleGroup>
  <RuleGroup name="RG=Process Tampering Excludes" groupRelation="or">
    <ProcessTampering onmatch="exclude">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=exclude common noise" groupRelation="and">
        <Image condition="contains any">\BHO\ie_to_edge_stub.exe;\Microsoft\Teams\;\Vivaldi\Application\;Google\Chrome\;Google\Update;BraveSoftware\Brave-Browser\;Edge\Application\;EdgeUpdate\Install\;Program Files\SmartGit\</Image>
      </Rule>
    </ProcessTampering>
  </RuleGroup>
  <!-- SYSMON EVENT ID 26 : File Delete and overwrite events, does NOT save the file: Includes -->
  <RuleGroup groupRelation="or">
    <FileDeleteDetected onmatch="include">
      <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
      <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
      <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
      <Rule groupRelation="and">
        <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>
        <TargetFilename condition="contains">.txt</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
      <Rule groupRelation="and">
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
        <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
      </Rule>
    </FileDeleteDetected>
  </RuleGroup>
  <RuleGroup groupRelation="or">
    <FileDeleteDetected onmatch="exclude">
      <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
      <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
      <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
    </FileDeleteDetected>
  </RuleGroup>
  <!-- SYSMON EVENT ID 29 : File Executable Detected -->
    <!-- DATA: ProcessGuid, ProcessId, User, Image, TargetFilename, Hashes -->
    <!-- COMMENT: Key Authors in this section are Florian Roth as a majority Contributer from: https://github.com/Neo23x0/sysmon-config/blob/master/sysmonconfig-export.xml -->
  <RuleGroup name="RG=FileExecutable Includes" groupRelation="or">
    <FileExecutableDetected onmatch="include">
      <Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Exe created within Downloads Folder,Risk=10" groupRelation="and">
        <TargetFilename condition="begin with">C:\Users\</TargetFilename>
        <TargetFilename condition="contains">\Downloads</TargetFilename>
      </Rule>
      <Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Executed files within Outlook Attachments,Risk=30" groupRelation="and">
        <Image condition="begin with">C:\Users\</Image>
        <Image condition="contains">Content.Outlook</Image>
      </Rule>
      <Rule name="Attack=T1036.008,Technique=Masquerading: Masquerade File Type,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Pe File Detected under Unusual File extension,Risk=10" groupRelation="and">
        <TargetFilename condition="not end with">.exe</TargetFilename>
        <TargetFilename condition="not end with">.dll</TargetFilename>
        <TargetFilename condition="not end with">.sys</TargetFilename>
        <TargetFilename condition="not end with">.ocx</TargetFilename>
        <TargetFilename condition="not end with">.scr</TargetFilename>
        <TargetFilename condition="not end with">.cpl</TargetFilename>
        <TargetFilename condition="not end with">.efi</TargetFilename>
        <TargetFilename condition="not end with">.drv</TargetFilename>
        <TargetFilename condition="not end with">.ax</TargetFilename>
        <TargetFilename condition="not end with">.com</TargetFilename>
        <TargetFilename condition="not end with">.acm</TargetFilename>
        <TargetFilename condition="not end with">.mui</TargetFilename>
        <TargetFilename condition="not end with">.ime</TargetFilename>
        <TargetFilename condition="not end with">.tsp</TargetFilename>
      </Rule>
      <Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=,Risk=10,Alert=Powershell Creating Executables" groupRelation="and">
        <Image condition="is any">powershell.exe;powershell_ise.exe;pwsh.exe;Sqlps.exe</Image>
      </Rule>
      <Rule name="Attack=T1059.003,Technique=Command and Scripting Interpreter: Windows Command Shell,Tactic=Execution,DS=File: File Creation,Level=0,Alert=Command or consolehost Anomaly,Risk=10" groupRelation="and">
        <Image condition="is any">cmd.exe;conhost.exe</Image>
      </Rule>
      <Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Pe File Detected within Unusual Location,Risk=10,Author=Florian Roth" groupRelation="or">
        <TargetFilename condition="begin with">C:\Users\Public\</TargetFilename> <!-- often used staging directories; could cause false positives -->
        <TargetFilename condition="begin with">C:\Perflogs\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\Fonts\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\debug\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\tracing\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\Help\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\Logs\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\System32\spool\SERVERS\</TargetFilename> <!-- often used in exploits against print spooler -->
        <TargetFilename condition="begin with">C:\Windows\System32\spool\PRINTERS\</TargetFilename> <!-- often used in exploits against print spooler -->
        <TargetFilename condition="begin with">C:\Windows\Help\</TargetFilename> <!-- often used staging directories -->
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\chocolatey\</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\All Users\</TargetFilename> <!-- often used staging directories in User folders -->
        <TargetFilename condition="contains all">C:\Users\;\Music\</TargetFilename> <!-- often used staging directories in User folders -->
        <TargetFilename condition="contains all">C:\Users\;\Pictures\</TargetFilename> <!-- often used staging directories in User folders -->
        <TargetFilename condition="contains all">C:\Users\;\Videos\</TargetFilename> <!-- often used staging directories in User folders -->
        <TargetFilename condition="contains all">C:\Users\;\Contacts\</TargetFilename> <!-- often used staging directories in User folders -->
      </Rule>
      <Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Double File Extension Detected,Risk=10,Author=Florian Roth" groupRelation="or">
        <TargetFilename condition="end with">.7z.exe</TargetFilename>
        <TargetFilename condition="end with">.doc.exe</TargetFilename>
        <TargetFilename condition="end with">.docm.exe</TargetFilename>
        <TargetFilename condition="end with">.docx.exe</TargetFilename>
        <TargetFilename condition="end with">.htm.exe</TargetFilename>
        <TargetFilename condition="end with">.html.exe</TargetFilename>
        <TargetFilename condition="end with">.iso.exe</TargetFilename>
        <TargetFilename condition="end with">.lnk.exe</TargetFilename>
        <TargetFilename condition="end with">.pdf.exe</TargetFilename>
        <TargetFilename condition="end with">.ppt.exe</TargetFilename>
        <TargetFilename condition="end with">.pptx.exe</TargetFilename>
        <TargetFilename condition="end with">.rar.exe</TargetFilename>
        <TargetFilename condition="end with">.rtf.exe</TargetFilename>
        <TargetFilename condition="end with">.txt.exe</TargetFilename>
        <TargetFilename condition="end with">.xls.exe</TargetFilename>
        <TargetFilename condition="end with">.xlsm.exe</TargetFilename>
        <TargetFilename condition="end with">.xlsx.exe</TargetFilename>
        <TargetFilename condition="end with">.zip.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Sysmon Tampering Tools Detected,Risk=10,Author=Florian Roth" groupRelation="or">
        <TargetFilename condition="end with">\EntenLoader.exe</TargetFilename>
        <TargetFilename condition="end with">\SysmonQuiet.exe</TargetFilename>
        <TargetFilename condition="end with">\SharpEvtMute.exe</TargetFilename>
        <TargetFilename condition="end with">\EvtMuteHook.dll</TargetFilename>
        <TargetFilename condition="end with">\SysmonEOP.exe</TargetFilename>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=User Execution: Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Sysmon Tampering Tools Detected,Risk=10,Author=Florian Roth" groupRelation="or">
        <Hashes condition="contains">IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932</Hashes> <!-- PetitPotam -->
        <Hashes condition="contains">IMPHASH=3A19059BD7688CB88E70005F18EFC439</Hashes> <!-- PetitPotam -->
        <Hashes condition="contains">IMPHASH=bf6223a49e45d99094406777eb6004ba</Hashes> <!-- PetitPotam -->
        <Hashes condition="contains">IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=4C1B52A19748428E51B14C278D0F58E3</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=672B13F4A0B6F27D29065123FE882DFC</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=9528A0E91E28FBB88AD433FEABCA2456</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=D21BBC50DCC169D7B4D0F01962793154</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6</Hashes> <!-- Mimikatz -->
        <Hashes condition="contains">IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1</Hashes> <!-- JuicyPotato  -->
        <Hashes condition="contains">IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC</Hashes> <!-- JuicyPotato  -->
        <Hashes condition="contains">IMPHASH=F9A28C458284584A93B14216308D31BD</Hashes> <!-- JuicyPotatoNG -->
        <Hashes condition="contains">IMPHASH=6118619783FC175BC7EBECFF0769B46E</Hashes> <!-- RoguePotato -->
        <Hashes condition="contains">IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA</Hashes> <!-- RoguePotato -->
        <Hashes condition="contains">IMPHASH=563233BFA169ACC7892451F71AD5850A</Hashes> <!-- RoguePotato -->
        <Hashes condition="contains">IMPHASH=87575CB7A0E0700EB37F2E3668671A08</Hashes> <!-- RoguePotato -->
        <Hashes condition="contains">IMPHASH=13F08707F759AF6003837A150A371BA1</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=1781F06048A7E58B323F0B9259BE798B</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=713C29B396B907ED71A72482759ED757</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=8B114550386E31895DFAB371E741123D</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793</Hashes> <!-- PwDumpX -->
        <Hashes condition="contains">IMPHASH=9D68781980370E00E0BD939EE5E6C141</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=B18A1401FF8F444056D29450FBC0A6CE</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=CB567F9498452721D77A451374955F5F</Hashes> <!-- Pwdump -->
        <Hashes condition="contains">IMPHASH=730073214094CD328547BF1F72289752</Hashes> <!-- Htran -->
        <Hashes condition="contains">IMPHASH=17B461A082950FC6332228572138B80C</Hashes> <!-- Cobalt Strike beacons -->
        <Hashes condition="contains">IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9</Hashes> <!-- Cobalt Strike beacons -->
        <Hashes condition="contains">IMPHASH=819B19D53CA6736448F9325A85736792</Hashes> <!-- Cobalt Strike beacons -->
        <Hashes condition="contains">IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E</Hashes> <!-- Cobalt Strike beacons -->
        <Hashes condition="contains">IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74</Hashes> <!-- PPLDump -->
        <Hashes condition="contains">IMPHASH=0588081AB0E63BA785938467E1B10CCA</Hashes> <!-- PPLDump -->
        <Hashes condition="contains">IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=4DA924CF622D039D58BCE71CDF05D242</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=E7A3A5C377E2D29324093377D7DB1C66</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=E6F9D5152DA699934B30DAAB206471F6</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=3AD59991CCF1D67339B319B15A41B35D</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=FFDD59E0318B85A3E480874D9796D872</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=0CF479628D7CC1EA25EC7998A92F5051</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=D6D0F80386E1380D05CB78E871BC72B1</Hashes> <!-- NanoDump -->
        <Hashes condition="contains">IMPHASH=38D9E015591BBFD4929E0D0F47FA0055</Hashes> <!-- HandleKatz -->
        <Hashes condition="contains">IMPHASH=0E2216679CA6E1094D63322E3412D650</Hashes> <!-- HandleKatz -->
        <Hashes condition="contains">IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB</Hashes> <!-- DripLoader -->
        <Hashes condition="contains">IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798</Hashes> <!-- DripLoader -->
        <Hashes condition="contains">IMPHASH=11083E75553BAAE21DC89CE8F9A195E4</Hashes> <!-- DripLoader -->
        <Hashes condition="contains">IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80</Hashes> <!-- DripLoader -->
        <Hashes condition="contains">IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F</Hashes> <!-- CreateMiniDump -->
        <Hashes condition="contains">IMPHASH=767637C23BB42CD5D7397CF58B0BE688</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=14C4E4C72BA075E9069EE67F39188AD8</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=7D010C6BB6A3726F327F7E239166D127</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=89159BA4DD04E4CE5559F132A9964EB3</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=5834ED4291BDEB928270428EBBAF7604</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=3DE09703C8E79ED2CA3F01074719906B</Hashes> <!-- UACMe Akagi -->
        <Hashes condition="contains">IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F</Hashes> <!-- WCE -->
        <Hashes condition="contains">IMPHASH=E96A73C7BF33A464C510EDE582318BF2</Hashes> <!-- WCE -->
        <Hashes condition="contains">IMPHASH=32089B8851BBF8BC2D014E9F37288C83</Hashes> <!-- Sliver Stagers -->
        <Hashes condition="contains">IMPHASH=09D278F9DE118EF09163C6140255C690</Hashes> <!-- Dumpert -->
        <Hashes condition="contains">IMPHASH=03866661686829d806989e2fc5a72606</Hashes> <!-- Dumpert -->
        <Hashes condition="contains">IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d</Hashes> <!-- Dumpert -->
        <Hashes condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hashes> <!-- SysmonEnte -->
        <Hashes condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hashes> <!-- SysmonQuiet -->
        <Hashes condition="contains">IMPHASH=330768A4F172E10ACB6287B87289D83B</Hashes> <!-- ShaprEvtMute Hook -->
        <Hashes condition="contains">IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313</Hashes> <!-- Forkatz -->
        <Hashes condition="contains">IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC</Hashes> <!-- PPLKiller -->
        <Hashes condition="contains">IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28</Hashes> <!-- PPLKiller -->
        <Hashes condition="contains">IMPHASH=96DF3A3731912449521F6F8D183279B1</Hashes> <!-- Backstab -->
        <Hashes condition="contains">IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46</Hashes> <!-- Backstab -->
        <Hashes condition="contains">IMPHASH=51791678F351C03A0EB4E2A7B05C6E17</Hashes> <!-- Backstab -->
        <Hashes condition="contains">IMPHASH=25CE42B079282632708FC846129E98A5</Hashes> <!-- Forensia -->
        <Hashes condition="contains">MD5=7B17F15713FCF13C764535AA2BDF52AA</Hashes>                          <!-- ShaprEvtMute -->
        <Hashes condition="contains">SHA1=4E18320493042BCD7D21B53E258974BC460ACC78</Hashes>                    <!-- ShaprEvtMute -->
        <Hashes condition="contains">SHA256=477DFE485F5BD9540CC83E88FC04AAFB6DE49CF1ADC6BD857D5D6F4C1730A6D1</Hashes>  <!-- ShaprEvtMute -->
      </Rule>
      <Rule name="Attack=T1204.002,Technique=User Execution: Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Microsoft Office Dropping Executables,Risk=10,Author=Florian Roth" groupRelation="or">
        <Image condition="image">winword.exe</Image>
        <Image condition="image">excel.exe</Image>
        <Image condition="image">powerpnt.exe</Image>
        <Image condition="image">msaccess.exe</Image>
        <Image condition="image">mspub.exe</Image>
        <Image condition="image">eqnedt32.exe</Image>
        <Image condition="image">visio.exe</Image>
        <Image condition="image">wordpad.exe</Image>
        <Image condition="image">wordview.exe</Image>
        <Image condition="image">msohtmed.exe</Image>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=User Execution: Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=OneNote Dropping Executables,Risk=10,Author=Florian Roth" groupRelation="or">
        <Image condition="image">onenote.exe</Image>
        <Image condition="image">onenotem.exe</Image>
        <Image condition="image">onenoteim.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=LOLBin Dropping Executables,Risk=10,Author=Florian Roth" groupRelation="or">
        <!-- LOLBINs that can be used to download executables -->
        <Image condition="image">certutil.exe</Image>
        <Image condition="image">certoc.exe</Image>
        <Image condition="image">CertReq.exe</Image>
        <!-- <Image condition="image">bitsadmin.exe</Image> (depends on the environment; comment in if you're sure that bitsadmin doesn't do that in your env) -->
        <Image condition="image">Desktopimgdownldr.exe</Image>
        <Image condition="image">esentutl.exe</Image>
        <!-- <Image condition="image">expand.exe</Image> (depends on the environment; comment in if you're sure that expand doesn't do that in your env) -->
        <Image condition="image">finger.exe</Image>
        <!-- Executables that should never drop an executable to disk (but may after a previous process injection or if it's malware that uses a legitimate name)-->
        <Image condition="image">notepad.exe</Image>
        <Image condition="image">AcroRd32.exe</Image>
        <Image condition="image">RdrCEF.exe</Image> <!-- RdrCEF was seen dropping a DLL in temp (Example: \AppData\Local\Temp\acrocef_low\4616_1623006624_platform_specific\win_x86\widevinecdm.dll). Comment out this entry if you experience issues (https://github.com/Neo23x0/sysmon-config/issues/43) -->
        <Image condition="image">calc.exe</Image>
        <Image condition="image">mspaint.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.01,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Compiled HTML File Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">hh.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.002,Technique=System Binary Proxy Execution: Control Panel,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Control Panel Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">control.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.003,Technique=System Binary Proxy Execution: CMSTP,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=CMSTP Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">CMSTP.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.004,Technique=System Binary Proxy Execution: InstallUtil,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=InstallUtil Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">installutil.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.005,Technique=System Binary Proxy Execution: Mshta,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=MSHTA Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">mshta.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.007,Technique=System Binary Proxy Execution: MSIExec,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=MSIExec Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">msiexec.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.008,Technique=System Binary Proxy Execution: Odbcconf,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Odbcconf Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">Odbcconf.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.009,Technique=System Binary Proxy Execution: Regsvcs/Regasm,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Regsvcs/Regasm Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="contains any">Regsvcs.exe;Regasm.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.010,Technique=System Binary Proxy Execution: Regsvr32,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Regsvr32 Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">regsvr32.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.011,Technique=System Binary Proxy Execution: Rundll32,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Rundll32 Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">Rundll32.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.012,Technique=System Binary Proxy Execution: Verclsid,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Verclsid Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">Verclsid.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.013,Technique=System Binary Proxy Execution: mavinject,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Mavinject Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="contains any">mavinject.exe;mavinject64.exe</Image>
      </Rule>
      <Rule name="Attack=T1218.014,Technique=System Binary Proxy Execution: MMC,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=MMC Dropping Executables,Risk=10" groupRelation="and">
        <Image condition="image">mmc.exe</Image>
      </Rule>
      <Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation,Level=4,Alert=Other LOLBins Dropping Executables,Risk=10" groupRelation="or">
        <Image condition="contains any">Appvlp.exe;InfDefaultInstall.EXE;PresentationHost.exe;Register-cimprovider.exe;RegisterCimProvider2.exe;RegisterCimProvider.exe;ScriptRunner.exe;appcmd.exe;csi.exe;devtoolslauncher.exe;diskshadow.exe;extexport.exe;jjs.exe;msconfig.EXE;msdt.exe;rasautou.exe;rasdlui.exe;replace.exe;tttracer.exe;wab.exe;wsreset.exe</Image>
      </Rule>
      <Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=4,Alert=Vulnerable Driver Detected,Risk=10,Author=Florian Roth" groupRelation="or">
        <Hashes condition="contains">SHA256=7ad0ab23023bc500c3b46f414a8b363c5f8700861bc4745cecc14dd34bcee9ed</Hashes>
        <Hashes condition="contains">SHA256=0aafa9f47acf69d46c9542985994ff5321f00842a28df2396d4a3076776a83cb</Hashes>
        <Hashes condition="contains">SHA256=0ae8d1dd56a8a000ced74a627052933d2e9bff31d251de185b3c0c5fc94a44db</Hashes>
        <Hashes condition="contains">SHA256=0af5ccb3d33a9ba92071c9637be6254030d61998733a5eb3583e865e17844e05</Hashes>
        <Hashes condition="contains">SHA256=0b2ad05939b0aabbdc011082fad7960baa0c459ec16a2b29f37c1fa31795a46d</Hashes>
        <Hashes condition="contains">SHA256=0b542e47248611a1895018ec4f4033ea53464f259c74eb014d018b19ad818917</Hashes>
        <Hashes condition="contains">SHA256=0bc3685b0b8adc97931b5d31348da235cd7581a67edf6d79913e6a5709866135</Hashes>
        <Hashes condition="contains">SHA256=0be4912bfd7a79f6ebfa1c06a59f0fb402bd4fe0158265780509edd0e562eac1</Hashes>
        <Hashes condition="contains">SHA256=0c512b615eac374d4d494e3c36838d8e788b3dc2691bf27916f7f42694b14467</Hashes>
        <Hashes condition="contains">SHA256=0cd4ca335155062182608cad9ef5c8351a715bce92049719dd09c76422cd7b0c</Hashes>
        <Hashes condition="contains">SHA256=0ce40a2cdd3f45c7632b858e8089ddfdd12d9acb286f2015a4b1b0c0346a572c</Hashes>
        <Hashes condition="contains">SHA256=0cf6c6c2d231eaf67dfc87561cc9a56ecef89ab50baafee5a67962748d51faf3</Hashes>
        <Hashes condition="contains">SHA256=0d3790af5f8e5c945410929e31d06144a471ac82f828afe89a4758a5bbeb7f9f</Hashes>
        <Hashes condition="contains">SHA256=0da746e49fd662be910d0e366934a7e02898714eaaa577e261ab40eb44222b5c</Hashes>
        <Hashes condition="contains">SHA256=0de4247e72d378713bcf22d5c5d3874d079203bb4364e25f67a90d5570bdcce8</Hashes>
        <Hashes condition="contains">SHA256=0e53b58415fa68552928622118d5b8a3a851b2fc512709a90b63ba46acda8b6b</Hashes>
        <Hashes condition="contains">SHA256=0ebaef662b14410c198395b13347e1d175334ec67919709ad37d65eba013adff</Hashes>
        <Hashes condition="contains">SHA256=0ee5067ce48883701824c5b1ad91695998916a3702cf8086962fbe58af74b2d6</Hashes>
        <Hashes condition="contains">SHA256=0f016c80c4938fbcd47a47409969b3925f54292eba2ce01a8e45222ce8615eb8</Hashes>
        <Hashes condition="contains">SHA256=0f17e5cfc5bdd74aff91bfb1a836071345ba2b5d1b47b0d5bf8e7e0d4d5e2dbf</Hashes>
        <Hashes condition="contains">SHA256=0f035948848432bc243704041739e49b528f35c82a5be922d9e3b8a4c44398ff</Hashes>
        <Hashes condition="contains">SHA256=0fd2df82341bf5ebb8a53682e60d08978100c01acb0bed7b6ce2876ada80f670</Hashes>
        <Hashes condition="contains">SHA256=01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd</Hashes>
        <Hashes condition="contains">SHA256=01e024cb14b34b6d525c642a710bfa14497ea20fd287c39ba404b10a8b143ece</Hashes>
        <Hashes condition="contains">SHA256=1a4f7d7926efc3e3488758ce318246ea78a061bde759ec6c906ff005dd8213e5</Hashes>
        <Hashes condition="contains">SHA256=1a42ebde59e8f63804eaa404f79ee93a16bb33d27fb158c6bfbe6143226899a0</Hashes>
        <Hashes condition="contains">SHA256=1aaa9aef39cb3c0a854ecb4ca7d3b213458f302025e0ec5bfbdef973cca9111c</Hashes>
        <Hashes condition="contains">SHA256=1aaf4c1e3cb6774857e2eef27c17e68dc1ae577112e4769665f516c2e8c4e27b</Hashes>
        <Hashes condition="contains">SHA256=1afa03118f87b62c59a97617e595ebb26dde8dbdd16ee47ef3ddd1097c30ef6a</Hashes>
        <Hashes condition="contains">SHA256=1b00d6e5d40b1b84ca63da0e99246574cdd2a533122bc83746f06c0d66e63a6e</Hashes>
        <Hashes condition="contains">SHA256=1b7fb154a7b7903a3c81f12f4b094f24a3c60a6a8cffca894c67c264ab7545fa</Hashes>
        <Hashes condition="contains">SHA256=1c8dfa14888bb58848b4792fb1d8a921976a9463be8334cff45cc96f1276049a</Hashes>
        <Hashes condition="contains">SHA256=1c1251784e6f61525d0082882a969cb8a0c5d5359be22f5a73e3b0cd38b51687</Hashes>
        <Hashes condition="contains">SHA256=1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8</Hashes>
        <Hashes condition="contains">SHA256=1ddfe4756f5db9fb319d6c6da9c41c588a729d9e7817190b027b38e9c076d219</Hashes>
        <Hashes condition="contains">SHA256=1e0eb0811a7cf1bdaf29d3d2cab373ca51eb8d8b58889ab7728e2d3aed244abe</Hashes>
        <Hashes condition="contains">SHA256=1e8b0c1966e566a523d652e00f7727d8b0663f1dfdce3b9a09b9adfaef48d8ee</Hashes>
        <Hashes condition="contains">SHA256=1e16a01ef44e4c56e87abfbe03b2989b0391b172c3ec162783ad640be65ab961</Hashes>
        <Hashes condition="contains">SHA256=1ee59eb28688e73d10838c66e0d8e011c8df45b6b43a4ac5d0b75795ca3eb512</Hashes>
        <Hashes condition="contains">SHA256=1f4d4db4abe26e765a33afb2501ac134d14cadeaa74ae8a0fae420e4ecf58e0c</Hashes>
        <Hashes condition="contains">SHA256=1f8168036d636aad1680dd0f577ef9532dbb2dad3591d63e752b0ba3ee6fd501</Hashes>
        <Hashes condition="contains">SHA256=2a6db9facf9e13d35c37dd468be04bae5f70c6127a9aee76daebddbdec95d486</Hashes>
        <Hashes condition="contains">SHA256=2a9d481ffdc5c1e2cb50cf078be32be06b21f6e2b38e90e008edfc8c4f2a9c4e</Hashes>
        <Hashes condition="contains">SHA256=2a652de6b680d5ad92376ad323021850dab2c653abf06edf26120f7714b8e08a</Hashes>
        <Hashes condition="contains">SHA256=2a6212f3b68a6f263e96420b3607b31cfdfe51afff516f3c87d27bf8a89721e8</Hashes>
        <Hashes condition="contains">SHA256=2aa1b08f47fbb1e2bd2e4a492f5d616968e703e1359a921f62b38b8e4662f0c4</Hashes>
        <Hashes condition="contains">SHA256=2afdb3278a7b57466a103024aef9ff7f41c73a19bab843a8ebf3d3c4d4e82b30</Hashes>
        <Hashes condition="contains">SHA256=2b4c7d3820fe08400a7791e2556132b902a9bbadc1942de57077ecb9d21bf47a</Hashes>
        <Hashes condition="contains">SHA256=2b120de80a5462f8395cfb7153c86dfd44f29f0776ea156ec4a34fa64e5c4797</Hashes>
        <Hashes condition="contains">SHA256=2b186926ed815d87eaf72759a69095a11274f5d13c33b8cc2b8700a1f020be1d</Hashes>
        <Hashes condition="contains">SHA256=2bbc6b9dd5e6d0327250b32305be20c89b19b56d33a096522ee33f22d8c82ff1</Hashes>
        <Hashes condition="contains">SHA256=2bbe65cbec3bb069e92233924f7ee1f95ffa16173fceb932c34f68d862781250</Hashes>
        <Hashes condition="contains">SHA256=2bf29a2df52110ed463d51376562afceac0e80fbb1033284cf50edd86c406b14</Hashes>
        <Hashes condition="contains">SHA256=2ce81759bfa236913bbbb9b2cbc093140b099486fd002910b18e2c6e31fdc4f1</Hashes>
        <Hashes condition="contains">SHA256=2d2c7ee9547738a8a676ab785c151e8b48ed40fe7cf6174650814c7f5f58513b</Hashes>
        <Hashes condition="contains">SHA256=2d83ccb1ad9839c9f5b3f10b1f856177df1594c66cbbc7661677d4b462ebf44d</Hashes>
        <Hashes condition="contains">SHA256=2d195cd4400754cc6f6c3f8ab1fe31627932c3c1bf8d5d0507c292232d1a2396</Hashes>
        <Hashes condition="contains">SHA256=2da330a2088409efc351118445a824f11edbe51cf3d653b298053785097fe40e</Hashes>
        <Hashes condition="contains">SHA256=2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8</Hashes>
        <Hashes condition="contains">SHA256=2e665962c827ce0adbd29fe6bcf09bbb1d7a7022075d162ff9b65d0af9794ac0</Hashes>
        <Hashes condition="contains">SHA256=2ef7df384e93951893b65500dac6ee09da6b8fe9128326caad41b8be4da49a1e</Hashes>
        <Hashes condition="contains">SHA256=2f60536b25ba8c9014e4a57d7a9a681bd3189fa414eea88c256d029750e15cae</Hashes>
        <Hashes condition="contains">SHA256=2fbbc276737047cb9b3ba5396756d28c1737342d89dce1b64c23a9c4513ae445</Hashes>
        <Hashes condition="contains">SHA256=03e0581432f5c8cc727a8aa387f5b69ff84d38d0df6f1226c19c6e960a81e1e9</Hashes>
        <Hashes condition="contains">SHA256=3a5ec83fe670e5e23aef3afa0a7241053f5b6be5e6ca01766d6b5f9177183c25</Hashes>
        <Hashes condition="contains">SHA256=3a65d14fd3b1b5981084cdbd293dc6f4558911ea18dd80177d1e5b54d85bcaa0</Hashes>
        <Hashes condition="contains">SHA256=3a95cc82173032b82a0ffc7d2e438df64c13bc16b4574214c9fe3be37250925e</Hashes>
        <Hashes condition="contains">SHA256=3ac5e01689a3d745e60925bc7faca8d4306ae693e803b5e19c94906dc30add46</Hashes>
        <Hashes condition="contains">SHA256=3b6e85c8fed9e39b21b2eab0b69bc464272b2c92961510c36e2e2df7aa39861b</Hashes>
        <Hashes condition="contains">SHA256=3c5d7069f85ec1d6f58147431f88c4d7c48df73baf94ffdefd664f2606baf09c</Hashes>
        <Hashes condition="contains">SHA256=3c6f9917418e991ed41540d8d882c8ca51d582a82fd01bff6cdf26591454faf5</Hashes>
        <Hashes condition="contains">SHA256=3c7e5b25a33a7805c999d318a9523fcae46695a89f55bbdb8bb9087360323dfc</Hashes>
        <Hashes condition="contains">SHA256=3c18ae965fba56d09a65770b4d8da54ccd7801f979d3ebd283397bc99646004b</Hashes>
        <Hashes condition="contains">SHA256=3c4207c90c97733fae2a08679d63fbbe94dfcf96fdfdf88406aa7ab3f80ea78f</Hashes>
        <Hashes condition="contains">SHA256=3cb75429944e60f6c820c7638adbf688883ad44951bca3f8912428afe72bc134</Hashes>
        <Hashes condition="contains">SHA256=3d9e83b189fcf5c3541c62d1f54a0da0a4e5b62c3243d2989afc46644056c8e3</Hashes>
        <Hashes condition="contains">SHA256=3d23bdbaf9905259d858df5bf991eb23d2dc9f4ecda7f9f77839691acef1b8c4</Hashes>
        <Hashes condition="contains">SHA256=3e1d47a497babbfd1c83905777b517ec87c65742bee7eb57a2273eca825d2272</Hashes>
        <Hashes condition="contains">SHA256=3e07bb866d329a2f9aaa4802bad04fdac9163de9bf9cfa1d035f5ca610b4b9bf</Hashes>
        <Hashes condition="contains">SHA256=3e9b62d2ea2be50a2da670746c4dbe807db9601980af3a1014bcd72d0248d84c</Hashes>
        <Hashes condition="contains">SHA256=3e274df646f191d2705c0beaa35eeea84808593c3b333809f13632782e27ad75</Hashes>
        <Hashes condition="contains">SHA256=3ec5ad51e6879464dfbccb9f4ed76c6325056a42548d5994ba869da9c4c039a8</Hashes>
        <Hashes condition="contains">SHA256=3f2fda9a7a9c57b7138687bbce49a2e156d6095dddabb3454ea09737e02c3fa5</Hashes>
        <Hashes condition="contains">SHA256=3f9530c94b689f39cc83377d76979d443275012e022782a600dcb5cad4cca6aa</Hashes>
        <Hashes condition="contains">SHA256=3fa6379951f08ed3cb87eeba9cf0c5f5e1d0317dcfcf003b810df9d795eeb73e</Hashes>
        <Hashes condition="contains">SHA256=3ff50c67d51553c08dcb7c98342f68a0f54ad6658c5346c428bdcd1f185569f6</Hashes>
        <Hashes condition="contains">SHA256=3ff39728f1c11d1108f65ec5eb3d722fd1a1279c530d79712e0d32b34880baaa</Hashes>
        <Hashes condition="contains">SHA256=04a85e359525d662338cae86c1e59b1d7aa9bd12b920e8067503723dc1e03162</Hashes>
        <Hashes condition="contains">SHA256=4a3d4db86f580b1680d6454baee1c1a139e2dde7d55e972ba7c92ec3f555dce2</Hashes>
        <Hashes condition="contains">SHA256=4a9093e8dbcb867e1b97a0a67ce99a8511900658f5201c34ffb8035881f2dbbe</Hashes>
        <Hashes condition="contains">SHA256=4ab41816abbf14d59e75b7fad49e2cb1c1feb27a3cb27402297a2a4793ff9da7</Hashes>
        <Hashes condition="contains">SHA256=4b4c925c3b8285aeeab9b954e8b2a0773b4d2d0e18d07d4a9d268f4be90f6cae</Hashes>
        <Hashes condition="contains">SHA256=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1</Hashes>
        <Hashes condition="contains">SHA256=4bc0921ffd4acc865525d3faf98961e8decc5aec4974552cbbf2ae8d5a569de4</Hashes>
        <Hashes condition="contains">SHA256=4cff6e53430b81ecc4fae453e59a0353bcfe73dd5780abfc35f299c16a97998e</Hashes>
        <Hashes condition="contains">SHA256=4d19ee789e101e5a76834fb411aadf8229f08b3ece671343ad57a6576a525036</Hashes>
        <Hashes condition="contains">SHA256=4d0580c20c1ba74cf90d44c82d040f0039542eea96e4bbff3996e6760f457cee</Hashes>
        <Hashes condition="contains">SHA256=4da08c0681fbe028b60a1eaf5cb8890bd3eba4d0e6a8b976495ddcd315e147ba</Hashes>
        <Hashes condition="contains">SHA256=4e3eb5b9bce2fd9f6878ae36288211f0997f6149aa8c290ed91228ba4cdfae80</Hashes>
        <Hashes condition="contains">SHA256=4e37592a2a415f520438330c32cfbdbd6af594deef5290b2fa4b9722b898ff69</Hashes>
        <Hashes condition="contains">SHA256=05f052c64d192cf69a462a5ec16dda0d43ca5d0245900c9fcb9201685a2e7748</Hashes>
        <Hashes condition="contains">SHA256=5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a</Hashes>
        <Hashes condition="contains">SHA256=5ae23f1fcf3fb735fcf1fa27f27e610d9945d668a149c7b7b0c84ffd6409d99a</Hashes>
        <Hashes condition="contains">SHA256=5b3705b47dc15f2b61ca3821b883b9cd114d83fcc3344d11eb1d3df495d75abe</Hashes>
        <Hashes condition="contains">SHA256=5b9623da9ba8e5c80c49473f40ffe7ad315dcadffc3230afdc9d9226d60a715a</Hashes>
        <Hashes condition="contains">SHA256=5bd41a29cbba0d24e639f49d1f201b9bd119b11f5e3b8a5fefa3a5c6f1e7692c</Hashes>
        <Hashes condition="contains">SHA256=5c0b429e5935814457934fa9c10ac7a88e19068fa1bd152879e4e9b89c103921</Hashes>
        <Hashes condition="contains">SHA256=5c04c274a708c9a7d993e33be3ea9e6119dc29527a767410dbaf93996f87369a</Hashes>
        <Hashes condition="contains">SHA256=5cfad3d473961763306d72c12bd5ae14183a1a5778325c9acacca764b79ca185</Hashes>
        <Hashes condition="contains">SHA256=5d530e111400785d183057113d70623e17af32931668ab7c7fc826f0fd4f91a3</Hashes>
        <Hashes condition="contains">SHA256=5ee292b605cd3751a24e5949aae615d472a3c72688632c3040dc311055b75a92</Hashes>
        <Hashes condition="contains">SHA256=5f5e5f1c93d961985624768b7c676d488c7c7c1d4c043f6fc1ea1904fefb75be</Hashes>
        <Hashes condition="contains">SHA256=5f7e47d728ac3301eb47b409801a0f4726a435f78f1ed02c30d2a926259c71f3</Hashes>
        <Hashes condition="contains">SHA256=5f69d6b167a1eeca3f6ac64785c3c01976ee7303171faf998d65852056988683</Hashes>
        <Hashes condition="contains">SHA256=5f6547e9823f94c5b94af1fb69a967c4902f72b6e0c783804835e6ce27f887b0</Hashes>
        <Hashes condition="contains">SHA256=5f20541f859f21b3106e12d37182b1ea39bb75ffcfcddb2ece4f6edd42c0bab2</Hashes>
        <Hashes condition="contains">SHA256=5f487829527802983d5c120e3b99f3cf89333ca14f5e49ac32df0798cfb1f7aa</Hashes>
        <Hashes condition="contains">SHA256=5fad3775feb8b6f6dcbd1642ae6b6a565ff7b64eadfc9bf9777918b51696ab36</Hashes>
        <Hashes condition="contains">SHA256=06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50</Hashes>
        <Hashes condition="contains">SHA256=6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5</Hashes>
        <Hashes condition="contains">SHA256=6b830ea0db6546a044c9900d3f335e7820c2a80e147b0751641899d1a5aa8f74</Hashes>
        <Hashes condition="contains">SHA256=6befa481e8cca8084d9ec3a1925782cd3c28ef7a3e4384e034d48deaabb96b63</Hashes>
        <Hashes condition="contains">SHA256=6bfc0f425de9f4e7480aa2d1f2e08892d0553ed0df1c31e9bf3d8d702f38fa2e</Hashes>
        <Hashes condition="contains">SHA256=6c7120e40fc850e4715058b233f5ad4527d1084a909114fd6a36b7b7573c4a44</Hashes>
        <Hashes condition="contains">SHA256=6c64688444d3e004da77dcfb769d064bb38afceeef7ff915dfc71e60e19ff18a</Hashes>
        <Hashes condition="contains">SHA256=6cb6e23ba516570bbd158c32f7c7c99f19b24ca4437340ecb39253662afe4293</Hashes>
        <Hashes condition="contains">SHA256=6cb51ae871fbd5d07c5aad6ff8eea43d34063089528603ca9ceb8b4f52f68ddc</Hashes>
        <Hashes condition="contains">SHA256=6de84caa2ca18673e01b91af58220c60aecd5cccf269725ec3c7f226b2167492</Hashes>
        <Hashes condition="contains">SHA256=6e0aa67cfdbe27a059cbd066443337f81c5b6d37444d14792d1c765d9d122dcf</Hashes>
        <Hashes condition="contains">SHA256=6e944ae1bfe43a8a7cd2ea65e518a30172ce8f31223bdfd39701b2cb41d8a9e7</Hashes>
        <Hashes condition="contains">SHA256=6ed35f310c96920a271c59a097b382da07856e40179c2a4239f8daa04eef38e7</Hashes>
        <Hashes condition="contains">SHA256=6f1fc8287dd8d724972d7a165683f2b2ad6837e16f09fe292714e8e38ecd1e38</Hashes>
        <Hashes condition="contains">SHA256=6f1ff29e2e710f6d064dc74e8e011331d807c32cc2a622cbe507fd4b4d43f8f4</Hashes>
        <Hashes condition="contains">SHA256=6f55c148bb27c14408cf0f16f344abcd63539174ac855e510a42d78cfaec451c</Hashes>
        <Hashes condition="contains">SHA256=6fb5bc9c51f6872de116c7db8a2134461743908efc306373f6de59a0646c4f5d</Hashes>
        <Hashes condition="contains">SHA256=6ffdde6bc6784c13c601442e47157062941c47015891e7139c2aaba676ab59cc</Hashes>
        <Hashes condition="contains">SHA256=07b6d69bafcfd767f1b63a490a8843c3bb1f8e1bbea56176109b5743c8f7d357</Hashes>
        <Hashes condition="contains">SHA256=7a48f92a9c2d95a72e18055cac28c1e7e6cad5f47aa735cbea5c3b82813ccfaf</Hashes>
        <Hashes condition="contains">SHA256=7aaf2aa194b936e48bc90f01ee854768c8383c0be50cfb41b346666aec0cf853</Hashes>
        <Hashes condition="contains">SHA256=7b0f442ac0bb183906700097d65aed0b4b9d8678f9a01aca864854189fe368e7</Hashes>
        <Hashes condition="contains">SHA256=7c731c0ea7f28671ab7787800db69739ea5cd6be16ea21045b4580cf95cbf73b</Hashes>
        <Hashes condition="contains">SHA256=7cb497abc44aad09a38160d6a071db499e05ff5871802ccc45d565d242026ee7</Hashes>
        <Hashes condition="contains">SHA256=7cb594af6a3655daebc9fad9c8abf2417b00ba31dcd118707824e5316fc0cc21</Hashes>
        <Hashes condition="contains">SHA256=7cc9ba2df7b9ea6bb17ee342898edd7f54703b93b6ded6a819e83a7ee9f938b4</Hashes>
        <Hashes condition="contains">SHA256=7cfa5e10dff8a99a5d544b011f676bc383991274c693e21e3af40cf6982adb8c</Hashes>
        <Hashes condition="contains">SHA256=7d8937c18d6e11a0952e53970a0934cf0e65515637ac24d6ca52ccf4b93d385f</Hashes>
        <Hashes condition="contains">SHA256=7d43769b353d63093228a59eb19bba87ce6b552d7e1a99bf34a54eee641aa0ea</Hashes>
        <Hashes condition="contains">SHA256=7da6113183328d4fddf6937c0c85ef65ba69bfe133b1146193a25bcf6ae1f9dd</Hashes>
        <Hashes condition="contains">SHA256=7dfc2eb033d2e090540860b8853036f40736d02bd22099ff6cf665a90be659cd</Hashes>
        <Hashes condition="contains">SHA256=7e3b0b8d3e430074109d85729201d7c34bc5b918c0bcb9f64ce88c5e37e1a456</Hashes>
        <Hashes condition="contains">SHA256=7e81beae78e1ddbf6c150e15667e1f18783f9b0ab7fbe52c7ab63e754135948d</Hashes>
        <Hashes condition="contains">SHA256=7e0124fcc7c95fdc34408cf154cb41e654dade8b898c71ad587b2090b1da30d7</Hashes>
        <Hashes condition="contains">SHA256=7ec93f34eb323823eb199fbf8d06219086d517d0e8f4b9e348d7afd41ec9fd5d</Hashes>
        <Hashes condition="contains">SHA256=7f5dc63e5742096e4accaca39ae77a2a2142b438c10f97860dee4054b51d3b35</Hashes>
        <Hashes condition="contains">SHA256=7f190f6e5ab0edafd63391506c2360230af4c2d56c45fc8996a168a1fc12d457</Hashes>
        <Hashes condition="contains">SHA256=7f375639a0df7fe51e5518cf87c3f513c55bc117db47d28da8c615642eb18bfa</Hashes>
        <Hashes condition="contains">SHA256=08eb2d2aa25c5f0af4e72a7e0126735536f6c2c05e9c7437282171afe5e322c6</Hashes>
        <Hashes condition="contains">SHA256=8b92cdb91a2e2fab3881d54f5862e723826b759749f837a11c9e9d85d52095a2</Hashes>
        <Hashes condition="contains">SHA256=8bda0108de82ebeae82f43108046c5feb6f042e312fa0115475a9e32274fae59</Hashes>
        <Hashes condition="contains">SHA256=8c95d28270a4a314299cf50f05dcbe63033b2a555195d2ad2f678e09e00393e6</Hashes>
        <Hashes condition="contains">SHA256=8c748ae5dcc10614cc134064c99367d28f3131d1f1dda0c9c29e99279dc1bdd9</Hashes>
        <Hashes condition="contains">SHA256=8cb62c5d41148de416014f80bd1fd033fd4d2bd504cb05b90eeb6992a382d58f</Hashes>
        <Hashes condition="contains">SHA256=8cf0cbbdc43f9b977f0fb79e0a0dd0e1adabe08a67d0f40d727c717c747de775</Hashes>
        <Hashes condition="contains">SHA256=8cfd5b2102fbc77018c7fe6019ec15f07da497f6d73c32a31f4ba07e67ec85d9</Hashes>
        <Hashes condition="contains">SHA256=8d57e416ea4bb855b78a2ff3c80de1dfbb5dc5ee9bfbdddb23e46bd8619287e2</Hashes>
        <Hashes condition="contains">SHA256=8e5aef7c66c0e92dfc037ee29ade1c8484b8d7fadebdcf521d2763b1d8215126</Hashes>
        <Hashes condition="contains">SHA256=8e88cb80328c3dbaa2752591692e74a2fae7e146d7d8aabc9b9ac9a6fe561e6c</Hashes>
        <Hashes condition="contains">SHA256=8e6363a6393eb4234667c6f614b2072e33512866b3204f8395bbe01530d63f2f</Hashes>
        <Hashes condition="contains">SHA256=8ef0ad86500094e8fa3d9e7d53163aa6feef67c09575c169873c494ed66f057f</Hashes>
        <Hashes condition="contains">SHA256=8f68ca89910ebe9da3d02ec82d935de1814d79c44f36cd30ea02fa49ae488f00</Hashes>
        <Hashes condition="contains">SHA256=8f23313adb35782adb0ba97fefbfbb8bbc5fc40ae272e07f6d4629a5305a3fa2</Hashes>
        <Hashes condition="contains">SHA256=8fe9828bea83adc8b1429394db7a556a17f79846ad0bfb7f242084a5c96edf2a</Hashes>
        <Hashes condition="contains">SHA256=09b0e07af8b17db1d896b78da4dd3f55db76738ee1f4ced083a97d737334a184</Hashes>
        <Hashes condition="contains">SHA256=09bedbf7a41e0f8dabe4f41d331db58373ce15b2e9204540873a1884f38bdde1</Hashes>
        <Hashes condition="contains">SHA256=9a1d66036b0868bbb1b2823209fedea61a301d5dd245f8e7d390bd31e52d663e</Hashes>
        <Hashes condition="contains">SHA256=9a54ef5cfbe6db599322967ee2c84db7daabcb468be10a3ccfcaa0f64d9173c7</Hashes>
        <Hashes condition="contains">SHA256=9a91d6e83b8fdec536580f6617f10dfc64eedf14ead29a6a644eb154426622ba</Hashes>
        <Hashes condition="contains">SHA256=9a95a70f68144980f2d684e96c79bdc93ebca1587f46afae6962478631e85d0c</Hashes>
        <Hashes condition="contains">SHA256=9a523854fe84f15efc1635d7f5d3e71812c45d6a4d2c99c29fdc4b4d9c84954c</Hashes>
        <Hashes condition="contains">SHA256=9b1ac756e35f795dd91adbc841e78db23cb7165280f8d4a01df663128b66d194</Hashes>
        <Hashes condition="contains">SHA256=9b2f051ac901ab47d0012a1002cb8b2db28c14e9480c0dd55e1ac11c81ba9285</Hashes>
        <Hashes condition="contains">SHA256=9b6a84f7c40ea51c38cc4d2e93efb3375e9d98d4894a85941190d94fbe73a4e4</Hashes>
        <Hashes condition="contains">SHA256=9c10e2ec4f9ef591415f9a784b93dc9c9cdafa7c69602c0dc860c5b62222e449</Hashes>
        <Hashes condition="contains">SHA256=9d5ebd0f4585ec20a5fe3c5276df13ece5a2645d3d6f70cedcda979bd1248fc2</Hashes>
        <Hashes condition="contains">SHA256=9d58f640c7295952b71bdcb456cae37213baccdcd3032c1e3aeb54e79081f395</Hashes>
        <Hashes condition="contains">SHA256=9dab4b6fddc8e1ec0a186aa8382b184a5d52cfcabaaf04ff9e3767021eb09cf4</Hashes>
        <Hashes condition="contains">SHA256=9ee33ffd80611a13779df6286c1e04d3c151f1e2f65e3d664a08997fcd098ef3</Hashes>
        <Hashes condition="contains">SHA256=9f4ce6ab5e8d44f355426d9a6ab79833709f39b300733b5b251a0766e895e0e5</Hashes>
        <Hashes condition="contains">SHA256=9f1229cd8dd9092c27a01f5d56e3c0d59c2bb9f0139abf042e56f343637fda33</Hashes>
        <Hashes condition="contains">SHA256=9f1025601d17945c3a47026814bdec353ee363966e62dba7fe2673da5ce50def</Hashes>
        <Hashes condition="contains">SHA256=9fc29480407e5179aa8ea41682409b4ea33f1a42026277613d6484e5419de374</Hashes>
        <Hashes condition="contains">SHA256=11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5</Hashes>
        <Hashes condition="contains">SHA256=11d258e05b850dcc9ecfacccc9486e54bd928aaa3d5e9942696c323fdbd3481b</Hashes>
        <Hashes condition="contains">SHA256=12eda8b65ed8c1d80464a0c535ea099dffdb4981c134294cb0fa424efc85ee56</Hashes>
        <Hashes condition="contains">SHA256=14adbf0bc43414a7700e5403100cff7fc6ade50bebfab16a17acf2fdda5a9da8</Hashes>
        <Hashes condition="contains">SHA256=15c53eb3a0ea44bbd2901a45a6ebeae29bb123f9c1115c38dfb2cdbec0642229</Hashes>
        <Hashes condition="contains">SHA256=15fb486b6b8c2a2f1b067f48fba10c2f164638fe5e6cee618fb84463578ecac9</Hashes>
        <Hashes condition="contains">SHA256=16a2e578bc8683f17a175480fea4f53c838cfae965f1d4caa47eaf9e0b3415c1</Hashes>
        <Hashes condition="contains">SHA256=18deed37f60b6aa8634dda2565a0485452487d7bce88afb49301a7352db4e506</Hashes>
        <Hashes condition="contains">SHA256=18e1707b319c279c7e0204074088cc39286007a1cf6cb6e269d5067d8d0628c6</Hashes>
        <Hashes condition="contains">SHA256=19a212e6fc324f4cb9ee5eba60f5c1fc0191799a4432265cbeaa3307c76a7fc0</Hashes>
        <Hashes condition="contains">SHA256=19bf0d0f55d2ad33ef2d105520bde8fb4286f00e9d7a721e3c9587b9408a0775</Hashes>
        <Hashes condition="contains">SHA256=19d0fc91b70d7a719f7a28b4ad929f114bf1de94a4c7cba5ad821285a4485da0</Hashes>
        <Hashes condition="contains">SHA256=20f11a64bc4548f4edb47e3d3418da0f6d54a83158224b71662a6292bf45b5fb</Hashes>
        <Hashes condition="contains">SHA256=21ccdd306b5183c00ecfd0475b3152e7d94b921e858e59b68a03e925d1715f21</Hashes>
        <Hashes condition="contains">SHA256=22be050955347661685a4343c51f11c7811674e030386d2264cd12ecbf544b7c</Hashes>
        <Hashes condition="contains">SHA256=23ba19352b1e71a965260bf4d5120f0200709ee8657ed381043bec9a938a1ade</Hashes>
        <Hashes condition="contains">SHA256=025e7be9fcefd6a83f4471bba0c11f1c11bd5047047d26626da24ee9a419cdc4</Hashes>
        <Hashes condition="contains">SHA256=26c28746e947389856543837aa59a5b1f4697e5721a04d00aa28151a2659b097</Hashes>
        <Hashes condition="contains">SHA256=26e3bfef255efd052a84c3c43994c73222b14c95db9a4b1fc2e98f1a5cb26e43</Hashes>
        <Hashes condition="contains">SHA256=26f41e4268be59f5de07552b51fa52d18d88be94f8895eb4a16de0f3940cf712</Hashes>
        <Hashes condition="contains">SHA256=27cd05527feb020084a4a76579c125458571da8843cdfc3733211760a11da970</Hashes>
        <Hashes condition="contains">SHA256=29a90ae1dcee66335ece4287a06482716530509912be863c85a2a03a6450a5b6</Hashes>
        <Hashes condition="contains">SHA256=29e0062a017a93b2f2f5207a608a96df4d554c5de976bd0276c2590a03bd3e94</Hashes>
        <Hashes condition="contains">SHA256=30abc0cc700fdebc74e62d574addc08f6227f9c7177d9eaa8cbc37d5c017c9bb</Hashes>
        <Hashes condition="contains">SHA256=31d8fc6f5fb837d5eb29db828d13ba8ee11867d86a90b2c2483a578e1d0ec43a</Hashes>
        <Hashes condition="contains">SHA256=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427</Hashes>
        <Hashes condition="contains">SHA256=31f4140c12ac31f5729a8de4dc051d3acd07783564604df831a2a6722c979192</Hashes>
        <Hashes condition="contains">SHA256=32cccc4f249499061c0afa18f534c825d01034a1f6815f5506bf4c4ff55d1351</Hashes>
        <Hashes condition="contains">SHA256=32e1a8513eee746d17eb5402fb9d8ff9507fb6e1238e7ff06f7a5c50ff3df993</Hashes>
        <Hashes condition="contains">SHA256=34bee22c18ddbddbe115cf1ab55cabf0e482aba1eb2c343153577fb24b7226d3</Hashes>
        <Hashes condition="contains">SHA256=34e0364a4952d914f23f271d36e11161fb6bb7b64aea22ff965a967825a4a4bf</Hashes>
        <Hashes condition="contains">SHA256=36aafa127736c7226c50061ea065f71e14f64ec60321f705bc52686d24117e0d</Hashes>
        <Hashes condition="contains">SHA256=36b9e31240ab0341873c7092b63e2e0f2cab2962ebf9b25271c3a1216b7669eb</Hashes>
        <Hashes condition="contains">SHA256=36e3127f045ef1fa7426a3ff8c441092d3b66923d2b69826034e48306609e289</Hashes>
        <Hashes condition="contains">SHA256=37c637a74bf20d7630281581a8fae124200920df11ad7cd68c14c26cc12c5ec9</Hashes>
        <Hashes condition="contains">SHA256=37dde6bd8a7a36111c3ac57e0ac20bbb93ce3374d0852bcacc9a2c8c8c30079e</Hashes>
        <Hashes condition="contains">SHA256=38b3eb8c86201d26353aab625cea672e60c2f66ce6f5e5eda673e8c3478bf305</Hashes>
        <Hashes condition="contains">SHA256=38bb9751a3a1f072d518afe6921a66ee6d5cf6d25bc50af49e1925f20d75d4d7</Hashes>
        <Hashes condition="contains">SHA256=38c18db050b0b2b07f657c03db1c9595febae0319c746c3eede677e21cd238b0</Hashes>
        <Hashes condition="contains">SHA256=38d87b51f4b69ba2dae1477684a1415f1a3b578eee5e1126673b1beaefee9a20</Hashes>
        <Hashes condition="contains">SHA256=38fa0c663c8689048726666f1c5e019feaa9da8278f1df6ff62da33961891d2a</Hashes>
        <Hashes condition="contains">SHA256=39cfde7d401efce4f550e0a9461f5fc4d71fa07235e1336e4f0b4882bd76550e</Hashes>
        <Hashes condition="contains">SHA256=42e170a7ab1d2c160d60abfc906872f9cfd0c2ee169ed76f6acb3f83b3eeefdb</Hashes>
        <Hashes condition="contains">SHA256=42f0b036687cbd7717c9efed6991c00d4e3e7b032dc965a2556c02177dfdad0f</Hashes>
        <Hashes condition="contains">SHA256=43ba8d96d5e8e54cab59d82d495eeca730eeb16e4743ed134cdd495c51a4fc89</Hashes>
        <Hashes condition="contains">SHA256=45abdbcd4c0916b7d9faaf1cd08543a3a5178871074628e0126a6eda890d26e0</Hashes>
        <Hashes condition="contains">SHA256=45ba688a4bded8a7e78a4f5b0dc21004e951ddceb014bb92f51a3301d2fbc56a</Hashes>
        <Hashes condition="contains">SHA256=45c3d607cb57a1714c1c604a25cbadf2779f4734855d0e43aa394073b6966b26</Hashes>
        <Hashes condition="contains">SHA256=45f42c5d874369d6be270ea27a5511efcca512aeac7977f83a51b7c4dee6b5ef</Hashes>
        <Hashes condition="contains">SHA256=47eaebc920ccf99e09fc9924feb6b19b8a28589f52783327067c9b09754b5e84</Hashes>
        <Hashes condition="contains">SHA256=47f0cdaa2359a63ad1389ef4a635f1f6eee1f63bdf6ef177f114bdcdadc2e005</Hashes>
        <Hashes condition="contains">SHA256=47f08f7d30d824a8f4bb8a98916401a37c0fd8502db308aba91fe3112b892dcc</Hashes>
        <Hashes condition="contains">SHA256=49ed27460730b62403c1d2e4930573121ab0c86c442854bc0a62415ca445a810</Hashes>
        <Hashes condition="contains">SHA256=49f75746eebe14e5db11706b3e58accc62d4034d2f1c05c681ecef5d1ad933ba</Hashes>
        <Hashes condition="contains">SHA256=50d5eaa168c077ce5b7f15b3f2c43bd2b86b07b1e926c1b332f8cb13bd2e0793</Hashes>
        <Hashes condition="contains">SHA256=50db5480d0392a7dd6ab5df98389dc24d1ed1e9c98c9c35964b19dabcd6dc67f</Hashes>
        <Hashes condition="contains">SHA256=51e91dd108d974ae809e5fc23f6fbd16e13f672f86aa594dae4a5c4bc629b0b5</Hashes>
        <Hashes condition="contains">SHA256=53eaefba7e7dca9ab74e385abf18762f9f1aa51594e7f7db5ba612d6c787dd7e</Hashes>
        <Hashes condition="contains">SHA256=55a1535e173c998fbbc978009b02d36ca0c737340d84ac2a8da73dfc2f450ef9</Hashes>
        <Hashes condition="contains">SHA256=55fee54c0d0d873724864dc0b2a10b38b7f40300ee9cae4d9baaf8a202c4049a</Hashes>
        <Hashes condition="contains">SHA256=56a3c9ac137d862a85b4004f043d46542a1b61c6acb438098a9640469e2d80e7</Hashes>
        <Hashes condition="contains">SHA256=57a389da784269bb2cc0a258500f6dfbf4f6269276e1192619ce439ec77f4572</Hashes>
        <Hashes condition="contains">SHA256=58a74dceb2022cd8a358b92acd1b48a5e01c524c3b0195d7033e4bd55eff4495</Hashes>
        <Hashes condition="contains">SHA256=58c071cfe72e9ee867bba85cbd0abe72eb223d27978d6f0650d0103553839b59</Hashes>
        <Hashes condition="contains">SHA256=59b09bd69923c0b3de3239e73205b1846a5f69043546d471b259887bb141d879</Hashes>
        <Hashes condition="contains">SHA256=60b163776e7b95e0c2280d04476304d0c943b484909131f340e3ce6045a49289</Hashes>
        <Hashes condition="contains">SHA256=60c6f4f34c7319cb3f9ca682e59d92711a05a2688badbae4891b1303cd384813</Hashes>
        <Hashes condition="contains">SHA256=61a1bdddd3c512e681818debb5bee94db701768fc25e674fcad46592a3259bd0</Hashes>
        <Hashes condition="contains">SHA256=61befeef14783eb0fed679fca179d2f5c33eb2dcbd40980669ca2ebeb3bf11cf</Hashes>
        <Hashes condition="contains">SHA256=61d6e40601fa368800980801a662a5b3b36e3c23296e8ae1c85726a56ef18cc8</Hashes>
        <Hashes condition="contains">SHA256=62f5e13b2edc00128716cb93e6a9eddffea67ce83d2bb426f18f5be08ead89e0</Hashes>
        <Hashes condition="contains">SHA256=64f9e664bc6d4b8f5f68616dd50ae819c3e60452efd5e589d6604b9356841b57</Hashes>
        <Hashes condition="contains">SHA256=65c26276cadda7a36f8977d1d01120edb5c3418be2317d501761092d5f9916c9</Hashes>
        <Hashes condition="contains">SHA256=65db1b259e305a52042e07e111f4fa4af16542c8bacd33655f753ef642228890</Hashes>
        <Hashes condition="contains">SHA256=69e3fda487a5ec2ec0f67b7d79a5a836ff0036497b2d1aec514c67d2efa789b2</Hashes>
        <Hashes condition="contains">SHA256=71fe5af0f1564dc187eea8d59c0fbc897712afa07d18316d2080330ba17cf009</Hashes>
        <Hashes condition="contains">SHA256=71ff60722231c7641ad593756108cf6779dbaad21c7b08065fb1d4e225eab14d</Hashes>
        <Hashes condition="contains">SHA256=72b99147839bcfb062d29014ec09fe20a8f261748b5925b00171ef3cb849a4c1</Hashes>
        <Hashes condition="contains">SHA256=72c0d2d699d0440db17cb7cbbc06a253eaafd21465f14bb0fed8b85ae73153d1</Hashes>
        <Hashes condition="contains">SHA256=074ae477c8c7ae76c6f2b0bf77ac17935a8e8ee51b52155d2821d93ab30f3761</Hashes>
        <Hashes condition="contains">SHA256=74a846c61adc53692d3040aff4c1916f32987ad72b07fe226e9e7dbeff1036c4</Hashes>
        <Hashes condition="contains">SHA256=075de997497262a9d105afeadaaefc6348b25ce0e0126505c24aa9396c251e85</Hashes>
        <Hashes condition="contains">SHA256=76b86543ce05540048f954fed37bdda66360c4a3ddb8328213d5aef7a960c184</Hashes>
        <Hashes condition="contains">SHA256=76e807b6c0214e66455f09a8de8faad40b738982ca84470f0043de0290449524</Hashes>
        <Hashes condition="contains">SHA256=76fb4deaee57ef30e56c382c92abffe2cf616d08dbecb3368c8ee6b02e59f303</Hashes>
        <Hashes condition="contains">SHA256=077aa8ff5e01747723b6d24cc8af460a7a00f30cd3bc80e41cc245ceb8305356</Hashes>
        <Hashes condition="contains">SHA256=77c5e95b872b1d815d6d3ed28b399ca39f3427eeb0143f49982120ff732285a9</Hashes>
        <Hashes condition="contains">SHA256=79e2d37632c417138970b4feba91b7e10c2ea251c5efe3d1fc6fa0190f176b57</Hashes>
        <Hashes condition="contains">SHA256=79e87b93fbed84ec09261b3a0145c935f7dfe4d4805edfb563b2f971a0d51463</Hashes>
        <Hashes condition="contains">SHA256=80a59ca71fc20961ccafc0686051e86ae4afbbd4578cb26ad4570b9207651085</Hashes>
        <Hashes condition="contains">SHA256=80cbba9f404df3e642f22c476664d63d7c229d45d34f5cd0e19c65eb41becec3</Hashes>
        <Hashes condition="contains">SHA256=80eeb8c2890f3535ed14f5881baf2f2226e6763be099d09fb8aadaba5b4474c1</Hashes>
        <Hashes condition="contains">SHA256=81aafae4c4158d0b9a6431aff0410745a0f6a43fb20a9ab316ffeb8c2e2ccac0</Hashes>
        <Hashes condition="contains">SHA256=082c39fe2e3217004206535e271ebd45c11eb072efde4cc9885b25ba5c39f91d</Hashes>
        <Hashes condition="contains">SHA256=82fbcb371d53b8a76a25fbbafaae31147c0d1f6b9f26b3ea45262c2267386989</Hashes>
        <Hashes condition="contains">SHA256=83f7be0a13c1fccf024c31da5c68c0ea1decf4f48fc39d6e4fd324bbe789ae8a</Hashes>
        <Hashes condition="contains">SHA256=84bf1d0bcdf175cfe8aea2973e0373015793d43907410ae97e2071b2c4b8e2d4</Hashes>
        <Hashes condition="contains">SHA256=84df20b1d9d87e305c92e5ffae21b10b325609d59d835a954dbd8750ef5dabf4</Hashes>
        <Hashes condition="contains">SHA256=86a1b1bacc0c51332c9979e6aad84b5fba335df6b9a096ccb7681ab0779a8882</Hashes>
        <Hashes condition="contains">SHA256=86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219</Hashes>
        <Hashes condition="contains">SHA256=88df37ede18bea511f1782c1a6c4915690b29591cf2c1bf5f52201fbbb4fa2b9</Hashes>
        <Hashes condition="contains">SHA256=88e2e6a705d3fb71b966d9fb46dc5a4b015548daf585fb54dfcd81dc0bd3ebdc</Hashes>
        <Hashes condition="contains">SHA256=89b0017bc30cc026e32b758c66a1af88bd54c6a78e11ec2908ff854e00ac46be</Hashes>
        <Hashes condition="contains">SHA256=89b9823ed974a5b71de8468324d45b7e9d6dc914f93615ba86c6209b25b3cbf7</Hashes>
        <Hashes condition="contains">SHA256=092d04284fdeb6762e65e6ac5b813920d6c69a5e99d110769c5c1a78e11c5ba0</Hashes>
        <Hashes condition="contains">SHA256=93b266f38c3c3eaab475d81597abbd7cc07943035068bb6fd670dbbe15de0131</Hashes>
        <Hashes condition="contains">SHA256=93d873cdf23d5edc622b74f9544cac7fe247d7a68e1e2a7bf2879fad97a3ae63</Hashes>
        <Hashes condition="contains">SHA256=94be67c319a67de75ebed050d5537cfaa795d72bba52f3d8cf349e7bd075410e</Hashes>
        <Hashes condition="contains">SHA256=95d50c69cdbf10c9c9d61e64fe864ac91e6f6caa637d128eb20e1d3510e776d3</Hashes>
        <Hashes condition="contains">SHA256=97b32ddf83f75637e3ba934df117081dd6a1c57d47a4c9700d35e736da11d5bd</Hashes>
        <Hashes condition="contains">SHA256=98a123b314cba2de65f899cdbfa386532f178333389e0f0fbd544aff85be02eb</Hashes>
        <Hashes condition="contains">SHA256=98b734dda78c16ebcaa4afeb31007926542b63b2f163b2f733fa0d00dbb344d8</Hashes>
        <Hashes condition="contains">SHA256=99f4994a0e5bd1bf6e3f637d3225c69ff4cd620557e23637533e7f18d7d6cba1</Hashes>
        <Hashes condition="contains">SHA256=119c48b79735fda0ecd973d77d9bdc6b329960caed09b38ab454236ca039d280</Hashes>
        <Hashes condition="contains">SHA256=131d5490ceb9a5b2324d8e927fea5becfc633015661de2f4c2f2375a3a3b64c6</Hashes>
        <Hashes condition="contains">SHA256=133e542842656197c5d22429bd56d57aa33c9522897fdf29853a6d321033c743</Hashes>
        <Hashes condition="contains">SHA256=146d77e80ca70ea5cb17bfc9a5cea92334f809cbdc87a51c2d10b8579a4b9c88</Hashes>
        <Hashes condition="contains">SHA256=159e7c5a12157af92e0d14a0d3ea116f91c09e21a9831486e6dc592c93c10980</Hashes>
        <Hashes condition="contains">SHA256=175eed7a4c6de9c3156c7ae16ae85c554959ec350f1c8aaa6dfe8c7e99de3347</Hashes>
        <Hashes condition="contains">SHA256=221dfbc74bbb255b0879360ccc71a74b756b2e0f16e9386b38a9ce9d4e2e34f9</Hashes>
        <Hashes condition="contains">SHA256=263e8f1e20612849aea95272da85773f577fd962a7a6d525b53f43407aa7ad24</Hashes>
        <Hashes condition="contains">SHA256=0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5</Hashes>
        <Hashes condition="contains">SHA256=316a27e2bdb86222bc7c8af4e5472166b02aec7f3f526901ce939094e5861f6d</Hashes>
        <Hashes condition="contains">SHA256=358ac54be252673841a1d65bfc2fb6d549c1a4c877fa7f5e1bfa188f30375d69</Hashes>
        <Hashes condition="contains">SHA256=362c4f3dadc9c393682664a139d65d80e32caa2a97b6e0361dfd713a73267ecc</Hashes>
        <Hashes condition="contains">SHA256=399effe75d32bdab6fa0a6bffe02dbf0a59219d940b654837c3be1c0bd02e9aa</Hashes>
        <Hashes condition="contains">SHA256=436ccab6f62fa2d29827916e054ade7acae485b3de1d3e5c6c62d3debf1480e7</Hashes>
        <Hashes condition="contains">SHA256=453be8f63cc6b116e2049659e081d896491cf1a426e3d5f029f98146a3f44233</Hashes>
        <Hashes condition="contains">SHA256=455bc98ba32adab8b47d2d89bdbadca4910f91c182ab2fc3211ba07d3784537b</Hashes>
        <Hashes condition="contains">SHA256=0466dac557ee161503f5dfbd3549f81ec760c3d6c7c4363a21a03e7a3f66aca8</Hashes>
        <Hashes condition="contains">SHA256=475e5016c9c0f5a127896f9179a1b1577a67b357f399ab5a1e68aab07134729a</Hashes>
        <Hashes condition="contains">SHA256=478d855b648ef4501d3b08b3b10e94076ac67546b0ce86b454324f1bf9a78aa0</Hashes>
        <Hashes condition="contains">SHA256=496f4a4021226fb0f1b5f71a7634c84114c29faa308746a12c2414adb6b2a40b</Hashes>
        <Hashes condition="contains">SHA256=506f953bbb285aeb8af0549eb24f52f3b7af36afe740afa36735bac70573ce28</Hashes>
        <Hashes condition="contains">SHA256=523d1d43e896077f32cd9acaa8e85b513bfb7b013a625e56f0d4e9675d9822ba</Hashes>
        <Hashes condition="contains">SHA256=525d9b51a80ca0cd4c5889a96f857e73f3a80da1ffbae59851e0f51bdfb0b6cd</Hashes>
        <Hashes condition="contains">SHA256=552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9</Hashes>
        <Hashes condition="contains">SHA256=591bd5e92dfa0117b3daa29750e73e2db25baa717c31217539d30ffb1f7f3a52</Hashes>
        <Hashes condition="contains">SHA256=592f56b13e7dcaa285da64a0b9a48be7562bd9b0a190208b7c8b7d8de427cf6c</Hashes>
        <Hashes condition="contains">SHA256=600a2119657973112025db3c0eeab2e69d528bccfeed75f40c6ef50b059ec8a0</Hashes>
        <Hashes condition="contains">SHA256=607dc4c75ac7aef82ae0616a453866b3b358c6cf5c8f9d29e4d37f844306b97c</Hashes>
        <Hashes condition="contains">SHA256=626fae47811450d080d08c3d9fd890aa64bfecdc45eacd42a40850c1833c8763</Hashes>
        <Hashes condition="contains">SHA256=654c5ba47f74008c8f49cbb97988017eec8c898adc3bb851bc6e1fdf9dcf54ad</Hashes>
        <Hashes condition="contains">SHA256=673b63b67345773cd6d66f6adcf2c753e2d949232bff818d5bb6e05786538d92</Hashes>
        <Hashes condition="contains">SHA256=673bcec3d53fab5efd6e3bac25ac9d6cc51f6bbdf8336e38aade2713dc1ae11b</Hashes>
        <Hashes condition="contains">SHA256=677c0b1add3990fad51f492553d3533115c50a242a919437ccb145943011d2bf</Hashes>
        <Hashes condition="contains">SHA256=727e8ba66a8ff07bdc778eacb463b65f2d7167a6616ca2f259ea32571cacf8af</Hashes>
        <Hashes condition="contains">SHA256=771a8d05f1af6214e0ef0886662be500ee910ab99f0154227067fddcfe08a3dd</Hashes>
        <Hashes condition="contains">SHA256=818e396595d08d724666803cd29dac566dc7db23bf50e9919d04b33afa988c01</Hashes>
        <Hashes condition="contains">SHA256=823da894b2c73ffcd39e77366b6f1abf0ae9604d9b20140a54e6d55053aadeba</Hashes>
        <Hashes condition="contains">SHA256=845f1e228de249fc1ddf8dc28c39d03e8ad328a6277b6502d3932e83b879a65a</Hashes>
        <Hashes condition="contains">SHA256=862d0ff27bb086145a33b9261142838651b0d2e1403be321145e197600eb5015</Hashes>
        <Hashes condition="contains">SHA256=881bca6dc2dafe1ae18aeb59216af939a3ac37248c13ed42ad0e1048a3855461</Hashes>
        <Hashes condition="contains">SHA256=900dd68ccc72d73774a347b3290c4b6153ae496a81de722ebb043e2e99496f88</Hashes>
        <Hashes condition="contains">SHA256=904e0f7d485a98e8497d5ec6dd6e6e1cf0b8d8e067fb64a9e09790af3c8c9d5a</Hashes>
        <Hashes condition="contains">SHA256=909de5f21837ea2b13fdc4e5763589e6bdedb903f7c04e1d0b08776639774880</Hashes>
        <Hashes condition="contains">SHA256=910aa4685c735d8c07662aa04fafec463185699ad1a0cd1967b892fc33ec6c3c</Hashes>
        <Hashes condition="contains">SHA256=916c535957a3b8cbf3336b63b2260ea4055163a9e6b214f2a7005d6d36a4a677</Hashes>
        <Hashes condition="contains">SHA256=923ebbe8111e73d5b8ecc2db10f8ea2629a3264c3a535d01c3c118a3b4c91782</Hashes>
        <Hashes condition="contains">SHA256=927c2a580d51a598177fa54c65e9d2610f5f212f1b6cb2fbf2740b64368f010a</Hashes>
        <Hashes condition="contains">SHA256=950a4c0c772021cee26011a92194f0e58d61588f77f2873aa0599dff52a160c9</Hashes>
        <Hashes condition="contains">SHA256=955dac77a0148e9f9ed744f5d341cb9c9118261e52fe622ac6213965f2bc4cad</Hashes>
        <Hashes condition="contains">SHA256=984a77e5424c6d099051441005f2938ae92b31b5ad8f6521c6b001932862add7</Hashes>
        <Hashes condition="contains">SHA256=1023dcd4c80db19e9f82f95b1c5e1ddb60db7ac034848dd5cc1c78104a6350f4</Hashes>
        <Hashes condition="contains">SHA256=1078af0c70e03ac17c7b8aa5ee03593f5decfef2f536716646a4ded1e98c153c</Hashes>
        <Hashes condition="contains">SHA256=1273b74c3c1553eaa92e844fbd51f716356cc19cf77c2c780d4899ec7738fbd1</Hashes>
        <Hashes condition="contains">SHA256=1766fd66f846d9a21e648d649ad35d1ff94f8ca17a40a9a738444d6b8e07aacb</Hashes>
        <Hashes condition="contains">SHA256=1963d5a0e512b72353953aadbe694f73a9a576f0241a988378fa40bf574eda52</Hashes>
        <Hashes condition="contains">SHA256=2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d</Hashes>
        <Hashes condition="contains">SHA256=2101d5e80e92c55ecfd8c24fcf2202a206a4fd70195a1378f88c4cc04d336f22</Hashes>
        <Hashes condition="contains">SHA256=2121a2bb8ebbf2e6e82c782b6f3c6b7904f686aa495def25cf1cf52a42e16109</Hashes>
        <Hashes condition="contains">SHA256=2270a8144dabaf159c2888519b11b61e5e13acdaa997820c09798137bded3dd6</Hashes>
        <Hashes condition="contains">SHA256=2470fd1b733314c9b0afa19fd39c5d19aa1b36db598b5ebbe93445caa545da5f</Hashes>
        <Hashes condition="contains">SHA256=2594b3ef3675ca3a7b465b8ed4962e3251364bab13b12af00ebba7fa2211abb2</Hashes>
        <Hashes condition="contains">SHA256=3124b0411b8077605db2a9b7909d8240e0d554496600e2706e531c93c931e1b5</Hashes>
        <Hashes condition="contains">SHA256=3243aab18e273a9b9c4280a57aecef278e10bfff19abb260d7a7820e41739099</Hashes>
        <Hashes condition="contains">SHA256=3326e2d32bbabd69feb6024809afc56c7e39241ebe70a53728c77e80995422a5</Hashes>
        <Hashes condition="contains">SHA256=3384f4a892f7aa72c43280ff682d85c8e3936f37a68d978d307a9461149192de</Hashes>
        <Hashes condition="contains">SHA256=3503ea284b6819f9cb43b3e94c0bb1bf5945ccb37be6a898387e215197a4792a</Hashes>
        <Hashes condition="contains">SHA256=3724b39e97936bb20ada51c6119aded04530ed86f6b8d6b45fbfb2f3b9a4114b</Hashes>
        <Hashes condition="contains">SHA256=3871e16758a1778907667f78589359734f7f62f9dc953ec558946dcdbe6951e3</Hashes>
        <Hashes condition="contains">SHA256=3943a796cc7c5352aa57ccf544295bfd6fb69aae147bc8235a00202dc6ed6838</Hashes>
        <Hashes condition="contains">SHA256=4045ae77859b1dbf13972451972eaaf6f3c97bea423e9e78f1c2f14330cd47ca</Hashes>
        <Hashes condition="contains">SHA256=4324f3d1e4007f6499a3d0f0102cd92ed9f554332bc0b633305cd7b957ff16c8</Hashes>
        <Hashes condition="contains">SHA256=4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b</Hashes>
        <Hashes condition="contains">SHA256=4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6</Hashes>
        <Hashes condition="contains">SHA256=4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8</Hashes>
        <Hashes condition="contains">SHA256=4941c4298f4560fc1e59d0f16f84bab5c060793700b82be2fd7c63735f1657a8</Hashes>
        <Hashes condition="contains">SHA256=5027fce41ed60906a0e76b97c95c2a5a83d57a2d1cd42de232a21f26c0d58e48</Hashes>
        <Hashes condition="contains">SHA256=5177a3b7393fb5855b2ec0a45d4c91660b958ee077e76e5a7d0669f2e04bcf02</Hashes>
        <Hashes condition="contains">SHA256=5192ec4501d0fe0b1c8f7bf9b778f7524a7a70a26bbbb66e5dab8480f6fdbb8b</Hashes>
        <Hashes condition="contains">SHA256=5351c81b4ec5a0d79c39d24bac7600d10eac30c13546fde43d23636b3f421e7c</Hashes>
        <Hashes condition="contains">SHA256=6071db01b50c658cf78665c24f1d21f21b4a12d16bfcfaa6813bf6bbc4d0a1e8</Hashes>
        <Hashes condition="contains">SHA256=6191c20426dd9b131122fb97e45be64a4d6ce98cc583406f38473434636ddedc</Hashes>
        <Hashes condition="contains">SHA256=06508aacb4ed0a1398a2b0da5fa2dbf7da435b56da76fd83c759a50a51c75caf</Hashes>
        <Hashes condition="contains">SHA256=7049f3c939efe76a5556c2a2c04386db51daf61d56b679f4868bb0983c996ebb</Hashes>
        <Hashes condition="contains">SHA256=7133a461aeb03b4d69d43f3d26cd1a9e3ee01694e97a0645a3d8aa1a44c39129</Hashes>
        <Hashes condition="contains">SHA256=7236c8ff33c0e5cfa956778aa7303f1979f3bf709c361399fa1ce101b7e355b8</Hashes>
        <Hashes condition="contains">SHA256=7837cb350338c4958968d06b105466da6518f5bb522a6e70e87c0cad85128408</Hashes>
        <Hashes condition="contains">SHA256=7877c1b0e7429453b750218ca491c2825dae684ad9616642eff7b41715c70aca</Hashes>
        <Hashes condition="contains">SHA256=8137ce22d0d0fc5ea5b174d6ad3506a4949506477b1325da2ccb76511f4c4f60</Hashes>
        <Hashes condition="contains">SHA256=8399e5afd8e3e97139dffb1a9fb00db2186321b427f164403282217cab067c38</Hashes>
        <Hashes condition="contains">SHA256=8688e43d94b41eeca2ed458b8fc0d02f74696a918e375ecd3842d8627e7a8f2b</Hashes>
        <Hashes condition="contains">SHA256=8797d9afc7a6bb0933f100a8acbb5d0666ec691779d522ac66c66817155b1c0d</Hashes>
        <Hashes condition="contains">SHA256=09043c51719d4bf6405c9a7a292bb9bb3bcc782f639b708ddcc4eedb5e5c9ce9</Hashes>
        <Hashes condition="contains">SHA256=9254f012009d55f555418ff85f7d93b184ab7cb0e37aecdfdab62cfe94dea96b</Hashes>
        <Hashes condition="contains">SHA256=9529efb1837b1005e5e8f477773752078e0a46500c748bc30c9b5084d04082e6</Hashes>
        <Hashes condition="contains">SHA256=9790a7b9d624b2b18768bb655dda4a05a9929633cef0b1521e79e40d7de0a05b</Hashes>
        <Hashes condition="contains">SHA256=17687cba00ec2c9036dd3cb5430aa1f4851e64990dafb4c8f06d88de5283d6ca</Hashes>
        <Hashes condition="contains">SHA256=17927b93b2d6ab4271c158f039cae2d60591d6a14458f5a5690aec86f5d54229</Hashes>
        <Hashes condition="contains">SHA256=18712a063574bfec315d58577dfe413ab45b650e54747d1e18a56c3c7337a12c</Hashes>
        <Hashes condition="contains">SHA256=19696fb0db3fcae22f705ae1eb1e9f1151c823f3ff5d8857e90f2a4a6fdc5758</Hashes>
        <Hashes condition="contains">SHA256=26453afb1f808f64bec87a2532a9361b696c0ed501d6b973a1f1b5ae152a4d40</Hashes>
        <Hashes condition="contains">SHA256=28999af32b55ddb7dcfc26376a244aa2fe297233ce7abe4919a1aef2f7e2cee7</Hashes>
        <Hashes condition="contains">SHA256=30706f110725199e338e9cc1c940d9a644d19a14f0eb8847712cba4cacda67ab</Hashes>
        <Hashes condition="contains">SHA256=37073e42ffa0322500f90cd7e3c8d02c4cdd695d31c77e81560abec20bfb68ba</Hashes>
        <Hashes condition="contains">SHA256=40061b30b1243be76d5283cbc8abfe007e148097d4de7337670ff1536c4c7ba1</Hashes>
        <Hashes condition="contains">SHA256=42579a759f3f95f20a2c51d5ac2047a2662a2675b3fb9f46c1ed7f23393a0f00</Hashes>
        <Hashes condition="contains">SHA256=42851a01469ba97cdc38939b10cf9ea13237aa1f6c37b1ac84904c5a12a81fa0</Hashes>
        <Hashes condition="contains">SHA256=49329fa09f584d1960b09c1b15df18c0bc1c4fdb90bf48b6b5703e872040b668</Hashes>
        <Hashes condition="contains">SHA256=54841d9f89e195196e65aa881834804fe3678f1cf6b328cab8703edd15e3ec57</Hashes>
        <Hashes condition="contains">SHA256=59626cac380d8fe0b80a6d4c4406d62ba0683a2f0f68d50ad506ca1b1cf25347</Hashes>
        <Hashes condition="contains">SHA256=65329dad28e92f4bcc64de15c552b6ef424494028b18875b7dba840053bc0cdd</Hashes>
        <Hashes condition="contains">SHA256=67734c7c0130dd66c964f76965f09a2290da4b14c94412c0056046e700654bdc</Hashes>
        <Hashes condition="contains">SHA256=70211a3f90376bbc61f49c22a63075d1d4ddd53f0aefa976216c46e6ba39a9f4</Hashes>
        <Hashes condition="contains">SHA256=72288d4978ee87ea6c8b1566dbd906107357087cef7364fb3dd1e1896d00baeb</Hashes>
        <Hashes condition="contains">SHA256=72322fa8bba20df6966acbcf41e83747893fd173cd29de99b5ad1a5d3bf8f2de</Hashes>
        <Hashes condition="contains">SHA256=76614f2e372f33100a8d92bf372cdbc1e183930ca747eed0b0cf2501293b990a</Hashes>
        <Hashes condition="contains">SHA256=76660e91f1ff3cb89630df5af4fe09de6098d09baa66b1a130c89c3c5edd5b22</Hashes>
        <Hashes condition="contains">SHA256=77950e2a40ac0447ae7ee1ee3ef1242ce22796a157074e6f04e345b1956e143c</Hashes>
        <Hashes condition="contains">SHA256=78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f</Hashes>
        <Hashes condition="contains">SHA256=81939e5c12bd627ff268e9887d6fb57e95e6049f28921f3437898757e7f21469</Hashes>
        <Hashes condition="contains">SHA256=85866e8c25d82c1ec91d7a8076c7d073cccf421cf57d9c83d80d63943a4edd94</Hashes>
        <Hashes condition="contains">SHA256=86721ee8161096348ed3dbe1ccbf933ae004c315b1691745a8af4a0df9fed675</Hashes>
        <Hashes condition="contains">SHA256=89108a15f009b285db4ef94250b889d5b11b96b4aa7b190784a6d1396e893e10</Hashes>
        <Hashes condition="contains">SHA256=092349aebdac28294dbad1656759d8461f362d1a36b01054dccf861d97beadf0</Hashes>
        <Hashes condition="contains">SHA256=94911fe6f2aba9683b10353094caf71ee4a882de63b4620797629d79f18feec5</Hashes>
        <Hashes condition="contains">SHA256=101402d4f5d1ae413ded499c78a5fcbbc7e3bae9b000d64c1dd64e3c48c37558</Hashes>
        <Hashes condition="contains">SHA256=238046cfe126a1f8ab96d8b62f6aa5ec97bab830e2bae5b1b6ab2d31894c79e4</Hashes>
        <Hashes condition="contains">SHA256=258359a7fa3d975620c9810dab3a6493972876a024135feaf3ac8482179b2e79</Hashes>
        <Hashes condition="contains">SHA256=314384b40626800b1cde6fbc51ebc7d13e91398be2688c2a58354aa08d00b073</Hashes>
        <Hashes condition="contains">SHA256=385485e643aa611e97ceae6590c6a8c47155886123dbb9de1e704d0d1624d039</Hashes>
        <Hashes condition="contains">SHA256=405472a8f9400a54bb29d03b436ccd58cfd6442fe686f6d2ed4f63f002854659</Hashes>
        <Hashes condition="contains">SHA256=440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c</Hashes>
        <Hashes condition="contains">SHA256=509628b6d16d2428031311d7bd2add8d5f5160e9ecc0cd909f1e82bbbb3234d6</Hashes>
        <Hashes condition="contains">SHA256=543991ca8d1c65113dff039b85ae3f9a87f503daec30f46929fd454bc57e5a91</Hashes>
        <Hashes condition="contains">SHA256=000547560fea0dd4b477eb28bf781ea67bf83c748945ce8923f90fdd14eb7a4b</Hashes>
        <Hashes condition="contains">SHA256=708016fbe22c813a251098f8f992b177b476bd1bbc48c2ed4a122ff74910a965</Hashes>
        <Hashes condition="contains">SHA256=771015b2620942919bb2e0683476635b7a09db55216d6fbf03534cb18513b20c</Hashes>
        <Hashes condition="contains">SHA256=810513b3f4c8d29afb46f71816350088caacf46f1be361af55b26f3fee4662c3</Hashes>
        <Hashes condition="contains">SHA256=841335eeb6af68dce5b8b24151776281a751b95056a894991b23afae80e9f33b</Hashes>
        <Hashes condition="contains">SHA256=0909005d625866ef8ccd8ae8af5745a469f4f70561b644d6e38b80bccb53eb06</Hashes>
        <Hashes condition="contains">SHA256=952199c28332bc90cfd74530a77ee237967ed32b3c71322559c59f7a42187dc4</Hashes>
        <Hashes condition="contains">SHA256=2732050a7d836ae0bdc5c0aea4cdf8ce205618c3e7f613b8139c176e86476d0c</Hashes>
        <Hashes condition="contains">SHA256=3279593db91bb7ad5b489a01808c645eafafda6cc9c39f50d10ccc30203f2ddf</Hashes>
        <Hashes condition="contains">SHA256=3390919bb28d5c36cc348f9ef23be5fa49bfd81263eb7740826e4437cbe904cd</Hashes>
        <Hashes condition="contains">SHA256=4422851a0a102f654e95d3b79c357ae3af1b096d7d1576663c027cfbc04abaf9</Hashes>
        <Hashes condition="contains">SHA256=7196187fb1ef8d108b380d37b2af8efdeb3ca1f6eefd37b5dc114c609147216d</Hashes>
        <Hashes condition="contains">SHA256=7539157df91923d4575f7f57c8eb8b0fd87f064c919c1db85e73eebb2910b60c</Hashes>
        <Hashes condition="contains">SHA256=7893307df2fdde25371645a924f0333e1b2de31b6bc839d8e2a908d7830c6504</Hashes>
        <Hashes condition="contains">SHA256=8939116df1d6c8fd0ebd14b2d37b3dec38a8820aa666ecd487bc1bb794f2a587</Hashes>
        <Hashes condition="contains">SHA256=9778136d2441439dc470861d15d96fa21dc9f16225232cd05b76791a5e0fde6f</Hashes>
        <Hashes condition="contains">SHA256=16768203a471a19ebb541c942f45716e9f432985abbfbe6b4b7d61a798cea354</Hashes>
        <Hashes condition="contains">SHA256=18776682fcc0c6863147143759a8d4050a4115a8ede0136e49a7cf885c8a4805</Hashes>
        <Hashes condition="contains">SHA256=22418016e980e0a4a2d01ca210a17059916a4208352c1018b0079ccb19aaf86a</Hashes>
        <Hashes condition="contains">SHA256=36505921af5a09175395ebaea29c72b2a69a3a9204384a767a5be8a721f31b10</Hashes>
        <Hashes condition="contains">SHA256=36875562e747136313ec5db58174e5fab870997a054ca8d3987d181599c7db6a</Hashes>
        <Hashes condition="contains">SHA256=0040153302b88bee27eb4f1eca6855039e1a057370f5e8c615724fa5215bada3</Hashes>
        <Hashes condition="contains">SHA256=55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa</Hashes>
        <Hashes condition="contains">SHA256=65008817eb97635826a8708a6411d7b50f762bab81304e457119d669382944c3</Hashes>
        <Hashes condition="contains">SHA256=65025741ecd0ef516da01319b42c2d96e13cb8d78de53fb7e39cd53ea6d58c75</Hashes>
        <Hashes condition="contains">SHA256=91314768da140999e682d2a290d48b78bb25a35525ea12c1b1f9634d14602b2c</Hashes>
        <Hashes condition="contains">SHA256=478917514be37b32d5ccf76e4009f6f952f39f5553953544f1b0688befd95e82</Hashes>
        <Hashes condition="contains">SHA256=696679114f6a106ec94c21e2a33fe17af86368bcf9a796aaea37ea6e8748ad6a</Hashes>
        <Hashes condition="contains">SHA256=910479467ef17b9591d8d42305e7f6f247ad41c60ec890a1ffbe331f495ed135</Hashes>
        <Hashes condition="contains">SHA256=8111085022bda87e5f6aa4c195e743cc6dd6a3a6d41add475d267dc6b105a69f</Hashes>
        <Hashes condition="contains">SHA256=9679758455c69877fce866267d60c39d108b495dca183954e4af869902965b3d</Hashes>
        <Hashes condition="contains">SHA256=46621554728bc55438c7c241137af401250f062edef6e7efecf1a6f0f6d0c1f7</Hashes>
        <Hashes condition="contains">SHA256=48891874441c6fa69e5518d98c53d83b723573e280c6c65ccfbde9039a6458c9</Hashes>
        <Hashes condition="contains">SHA256=6948480954137987a0be626c24cf594390960242cd75f094cd6aaa5c2e7a54fa</Hashes>
        <Hashes condition="contains">SHA256=a2f45d95d54f4e110b577e621fefa0483fa0e3dcca14c500c298fb9209e491c1</Hashes>
        <Hashes condition="contains">SHA256=a3e507e713f11901017fc328186ae98e23de7cea5594687480229f77d45848d8</Hashes>
        <Hashes condition="contains">SHA256=a5a50449e2cc4d0dbc80496f757935ae38bf8a1bebdd6555a3495d8c219df2ad</Hashes>
        <Hashes condition="contains">SHA256=a7b000abbcc344444a9b00cfade7aa22ab92ce0cadec196c30eb1851ae4fa062</Hashes>
        <Hashes condition="contains">SHA256=a7c2e7910942dd5e43e2f4eb159bcd2b4e71366e34a68109548b9fb12ac0f7cc</Hashes>
        <Hashes condition="contains">SHA256=a7c8f4faf3cbb088cac7753d81f8ec4c38ccb97cd9da817741f49272e8d01200</Hashes>
        <Hashes condition="contains">SHA256=a56c2a2425eb3a4260cc7fc5c8d7bed7a3b4cd2af256185f24471c668853aee8</Hashes>
        <Hashes condition="contains">SHA256=a59c40e7470b7003e8adfee37c77606663e78d7e3f2ebb8d60910af19924d8df</Hashes>
        <Hashes condition="contains">SHA256=a334bdf0c0ab07803380eb6ef83eefe7c147d6962595dd9c943a6a76f2200b0d</Hashes>
        <Hashes condition="contains">SHA256=a566af57d88f37fa033e64b1d8abbd3ffdacaba260475fbbc8dab846a824eff5</Hashes>
        <Hashes condition="contains">SHA256=a899b659b08fbae30b182443be8ffb6a6471c1d0497b52293061754886a937a3</Hashes>
        <Hashes condition="contains">SHA256=a903f329b70f0078197cb7683aae1bb432eaf58572fe572f7cb4bc2080042d7e</Hashes>
        <Hashes condition="contains">SHA256=a961f5939088238d76757669a9a81905e33f247c9c635b908daac146ae063499</Hashes>
        <Hashes condition="contains">SHA256=a4680fabf606d6580893434e81c130ff7ec9467a15e6534692443465f264d3c9</Hashes>
        <Hashes condition="contains">SHA256=a7860e110f7a292d621006b7208a634504fb5be417fd71e219060381b9a891e6</Hashes>
        <Hashes condition="contains">SHA256=a8027daa6facf1ff81405daf6763249e9acf232a1a191b6bf106711630e6188e</Hashes>
        <Hashes condition="contains">SHA256=a9706e320179993dade519a83061477ace195daa1b788662825484813001f526</Hashes>
        <Hashes condition="contains">SHA256=a13054f349b7baa8c8a3fcbd31789807a493cc52224bbff5e412eb2bd52a6433</Hashes>
        <Hashes condition="contains">SHA256=a2353030d4ea3ad9e874a0f7ff35bbfa10562c98c949d88cabab27102bbb8e48</Hashes>
        <Hashes condition="contains">SHA256=a072197177aad26c31960694e38e2cae85afbab070929e67e331b99d3a418cf4</Hashes>
        <Hashes condition="contains">SHA256=aa9ab1195dc866270e984f1bed5e1358d6ef24c515dfdb6c2a92d1e1b94bf608</Hashes>
        <Hashes condition="contains">SHA256=aaa3459bcac25423f78ed72dbae4d7ef19e7c5c65770cbe5210b14e33cd1816c</Hashes>
        <Hashes condition="contains">SHA256=aafb95a443911e4c67d4e45ffa83cca103c91b42915b81100534dc439bec0c1b</Hashes>
        <Hashes condition="contains">SHA256=ab8f2217e59319b88080e052782e559a706fa4fb7b8b708f709ff3617124da89</Hashes>
        <Hashes condition="contains">SHA256=ab2632a4d93a7f3b7598c06a9fdc773a1b1b69a7dd926bdb7cf578992628e9dd</Hashes>
        <Hashes condition="contains">SHA256=ab0925398f3fa69a67eacee2bbb7b34ac395bb309df7fc7a9a9b8103ef41ed7a</Hashes>
        <Hashes condition="contains">SHA256=ac3f613d457fc4d44fa27b2e0b1baa62c09415705efb5a40a4756da39b3ac165</Hashes>
        <Hashes condition="contains">SHA256=ac63c26ca43701dddaa7fb1aea535d42190f88752900a03040fd5aaa24991e25</Hashes>
        <Hashes condition="contains">SHA256=ad8ffccfde782bc287241152cf24245a8bf21c2530d81c57e17631b3c4adb833</Hashes>
        <Hashes condition="contains">SHA256=ad23d77a38655acb71216824e363df8ac41a48a1a0080f35a0d23aa14b54460b</Hashes>
        <Hashes condition="contains">SHA256=ad40e6d0f77c0e579fb87c5106bf6de3d1a9f30ee2fbf8c9c011f377fa05f173</Hashes>
        <Hashes condition="contains">SHA256=ad2477632b9b07588cfe0e692f244c05fa4202975c1fe91dd3b90fa911ac6058</Hashes>
        <Hashes condition="contains">SHA256=ada4e42bf5ef58ef1aad94435441003b1cc1fcaa5d38bfdbe1a3d736dc451d47</Hashes>
        <Hashes condition="contains">SHA256=adc10de960f40fa9f6e28449748250fa9ddfd331115b77a79809a50c606753ee</Hashes>
        <Hashes condition="contains">SHA256=ae6fb53e4d8122dba3a65e5fa59185b36c3ac9df46e82fcfb6731ab55c6395aa</Hashes>
        <Hashes condition="contains">SHA256=ae42afa9be9aa6f6a5ae09fa9c05cd2dfb7861dc72d4fd8e0130e5843756c471</Hashes>
        <Hashes condition="contains">SHA256=ae79e760c739d6214c1e314728a78a6cb6060cce206fde2440a69735d639a0a2</Hashes>
        <Hashes condition="contains">SHA256=aebcbfca180e372a048b682a4859fd520c98b5b63f6e3a627c626cb35adc0399</Hashes>
        <Hashes condition="contains">SHA256=af095de15a16255ca1b2c27dad365dff9ac32d2a75e8e288f5a1307680781685</Hashes>
        <Hashes condition="contains">SHA256=af1011c76a22af7be97a0b3e0ce11aca0509820c59fa7c8eeaaa1b2c0225f75a</Hashes>
        <Hashes condition="contains">SHA256=afdd66562dea51001c3a9de300f91fc3eb965d6848dfce92ccb9b75853e02508</Hashes>
        <Hashes condition="contains">SHA256=b1d96233235a62dbb21b8dbe2d1ae333199669f67664b107bff1ad49b41d9414</Hashes>
        <Hashes condition="contains">SHA256=b2ba6efeff1860614b150916a77c9278f19d51e459e67a069ccd15f985cbc0e1</Hashes>
        <Hashes condition="contains">SHA256=b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29</Hashes>
        <Hashes condition="contains">SHA256=b4d47ea790920a4531e3df5a4b4b0721b7fea6b49a35679f0652f1e590422602</Hashes>
        <Hashes condition="contains">SHA256=b6fd51e1f57a03006953e84fd56cc2821cc19e7c77c0474e1110aabaacaf03df</Hashes>
        <Hashes condition="contains">SHA256=b7a20b5f15e1871b392782c46ebcc897929443d82073ee4dcb3874b6a5976b5d</Hashes>
        <Hashes condition="contains">SHA256=b8b94c2646b62f6ac08f16514b6efaa9866aa3c581e4c0435a7aeafe569b2418</Hashes>
        <Hashes condition="contains">SHA256=b9a4e40a5d80fedd1037eaed958f9f9efed41eb01ada73d51b5dcd86e27e0cbf</Hashes>
        <Hashes condition="contains">SHA256=b9b3878ddc5dfb237d38f8d25067267870afd67d12a330397a8853209c4d889c</Hashes>
        <Hashes condition="contains">SHA256=b019ebd77ac19cdd72bba3318032752649bd56a7576723a8ae1cccd70ee1e61a</Hashes>
        <Hashes condition="contains">SHA256=b37b3c6877b70289c0f43aeb71349f7344b06063996e6347c3c18d8c5de77f3b</Hashes>
        <Hashes condition="contains">SHA256=b47be212352d407d0ef7458a7161c66b47c2aec8391dd101df11e65728337a6a</Hashes>
        <Hashes condition="contains">SHA256=b48a309ee0960da3caaaaf1e794e8c409993aeb3a2b64809f36b97aac8a1e62a</Hashes>
        <Hashes condition="contains">SHA256=b50ffc60eaa4fb7429fdbb67c0aba0c7085f5129564d0a113fec231c5f8ff62e</Hashes>
        <Hashes condition="contains">SHA256=b51ddcf8309c80384986dda9b11bf7856b030e3e885b0856efdb9e84064917e5</Hashes>
        <Hashes condition="contains">SHA256=b95b2d9b29bd25659f1c7ba5a187f8d23cde01162d9b5b1a2c4aea8f64b38441</Hashes>
        <Hashes condition="contains">SHA256=b179e1ab6dc0b1aee783adbcad4ad6bb75a8a64cb798f30c0dd2ee8aaf43e6de</Hashes>
        <Hashes condition="contains">SHA256=b1334a71cc73b3d0c54f62d8011bec330dfc355a239bf94a121f6e4c86a30a2e</Hashes>
        <Hashes condition="contains">SHA256=b1867d13a4cab66a76f4d4448824ca0cb3a176064626f9618c0c103ee3cb4f47</Hashes>
        <Hashes condition="contains">SHA256=b17507a3246020fa0052a172485d7b3567e0161747927f2edf27c40e310852e0</Hashes>
        <Hashes condition="contains">SHA256=b61869b7945be062630f1dd4bae919aecee8927f7e1bc3954a21ff763f4c0867</Hashes>
        <Hashes condition="contains">SHA256=b583414fcee280128788f7b39451c511376fe821f455d4f3702795e96d560704</Hashes>
        <Hashes condition="contains">SHA256=b773511fdb2e370dec042530910a905472fcc2558eb108b246fd3200171b04d3</Hashes>
        <Hashes condition="contains">SHA256=bac709c49ddee363c8e59e515f2f632324a0359e932b7d8cb1ce2d52a95981aa</Hashes>
        <Hashes condition="contains">SHA256=bb1135b51acca8348d285dc5461d10e8f57260e7d0c8cc4a092734d53fc40cbc</Hashes>
        <Hashes condition="contains">SHA256=bb50818a07b0eb1bd317467139b7eb4bad6cd89053fecdabfeae111689825955</Hashes>
        <Hashes condition="contains">SHA256=bb68552936a6b0a68fb53ce864a6387d2698332aac10a7adfdd5a48b97027ce3</Hashes>
        <Hashes condition="contains">SHA256=bc7ebd191e0991fd0865a5c956a92e63792a0bb2ff888af43f7a63bb65a22248</Hashes>
        <Hashes condition="contains">SHA256=bc13adeb6bf62b1e10ef41205ef92382e6c18d6a20669d288a0b11058e533d63</Hashes>
        <Hashes condition="contains">SHA256=bced04bdefad6a08c763265d6993f07aa2feb57d33ed057f162a947cf0e6668f</Hashes>
        <Hashes condition="contains">SHA256=bcfc2c9883e6c1b8429be44cc4db988a9eecb544988fbd756d18cfca6201876f</Hashes>
        <Hashes condition="contains">SHA256=bda99629ec6c522c3efcbcc9ca33688d31903146f05b37d0d3b43db81bfb3961</Hashes>
        <Hashes condition="contains">SHA256=bdbceca41e576841cad2f2b38ee6dbf92fd77fbbfdfe6ecf99f0623d44ef182c</Hashes>
        <Hashes condition="contains">SHA256=bdcacee3695583a0ca38b9a786b9f7334bf2a9a3387e4069c8e6ca378b2791d0</Hashes>
        <Hashes condition="contains">SHA256=be03e9541f56ac6ed1e81407dcd7cc85c0ffc538c3c2c2c8a9c747edbcf13100</Hashes>
        <Hashes condition="contains">SHA256=be8dd2d39a527649e34dc77ef8bc07193a4234b38597b8f51e519dadc5479ec2</Hashes>
        <Hashes condition="contains">SHA256=be54f7279e69fb7651f98e91d24069dbc7c4c67e65850e486622ccbdc44d9a57</Hashes>
        <Hashes condition="contains">SHA256=c1c4310e5d467d24e864177bdbfc57cb5d29aac697481bfa9c11ddbeebfd4cc8</Hashes>
        <Hashes condition="contains">SHA256=c2a4ddcc9c3b339d752c48925d62fc4cc5adbf6fae8fedef74cdd47e88da01f8</Hashes>
        <Hashes condition="contains">SHA256=c2fcc0fec64d5647813b84b9049d430406c4c6a7b9f8b725da21bcae2ff12247</Hashes>
        <Hashes condition="contains">SHA256=c3e150eb7e7292f70299d3054ed429156a4c32b1f7466a706a2b99249022979e</Hashes>
        <Hashes condition="contains">SHA256=c8eaa5e6d3230b93c126d2d58e32409e4aeeb23ccf0dd047a17f1ef552f92fe9</Hashes>
        <Hashes condition="contains">SHA256=c9b49b52b493b53cd49c12c3fa9553e57c5394555b64e32d1208f5b96a5b8c6e</Hashes>
        <Hashes condition="contains">SHA256=c9cf1d627078f63a36bbde364cd0d5f2be1714124d186c06db5bcdf549a109f8</Hashes>
        <Hashes condition="contains">SHA256=c26b51b4c37330800cff8519252e110116c3aaade94ceb9894ec5bfb1b8f9924</Hashes>
        <Hashes condition="contains">SHA256=c50f8ab8538c557963252b702c1bd3cee4604b5fc2497705d2a6a3fd87e3cc26</Hashes>
        <Hashes condition="contains">SHA256=c60fcff9c8e5243bbb22ec94618b9dcb02c59bb49b90c04d7d6ab3ebbd58dc3a</Hashes>
        <Hashes condition="contains">SHA256=c64d4ac416363c7a1aa828929544d1c1d78cf032b39769943b851cfc4c0faafc</Hashes>
        <Hashes condition="contains">SHA256=c089a31ac95d41ed02d1e4574962f53376b36a9e60ff87769d221dc7d1a3ecfa</Hashes>
        <Hashes condition="contains">SHA256=c344e92a6d06155a217a9af7b4b35e6653665eec6569292e7b2e70f3a3027646</Hashes>
        <Hashes condition="contains">SHA256=c470c9db58840149ce002f3e6003382ecf740884a683bae8f9d10831be218fa2</Hashes>
        <Hashes condition="contains">SHA256=c628cda1ef43defc00af45b79949675a8422490d32b080b3a8bb9434242bdbf2</Hashes>
        <Hashes condition="contains">SHA256=c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5</Hashes>
        <Hashes condition="contains">SHA256=c8940e2e9b069ec94f9f711150b313b437f8429f78d522810601b6ee8b52bada</Hashes>
        <Hashes condition="contains">SHA256=c9014b03866bf37faa8fdb16b6af7cfec976aaef179fd5797d0c0bf8079d3a8c</Hashes>
        <Hashes condition="contains">SHA256=c299063e3eae8ddc15839767e83b9808fd43418dc5a1af7e4f44b97ba53fbd3d</Hashes>
        <Hashes condition="contains">SHA256=c725919e6357126d512c638f993cf572112f323da359645e4088f789eb4c7b8c</Hashes>
        <Hashes condition="contains">SHA256=c082514317bf80a2f5129d84a5a55e411a95e32d03a4df1274537704c80e41dd</Hashes>
        <Hashes condition="contains">SHA256=caa85c44eb511377ea7426ff10df00a701c07ffb384eef8287636a4bca0b53ab</Hashes>
        <Hashes condition="contains">SHA256=cb57f3a7fe9e1f8e63332c563b0a319b26c944be839eabc03e9a3277756ba612</Hashes>
        <Hashes condition="contains">SHA256=cb9890d4e303a4c03095d7bc176c42dee1b47d8aa58e2f442ec1514c8f9e3cec</Hashes>
        <Hashes condition="contains">SHA256=cbb8239a765bf5b2c1b6a5c8832d2cab8fef5deacadfb65d8ed43ef56d291ab6</Hashes>
        <Hashes condition="contains">SHA256=cc383ad11e9d06047a1558ed343f389492da3ac2b84b71462aee502a2fa616c8</Hashes>
        <Hashes condition="contains">SHA256=cc687fe3741bbde1dd142eac0ef59fd1d4457daee43cdde23bb162ef28d04e64</Hashes>
        <Hashes condition="contains">SHA256=cc586254e9e89e88334adee44e332166119307e79c2f18f6c2ab90ce8ba7fc9b</Hashes>
        <Hashes condition="contains">SHA256=cd4a249c3ef65af285d0f8f30a8a96e83688486aab515836318a2559757a89bb</Hashes>
        <Hashes condition="contains">SHA256=cdd2a4575a46bada4837a6153a79c14d60ee3129830717ef09e0e3efd9d00812</Hashes>
        <Hashes condition="contains">SHA256=cdfbe62ef515546f1728189260d0bdf77167063b6dbb77f1db6ed8b61145a2bc</Hashes>
        <Hashes condition="contains">SHA256=ce23c2dae4cca4771ea50ec737093dfafac06c64db0f924a1ccbbf687e33f5a2</Hashes>
        <Hashes condition="contains">SHA256=cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986</Hashes>
        <Hashes condition="contains">SHA256=cf4b5fa853ce809f1924df3a3ae3c4e191878c4ea5248d8785dc7e51807a512b</Hashes>
        <Hashes condition="contains">SHA256=cf3180f5308af002ac5d6fd5b75d1340878c375f0aebc3157e3bcad6322b7190</Hashes>
        <Hashes condition="contains">SHA256=cf69704755ec2643dfd245ae1d4e15d77f306aeb1a576ffa159453de1a7345cb</Hashes>
        <Hashes condition="contains">SHA256=cfb7af8ac67a379e7869289aeee21837c448ea6f8ab6c93988e7aa423653bd40</Hashes>
        <Hashes condition="contains">SHA256=cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b</Hashes>
        <Hashes condition="contains">SHA256=cfcf32f5662791f1f22a77acb6dddfbc970fe6e99506969b3ea67c03f67687ab</Hashes>
        <Hashes condition="contains">SHA256=cff9aa9046bdfd781d34f607d901a431a51bb7e5f48f4f681cc743b2cdedc98c</Hashes>
        <Hashes condition="contains">SHA256=d0bd1ae72aeb5f3eabf1531a635f990e5eaae7fdd560342f915f723766c80889</Hashes>
        <Hashes condition="contains">SHA256=d0e25b879d830e4f867b09d6540a664b6f88bad353cd14494c33b31a8091f605</Hashes>
        <Hashes condition="contains">SHA256=d1f4949f76d8ac9f2fa844d16b1b45fb1375d149d46e414e4a4c9424dc66c91f</Hashes>
        <Hashes condition="contains">SHA256=d5c4ff35eaa74ccdb80c7197d3d113c9cd38561070f2aa69c0affe8ed84a77c9</Hashes>
        <Hashes condition="contains">SHA256=d7bc7306cb489fe4c285bbeddc6d1a09e814ef55cf30bd5b8daf87a52396f102</Hashes>
        <Hashes condition="contains">SHA256=d7ddf874304556f8a10942a29b3d387cb5155a7419f87813557fe728cb14806d</Hashes>
        <Hashes condition="contains">SHA256=d7e091e0d478c34232e8479b950c5513077b3a69309885cee4c61063e5f74ac0</Hashes>
        <Hashes condition="contains">SHA256=d8b58f6a89a7618558e37afc360cd772b6731e3ba367f8d58734ecee2244a530</Hashes>
        <Hashes condition="contains">SHA256=d92eab70bcece4432258c9c9a914483a2267f6ab5ce2630048d3a99e8cb1b482</Hashes>
        <Hashes condition="contains">SHA256=d636c011b8b2896572f5de260eb997182cc6955449b044a739bd19cbe6fdabd2</Hashes>
        <Hashes condition="contains">SHA256=d783ace822f8fe4e25d5387e5dd249cb72e62f62079023216dc436f1853a150f</Hashes>
        <Hashes condition="contains">SHA256=d884ca8cc4ef1826ca3ab03eb3c2d8f356ba25f2d20db0a7d9fc251c565be7f3</Hashes>
        <Hashes condition="contains">SHA256=d5562fb90b0b3deb633ab335bcbd82ce10953466a428b3f27cb5b226b453eaf3</Hashes>
        <Hashes condition="contains">SHA256=d5586dc1e61796a9ae5e5d1ced397874753056c3df2eb963a8916287e1929a71</Hashes>
        <Hashes condition="contains">SHA256=d6827cd3a8f273a66ecc33bb915df6c7dea5cc1b8134b0c348303ef50db33476</Hashes>
        <Hashes condition="contains">SHA256=d8459f7d707c635e2c04d6d6d47b63f73ba3f6629702c7a6e0df0462f6478ae2</Hashes>
        <Hashes condition="contains">SHA256=d25904fbf907e19f366d54962ff543d9f53b8fdfd2416c8b9796b6a8dd430e26</Hashes>
        <Hashes condition="contains">SHA256=d205286bffdf09bc033c09e95c519c1c267b40c2ee8bab703c6a2d86741ccd3e</Hashes>
        <Hashes condition="contains">SHA256=d969845ef6acc8e5d3421a7ce7e244f419989710871313b04148f9b322751e5d</Hashes>
        <Hashes condition="contains">SHA256=d74755311d127d0eb7454e56babc2db8dbaa814bc4ba8e2a7754d3e0224778e1</Hashes>
        <Hashes condition="contains">SHA256=da6ca1fb539f825ca0f012ed6976baf57ef9c70143b7a1e88b4650bf7a925e24</Hashes>
        <Hashes condition="contains">SHA256=da11e9598eef033722b97873d1c046270dd039d0e3ee6cd37911e2dc2eb2608d</Hashes>
        <Hashes condition="contains">SHA256=db2a9247177e8cdd50fe9433d066b86ffd2a84301aa6b2eb60f361cfff077004</Hashes>
        <Hashes condition="contains">SHA256=db90e554ad249c2bd888282ecf7d8da4d1538dd364129a3327b54f8242dd5653</Hashes>
        <Hashes condition="contains">SHA256=dbb457ae1bd07a945a1466ce4a206c625e590aee3922fa7d86fbe956beccfc98</Hashes>
        <Hashes condition="contains">SHA256=dbc604b4e01362a3e51357af4a87686834fe913852a4e0a8c0d4c1a0f7d076ed</Hashes>
        <Hashes condition="contains">SHA256=dbe9f17313e1164f06401234b875fbc7f71d41dc7271de643865af1358841fef</Hashes>
        <Hashes condition="contains">SHA256=dcb815eb8e9016608d0d917101b6af8c84b96fb709dc0344bceed02cbc4ed258</Hashes>
        <Hashes condition="contains">SHA256=dd4a1253d47de14ef83f1bc8b40816a86ccf90d1e624c5adf9203ae9d51d4097</Hashes>
        <Hashes condition="contains">SHA256=dd573f23d656818036fc9ae1064eda31aca86acb9bc44a6e127db3ea112a9094</Hashes>
        <Hashes condition="contains">SHA256=dde6f28b3f7f2abbee59d4864435108791631e9cb4cdfb1f178e5aa9859956d8</Hashes>
        <Hashes condition="contains">SHA256=de6bf572d39e2611773e7a01f0388f84fb25da6cba2f1f8b9b36ffba467de6fa</Hashes>
        <Hashes condition="contains">SHA256=de8f8006d8ee429b5f333503defa54b25447f4ed6aeade5e4219e23f3473ef1c</Hashes>
        <Hashes condition="contains">SHA256=de3597ae7196ca8c0750dce296a8a4f58893774f764455a125464766fcc9b3b5</Hashes>
        <Hashes condition="contains">SHA256=dec8a933dba04463ed9bb7d53338ff87f2c23cfb79e0e988449fc631252c9dcc</Hashes>
        <Hashes condition="contains">SHA256=ded2927f9a4e64eefd09d0caba78e94f309e3a6292841ae81d5528cab109f95d</Hashes>
        <Hashes condition="contains">SHA256=deecbcd260849178de421d8e2f177dce5c63cf67a48abb23a0e3cf3aa3e00578</Hashes>
        <Hashes condition="contains">SHA256=df0cc4e5c9802f8edaefeb130e375cad56b2c5490d8ebd77d8dbdcc6fdc7ecb6</Hashes>
        <Hashes condition="contains">SHA256=df0dcfb3971829af79629efd036b8e1c6e2127481b3644ccc6e2ddd387489a15</Hashes>
        <Hashes condition="contains">SHA256=dfaefd06b680f9ea837e7815fc1cc7d1f4cc375641ac850667ab20739f46ad22</Hashes>
        <Hashes condition="contains">SHA256=e0b5a5f8333fc1213791af5c5814d7a99615b3951361ca75f8aa5022c9cfbc2b</Hashes>
        <Hashes condition="contains">SHA256=e2d8dd5dacc24051709f55a35184f5f99aef957a83bd358b0608b4479e1ec24f</Hashes>
        <Hashes condition="contains">SHA256=e2e79f1e696f27fa70d72f97e448081b1fa14d59cbb89bb4a40428534dd5c6f6</Hashes>
        <Hashes condition="contains">SHA256=e3b257357be41a18319332df7023c4407e2b93ac4c9e0c6754032e29f3763eac</Hashes>
        <Hashes condition="contains">SHA256=e3eff841ea0f2786e5e0fed2744c0829719ad711fc9258eeaf81ed65a52a8918</Hashes>
        <Hashes condition="contains">SHA256=e3f2ee22dec15061919583e4beb8abb3b29b283e2bcb46badf2bfde65f5ea8dd</Hashes>
        <Hashes condition="contains">SHA256=e4a7da2cf59a4a21fc42b611df1d59cae75051925a7ddf42bf216cc1a026eadb</Hashes>
        <Hashes condition="contains">SHA256=e4c154a0073bbad3c9f8ab7218e9b3be252ae705c20c568861dae4088f17ffcc</Hashes>
        <Hashes condition="contains">SHA256=e4d9f037411284e996a002b15b49bc227d085ee869ae1cd91ba54ff7c244f036</Hashes>
        <Hashes condition="contains">SHA256=e4eca7db365929ff7c5c785e2eab04ef8ec67ea9edcf7392f2b74eccd9449148</Hashes>
        <Hashes condition="contains">SHA256=e005e8d183e853a27ad3bb56f25489f369c11b0d47e3d4095aad9291b3343bf1</Hashes>
        <Hashes condition="contains">SHA256=e05eeb2b8c18ad2cb2d1038c043d770a0d51b96b748bc34be3e7fc6f3790ce53</Hashes>
        <Hashes condition="contains">SHA256=e5b0772be02e2bc807804874cf669e97aa36f5aff1f12fa0a631a3c7b4dd0dc8</Hashes>
        <Hashes condition="contains">SHA256=e7cbfb16261de1c7f009431d374d90e9eb049ba78246e38bc4c8b9e06f324b6f</Hashes>
        <Hashes condition="contains">SHA256=e16dc51c51b2df88c474feb52ce884d152b3511094306a289623de69dedfdf48</Hashes>
        <Hashes condition="contains">SHA256=e32ab30d01dcff6418544d93f99ae812d2ce6396e809686620547bea05074f6f</Hashes>
        <Hashes condition="contains">SHA256=e50b25d94c1771937b2f632e10eea875ac6b19c57da703d52e23ad2b6299f0ae</Hashes>
        <Hashes condition="contains">SHA256=e58bbf3251906ff722aa63415bf169618e78be85cb92c8263d3715c260491e90</Hashes>
        <Hashes condition="contains">SHA256=e61a54f6d3869b43c4eceac3016df73df67cce03878c5a6167166601c5d3f028</Hashes>
        <Hashes condition="contains">SHA256=e68d453d333854787f8470c8baef3e0d082f26df5aa19c0493898bcf3401e39a</Hashes>
        <Hashes condition="contains">SHA256=e86cb77de7b6a8025f9a546f6c45d135f471e664963cf70b381bee2dfd0fdef4</Hashes>
        <Hashes condition="contains">SHA256=e428ddf9afc9b2d11e2271f0a67a2d6638b860c2c12d4b8cc63d33f3349ee93f</Hashes>
        <Hashes condition="contains">SHA256=e1980c6592e6d2d92c1a65acad8f1071b6a404097bb6fcce494f3c8ac31385cf</Hashes>
        <Hashes condition="contains">SHA256=e3936d3356573ce2e472495cd3ce769f49a613e453b010433dafce5ea498ddc2</Hashes>
        <Hashes condition="contains">SHA256=e4522e2cfa0b1f5d258a3cf85b87681d6969e0572f668024c465d635c236b5d9</Hashes>
        <Hashes condition="contains">SHA256=e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf</Hashes>
        <Hashes condition="contains">SHA256=e83908eba2501a00ef9e74e7d1c8b4ff1279f1cd6051707fd51824f87e4378fa</Hashes>
        <Hashes condition="contains">SHA256=e07211224b02aaf68a5e4b73fc1049376623793509d9581cdaee9e601020af06</Hashes>
        <Hashes condition="contains">SHA256=e6056443537d4d2314dabca1b9168f1eaaf17a14eb41f6f5741b6b82b3119790</Hashes>
        <Hashes condition="contains">SHA256=e81230217988f3e7ec6f89a06d231ec66039bdba340fd8ebb2bbb586506e3293</Hashes>
        <Hashes condition="contains">SHA256=ea0b9eecf4ad5ec8c14aec13de7d661e7615018b1a3c65464bf5eca9bbf6ded3</Hashes>
        <Hashes condition="contains">SHA256=ea85bbe63d6f66f7efee7007e770af820d57f914c7f179c5fee3ef2845f19c41</Hashes>
        <Hashes condition="contains">SHA256=ebe2e9ec6d5d94c2d58fbcc9d78c5f0ee7a2f2c1aed6d1b309f383186d11dfa3</Hashes>
        <Hashes condition="contains">SHA256=ec5fac0b6bb267a2bd10fc80c8cca6718439d56e82e053d3ff799ce5f3475db5</Hashes>
        <Hashes condition="contains">SHA256=ecd07df7ad6fee9269a9e9429eb199bf3e24cf672aa1d013b7e8d90d75324566</Hashes>
        <Hashes condition="contains">SHA256=ece0a900ea089e730741499614c0917432246ceb5e11599ee3a1bb679e24fd2c</Hashes>
        <Hashes condition="contains">SHA256=ecfc52a22e4a41bf53865b0e28309411c60af34a44e31a5c53cdc8c5733e8282</Hashes>
        <Hashes condition="contains">SHA256=ed2f33452ec32830ffef2d5dc832985db9600c306ed890c47f3f33ccbb335c39</Hashes>
        <Hashes condition="contains">SHA256=ee3ff12943ced401e2b6df9e66e8a0be8e449fa9326cab241f471b2d8ffefdd7</Hashes>
        <Hashes condition="contains">SHA256=ee45fd2d7315fd039f3585a66e7855ba4af9d4721e1448e602623de14e932bbe</Hashes>
        <Hashes condition="contains">SHA256=eea53103e7a5a55dc1df79797395a2a3e96123ebd71cdd2db4b1be80e7b3f02b</Hashes>
        <Hashes condition="contains">SHA256=ef6d3c00f9d0aa31a218094480299ef73fc85146adf62fd0c2f4f88972c5c850</Hashes>
        <Hashes condition="contains">SHA256=ef86c4e5ee1dbc4f81cd864e8cd2f4a2a85ee4475b9a9ab698a4ae1cc71fbeb0</Hashes>
        <Hashes condition="contains">SHA256=f1c8ca232789c2f11a511c8cd95a9f3830dd719cad5aa22cb7c3539ab8cb4dc3</Hashes>
        <Hashes condition="contains">SHA256=f4ff679066269392f6b7c3ba6257fc60dd609e4f9c491b00e1a16e4c405b0b9b</Hashes>
        <Hashes condition="contains">SHA256=f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe</Hashes>
        <Hashes condition="contains">SHA256=f6cd7353cb6e86e98d387473ed6340f9b44241867508e209e944f548b9db1d5f</Hashes>
        <Hashes condition="contains">SHA256=f15ae970e222ce06dbf3752b223270d0e726fb78ebec3598b4f8225b5a0880b1</Hashes>
        <Hashes condition="contains">SHA256=f37d609ea1f06660d970415dd3916c4c153bb5940bf7d2beb47fa34e8a8ffbfc</Hashes>
        <Hashes condition="contains">SHA256=f51bdb0ad924178131c21e39a8ccd191e46b5512b0f2e1cc8486f63e84e5d960</Hashes>
        <Hashes condition="contains">SHA256=f74ffd6916333662900cbecb90aca2d6475a714ce410adf9c5c3264abbe5732c</Hashes>
        <Hashes condition="contains">SHA256=f84f8173242b95f9f3c4fea99b5555b33f9ce37ca8188b643871d261cb081496</Hashes>
        <Hashes condition="contains">SHA256=f85cca4badff17d1aa90752153ccec77a68ad282b69e3985fdc4743eaea85004</Hashes>
        <Hashes condition="contains">SHA256=f85eb576acb5db0d2f48e5f09a7244165a876fa1ca8697ebb773e4d7071d4439</Hashes>
        <Hashes condition="contains">SHA256=f088b2ba27dacd5c28f8ee428f1350dca4bc7c6606309c287c801b2e1da1a53d</Hashes>
        <Hashes condition="contains">SHA256=f88ebb633406a086d9cca6bc8b66a4ea940c5476529f9033a9e0463512a23a57</Hashes>
        <Hashes condition="contains">SHA256=f581decc2888ef27ee1ea85ea23bbb5fb2fe6a554266ff5a1476acd1d29d53af</Hashes>
        <Hashes condition="contains">SHA256=f596e64f4c5d7c37a00493728d8756b243cfdc11e3372d6d6dfeffc13c9ab960</Hashes>
        <Hashes condition="contains">SHA256=f0605dda1def240dc7e14efa73927d6c6d89988c01ea8647b671667b2b167008</Hashes>
        <Hashes condition="contains">SHA256=f744abb99c97d98e4cd08072a897107829d6d8481aee96c22443f626d00f4145</Hashes>
        <Hashes condition="contains">SHA256=f929bead59e9424ab90427b379dcdd63fbfe0c4fb5e1792e3a1685541cd5ec65</Hashes>
        <Hashes condition="contains">SHA256=f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35</Hashes>
        <Hashes condition="contains">SHA256=f8886a9c759e0426e08d55e410b02c5b05af3c287b15970175e4874316ffaf13</Hashes>
        <Hashes condition="contains">SHA256=f8965fdce668692c3785afa3559159f9a18287bc0d53abb21902895a8ecf221b</Hashes>
        <Hashes condition="contains">SHA256=f29073dc99cb52fa890aae80037b48a172138f112474a1aecddae21179c93478</Hashes>
        <Hashes condition="contains">SHA256=f85784fa8e7a7ec86cb3fe76435802f6bb82256e1824ed7b5d61bf075f054573</Hashes>
        <Hashes condition="contains">SHA256=f877296e8506e6a1acbdacdc5085b18c6842320a2775a329d286bac796f08d54</Hashes>
        <Hashes condition="contains">SHA256=f9895458e73d4b0ef01eda347fb695bb00e6598d9f5e2506161b70ad96bb7298</Hashes>
        <Hashes condition="contains">SHA256=f40435488389b4fb3b945ca21a8325a51e1b5f80f045ab019748d0ec66056a8b</Hashes>
        <Hashes condition="contains">SHA256=fa875178ae2d7604d027510b0d0a7e2d9d675e10a4c9dda2d927ee891e0bcb91</Hashes>
        <Hashes condition="contains">SHA256=fafa1bb36f0ac34b762a10e9f327dcab2152a6d0b16a19697362d49a31e7f566</Hashes>
        <Hashes condition="contains">SHA256=fb6b0d304433bf88cc7d57728683dbb4b9833459dc33528918ead09b3907ff22</Hashes>
        <Hashes condition="contains">SHA256=fb81b5f8bf69637dbdf050181499088a67d24577587bc520de94b5ee8996240f</Hashes>
        <Hashes condition="contains">SHA256=fc22977ff721b3d718b71c42440ee2d8a144f3fbc7755e4331ddd5bcc65158d2</Hashes>
        <Hashes condition="contains">SHA256=fca10cde7d331b7f614118682d834d46125a65888e97bd9fda2df3f15797166c</Hashes>
        <Hashes condition="contains">SHA256=fcdfe570e6dc6e768ef75138033d9961f78045adca53beb6fdb520f6417e0df1</Hashes>
        <Hashes condition="contains">SHA256=fd33fb2735cc5ef466a54807d3436622407287e325276fcd3ed1290c98bd0533</Hashes>
        <Hashes condition="contains">SHA256=fd388cf1df06d419b14dedbeb24c6f4dff37bea26018775f09d56b3067f0de2c</Hashes>
        <Hashes condition="contains">SHA256=fd8669794c67b396c12fc5f08e9c004fdf851a82faf302846878173e4fbecb03</Hashes>
        <Hashes condition="contains">SHA256=fda93c6e41212e86af07f57ca95db841161f00b08dae6304a51b467056e56280</Hashes>
        <Hashes condition="contains">SHA256=ff115cefe624b6ca0b3878a86f6f8b352d1915b65fbbdc33ae15530a96ebdaa7</Hashes>
        <Hashes condition="contains">SHA256=ff6729518a380bf57f1bc6f1ec0aa7f3012e1618b8d9b0f31a61d299ee2b4339</Hashes>
        <Hashes condition="contains">SHA256=ff9623317287358440ec67da9ba79994d9b17b99ffdd709ec836478fe1fc22a5</Hashes>
        <Hashes condition="contains">SHA256=ffc72f0bde21ba20aa97bee99d9e96870e5aa40cce9884e44c612757f939494f</Hashes>
      </Rule>
      <Rule name="Attack=T1204.002,Technique=User Execution: Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Malicious Driver Detected,Risk=10,Author=Florian Roth" groupRelation="or">
        <Hashes condition="contains">SHA256=56066ed07bad3b5c1474e8fae5ee2543d17d7977369b34450bd0775517e3b25c</Hashes>
        <Hashes condition="contains">SHA256=06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4</Hashes>
        <Hashes condition="contains">SHA256=86047bb1969d1db455493955fd450d18c62a3f36294d0a6c3732c88dfbcc4f62</Hashes>
        <Hashes condition="contains">SHA256=06c5ebd0371342d18bc81a96f5e5ce28de64101e3c2fd0161d0b54d8368d2f1f</Hashes>
        <Hashes condition="contains">SHA256=8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e</Hashes>
        <Hashes condition="contains">SHA256=81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1</Hashes>
        <Hashes condition="contains">SHA256=6661320f779337b95bbbe1943ee64afb2101c92f92f3d1571c1bf4201c38c724</Hashes>
        <Hashes condition="contains">SHA256=ea50f22daade04d3ca06dedb497b905215cba31aae7b4cab4b533fda0c5be620</Hashes>
        <Hashes condition="contains">SHA256=0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc</Hashes>
        <Hashes condition="contains">SHA256=c0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c</Hashes>
        <Hashes condition="contains">SHA256=e1cb86386757b947b39086cc8639da988f6e8018ca9995dd669bdc03c8d39d7d</Hashes>
        <Hashes condition="contains">SHA256=18c909a2b8c5e16821d6ef908f56881aa0ecceeaccb5fa1e54995935fcfd12f7</Hashes>
        <Hashes condition="contains">SHA256=139f8412a7c6fdc43dcfbbcdba256ee55654eb36a40f338249d5162a1f69b988</Hashes>
        <Hashes condition="contains">SHA256=b0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427</Hashes>
        <Hashes condition="contains">SHA256=1485c0ed3e875cbdfc6786a5bd26d18ea9d31727deb8df290a1c00c780419a4e</Hashes>
        <Hashes condition="contains">SHA256=6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421</Hashes>
        <Hashes condition="contains">SHA256=0d10c4b2f56364b475b60bd2933273c8b1ed2176353e59e65f968c61e93b7d99</Hashes>
        <Hashes condition="contains">SHA256=ad938d15ecfd70083c474e1642a88b078c3cea02cdbddf66d4fb1c01b9b29d9a</Hashes>
        <Hashes condition="contains">SHA256=89698cad598a56f9e45efffd15d1841e494a2409cc12279150a03842cd6bb7f3</Hashes>
        <Hashes condition="contains">SHA256=5f6fec8f7890d032461b127332759c88a1b7360aa10c6bd38482572f59d2ba8b</Hashes>
        <Hashes condition="contains">SHA256=fa9abb3e7e06f857be191a1e049dd37642ec41fb2520c105df2227fcac3de5d5</Hashes>
        <Hashes condition="contains">SHA256=05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4</Hashes>
        <Hashes condition="contains">SHA256=6994b32e3f3357f4a1d0abe81e8b62dd54e36b17816f2f1a80018584200a1b77</Hashes>
        <Hashes condition="contains">SHA256=6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f</Hashes>
        <Hashes condition="contains">SHA256=32882949ea084434a376451ff8364243a50485a3b4af2f2240bb5f20c164543d</Hashes>
        <Hashes condition="contains">SHA256=fd223833abffa9cd6cc1848d77599673643585925a7ee51259d67c44d361cce8</Hashes>
        <Hashes condition="contains">SHA256=6839fcae985774427c65fe38e773aa96ec451a412caa5354ad9e2b9b54ffe6c1</Hashes>
        <Hashes condition="contains">SHA256=f9f2091fccb289bcf6a945f6b38676ec71dedb32f3674262928ccaf840ca131a</Hashes>
        <Hashes condition="contains">SHA256=7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376</Hashes>
        <Hashes condition="contains">SHA256=96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc</Hashes>
        <Hashes condition="contains">SHA256=b9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3</Hashes>
        <Hashes condition="contains">SHA256=e6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217</Hashes>
        <Hashes condition="contains">SHA256=200f98655d1f46d2599c2c8605ebb7e335fee3883a32135ca1a81e09819bc64a</Hashes>
        <Hashes condition="contains">SHA256=8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce</Hashes>
        <Hashes condition="contains">SHA256=c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497</Hashes>
        <Hashes condition="contains">SHA256=23e89fd30a1c7db37f3ea81b779ce9acf8a4294397cbb54cff350d54afcfd931</Hashes>
        <Hashes condition="contains">SHA256=575e58b62afab094c20c296604dc3b7dd2e1a50f5978d8ee24b7dca028e97316</Hashes>
        <Hashes condition="contains">SHA256=5b932eab6c67f62f097a3249477ac46d80ddccdc52654f8674060b4ddf638e5d</Hashes>
        <Hashes condition="contains">SHA256=e6f764c3b5580cd1675cbf184938ad5a201a8c096607857869bd7c3399df0d12</Hashes>
        <Hashes condition="contains">SHA256=9bb09752cf3a464455422909edef518ac18fe63cf5e1e8d9d6c2e68db62e0c87</Hashes>
        <Hashes condition="contains">SHA256=f8236fc01d4efaa48f032e301be2ebba4036b2cd945982a29046eca03944d2ae</Hashes>
        <Hashes condition="contains">SHA256=e7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e</Hashes>
        <Hashes condition="contains">SHA256=9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c</Hashes>
        <Hashes condition="contains">SHA256=f936ec4c8164cbd31add659b61c16cb3a717eac90e74d89c47afb96b60120280</Hashes>
        <Hashes condition="contains">SHA256=9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51</Hashes>
        <Hashes condition="contains">SHA256=b8807e365be2813b7eccd2e4c49afb0d1e131086715638b7a6307cd7d7e9556c</Hashes>
        <Hashes condition="contains">SHA256=50819a1add4c81c0d53203592d6803f022443440935ff8260ff3b6d5253c0c76</Hashes>
        <Hashes condition="contains">SHA256=52d5c35325ce701516f8b04380c9fbdb78ec6bcc13b444f758fdb03d545b0677</Hashes>
        <Hashes condition="contains">SHA256=7f4555a940ce1156c9bcea9a2a0b801f9a5e44ec9400b61b14a7b1a6404ffdf6</Hashes>
        <Hashes condition="contains">SHA256=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104</Hashes>
        <Hashes condition="contains">SHA256=8578bff36e3b02cc71495b647db88c67c3c5ca710b5a2bd539148550595d0330</Hashes>
        <Hashes condition="contains">SHA256=4734a0a5d88f44a4939b8d812364cab6ca5f611b9b8ceebe27df6c1ed3a6d8a4</Hashes>
        <Hashes condition="contains">SHA256=88076e98d45ed3adf0c5355411fe8ca793eb7cec1a1c61f5e1ec337eae267463</Hashes>
        <Hashes condition="contains">SHA256=749b0e8c8c8b7dda8c2063c708047cfe95afa0a4d86886b31a12f3018396e67c</Hashes>
        <Hashes condition="contains">SHA256=49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530</Hashes>
        <Hashes condition="contains">SHA256=d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c</Hashes>
        <Hashes condition="contains">SHA256=f6c316e2385f2694d47e936b0ac4bc9b55e279d530dd5e805f0d963cb47c3c0d</Hashes>
        <Hashes condition="contains">SHA256=5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a</Hashes>
        <Hashes condition="contains">SHA256=5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae</Hashes>
        <Hashes condition="contains">SHA256=bb2422e96ea993007f25c71d55b2eddfa1e940c89e895abb50dd07d7c17ca1df</Hashes>
        <Hashes condition="contains">SHA256=42b22faa489b5de936db33f12184f6233198bdf851a18264d31210207827ba25</Hashes>
        <Hashes condition="contains">SHA256=f461414a2596555cece5cfee65a3c22648db0082ca211f6238af8230e41b3212</Hashes>
        <Hashes condition="contains">SHA256=770f33259d6fb10f4a32d8a57d0d12953e8455c72bb7b60cb39ce505c507013a</Hashes>
      </Rule>
    </FileExecutableDetected>
  </RuleGroup>
  <RuleGroup name="RG=FileExecutable Excludes" groupRelation="or">
    <FileExecutableDetected onmatch="exclude">
    </FileExecutableDetected>
  </RuleGroup>
  </EventFiltering>
</Sysmon>
